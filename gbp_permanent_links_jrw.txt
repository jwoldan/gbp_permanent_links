# gbp_permanent_links_jrw v0.14jrw03
# Custom permanent links rules
# Graeme Porteous, modified by Jeffrey Woldan
# https://github.com/jwoldan/gbp_permanent_links

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjQ6Im5hbWUiO3M6MjM6ImdicF9wZXJtYW5lbnRfbGlua3NfanJ3IjtzOjc6InZl
cnNpb24iO3M6OToiMC4xNGpydzAzIjtzOjY6ImF1dGhvciI7czo0MzoiR3JhZW1lIFBvcnRl
b3VzLCBtb2RpZmllZCBieSBKZWZmcmV5IFdvbGRhbiI7czoxMDoiYXV0aG9yX3VyaSI7czo0
NjoiaHR0cHM6Ly9naXRodWIuY29tL2p3b2xkYW4vZ2JwX3Blcm1hbmVudF9saW5rcyI7czox
MToiZGVzY3JpcHRpb24iO3M6Mjg6IkN1c3RvbSBwZXJtYW5lbnQgbGlua3MgcnVsZXMiO3M6
NDoidHlwZSI7czoxOiIxIjtzOjQ6ImhlbHAiO3M6MTUxOiJoMS4gZ2JwX3Blcm1hbmVudF9s
aW5rcy4KClRoZXJlIGlzIG5vIHBsdWdpbiBkb2N1bWVudGF0aW9uLiBGb3IgaGVscCBwbGVh
c2UgdXNlIHRoZSAiZm9ydW0gdGhyZWFkIjpodHRwOi8vZm9ydW0udGV4dHBhdHRlcm4uY29t
L3ZpZXd0b3BpYy5waHA/aWQ9MTg5MTguIjtzOjQ6ImNvZGUiO3M6Njk2MzE6IgovLyBDb25z
dGFudHMKQGRlZmluZSgnZ2JwX3NhdmUnLCAnc2F2ZScpOwpAZGVmaW5lKCdnYnBfcG9zdCcs
ICdwb3N0Jyk7CkBkZWZpbmUoJ2dicF9zZXBhcmF0b3InLCAnJn4mfiYnKTsKCi8vIHJlcXVp
cmVfcGx1Z2luKCkgd2lsbCByZXNldCB0aGUgJHR4cF9jdXJyZW50X3BsdWdpbiBnbG9iYWwK
Z2xvYmFsICR0eHBfY3VycmVudF9wbHVnaW47CiRnYnBfY3VycmVudF9wbHVnaW4gPSAkdHhw
X2N1cnJlbnRfcGx1Z2luOwpyZXF1aXJlX3BsdWdpbignZ2JwX2FkbWluX2xpYnJhcnknKTsK
JHR4cF9jdXJyZW50X3BsdWdpbiA9ICRnYnBfY3VycmVudF9wbHVnaW47CgpjbGFzcyBQZXJt
YW5lbnRMaW5rcyBleHRlbmRzIEdCUFBsdWdpbgp7Cgl2YXIgJHBlcm1pc3Npb25zID0gJzEs
Mic7Cgl2YXIgJHByZWZlcmVuY2VzID0gYXJyYXkoCgkJJ3Nob3dfcHJlZml4JyA9PiBhcnJh
eSgndmFsdWUnID0+IDAsICd0eXBlJyA9PiAneWVzbm9yYWRpbycpLAoJCSdzaG93X3N1ZmZp
eCcgPT4gYXJyYXkoJ3ZhbHVlJyA9PiAwLCAndHlwZScgPT4gJ3llc25vcmFkaW8nKSwKCQkn
b21pdF90cmFpbGluZ19zbGFzaCcgPT4gYXJyYXkoJ3ZhbHVlJyA9PiAwICwgJ3R5cGUnID0+
ICd5ZXNub3JhZGlvJyksCgkJJ3JlZGlyZWN0X210X3N0eWxlX2xpbmtzJyA9PiBhcnJheSgn
dmFsdWUnID0+IDEgLCAndHlwZScgPT4gJ3llc25vcmFkaW8nKSwKCQknY2xlYW5fcGFnZV9h
cmNoaXZlX2xpbmtzJyA9PiBhcnJheSgndmFsdWUnID0+IDEgLCAndHlwZScgPT4gJ3llc25v
cmFkaW8nKSwKCQknam9pbl9wcmV0ZXh0X3RvX3BhZ2VsaW5rcycgPT4gYXJyYXkoJ3ZhbHVl
JyA9PiAxICwgJ3R5cGUnID0+ICd5ZXNub3JhZGlvJyksCgkJJ2NoZWNrX3ByZXRleHRfY2F0
ZWdvcnlfY29udGV4dCcgPT4gYXJyYXkoJ3ZhbHVlJyA9PiAwICwgJ3R5cGUnID0+ICd5ZXNu
b3JhZGlvJyksCgkJJ2NoZWNrX3ByZXRleHRfc2VjdGlvbl9jb250ZXh0JyA9PiBhcnJheSgn
dmFsdWUnID0+IDAgLCAndHlwZScgPT4gJ3llc25vcmFkaW8nKSwKCQknZm9yY2VfbG93ZXJj
YXNlX3VybHMnID0+IGFycmF5KCd2YWx1ZScgPT4gMSAsICd0eXBlJyA9PiAneWVzbm9yYWRp
bycpLAoJCSdhdXRvbWF0aWNhbGx5X2FwcGVuZF90aXRsZScgPT4gYXJyYXkoJ3ZhbHVlJyA9
PiAxICwgJ3R5cGUnID0+ICd5ZXNub3JhZGlvJyksCgkJJ3VzZV9jbGVhdmVyX3BhcnRpYWxf
bWF0Y2hlcycgPT4gYXJyYXkoJ3ZhbHVlJyA9PiAxICwgJ3R5cGUnID0+ICd5ZXNub3JhZGlv
JyksCgkJJ3Blcm1saW5rX3JlZGlyZWN0X2h0dHBfc3RhdHVzJyA9PiBhcnJheSgndmFsdWUn
ID0+ICczMDEnICwgJ3R5cGUnID0+ICd0ZXh0X2lucHV0JyksCgkJJ3VybF9yZWRpcmVjdF9o
dHRwX3N0YXR1cycgPT4gYXJyYXkoJ3ZhbHVlJyA9PiAnMzAyJyAsICd0eXBlJyA9PiAndGV4
dF9pbnB1dCcpLAoJCSd0ZXh0X2FuZF9yZWdleF9zZWdtZW50X3Njb3JlcycgPT4gYXJyYXko
J3ZhbHVlJyA9PiAnMCcgLCAndHlwZScgPT4gJ3RleHRfaW5wdXQnKSwKCQknZGVidWcnID0+
IGFycmF5KCd2YWx1ZScgPT4gMCwgJ3R5cGUnID0+ICd5ZXNub3JhZGlvJyksCgkpOwoJdmFy
ICRtYXRjaGVkX3Blcm1saW5rID0gYXJyYXkoKTsKCXZhciAkcGFydGlhbF9tYXRjaGVzID0g
YXJyYXkoKTsKCXZhciAkY2xlYXZlcl9wYXJ0aWFsX21hdGNoOwoJdmFyICRidWZmZXJfZGVi
dWcgPSBhcnJheSgpOwoKCWZ1bmN0aW9uIHByZWxvYWQgKCkgewoJCW5ldyBQZXJtYW5lbnRM
aW5rc0xpc3RUYWJWaWV3KCdsaXN0JywgJ2xpc3QnLCAkdGhpcyk7CgkJbmV3IFBlcm1hbmVu
dExpbmtzQnVpbGRUYWJWaWV3KCdidWlsZCcsICdidWlsZCcsICR0aGlzKTsKCQluZXcgR0JQ
UHJlZmVyZW5jZVRhYlZpZXcoJHRoaXMpOwoJfQoKCWZ1bmN0aW9uIG1haW4gKCkgewoJCXJl
cXVpcmVfcHJpdnMoJHRoaXMtPmV2ZW50KTsKCX0KCglmdW5jdGlvbiBnZXRfYWxsX3Blcm1s
aW5rcyAoJHNvcnQgPSAwLCAkZXhjbHVkZSA9IGFycmF5KCkpIHsKCQlzdGF0aWMgJHJzOwoJ
CWlmICghaXNzZXQoJHJzKSkKCQkJJHJzID0gc2FmZV9jb2x1bW4oCgkJCQkiUkVQTEFDRShu
YW1lLCAneyR0aGlzLT5wbHVnaW5fbmFtZX1fJywgJycpIEFTIGlkIiwgJ3R4cF9wcmVmcycs
CgkJCQkiYGV2ZW50YCA9ICd7JHRoaXMtPmV2ZW50fScgQU5EIGBuYW1lYCBSRUdFWFAgJ157
JHRoaXMtPnBsdWdpbl9uYW1lfV8uezEzfSQnIgoJCQkpOwoKCQlpZiAoQHR4cGludGVyZmFj
ZSA9PSAncHVibGljJykKCQkJJHRoaXMtPmRlYnVnKCdMb2FkaW5nIHBlcm1saW5rcyBmcm9t
IGRiJyk7CgkJJGkgPSAwOwoKCQkkcGVybWxpbmtzID0gYXJyYXkoKTsKCQlmb3JlYWNoICgk
cnMgYXMgJGlkKSB7CgkJCSRwbCA9ICR0aGlzLT5nZXRfcGVybWxpbmsoJGlkKTsKCgkJCS8v
IERvbid0IHRyeSBhbmQgbG9hZCBwZXJtYWxpbmsgcnVsZXMgZnJvbSB0aGUgbmV3IHZlcnNp
b24KCQkJaWYgKCFpc3NldCgkcGxbJ2NvbXBvbmVudHMnXSkpCgkJCQljb250aW51ZTsKCgkJ
CWlmIChjb3VudCgkZXhjbHVkZSkgPiAwKQoJCQkJZm9yZWFjaCAoJHBsWydjb21wb25lbnRz
J10gYXMgJHBsX2MpIHsKCQkJCQlpZiAoaXNfYXJyYXkoJGV4Y2x1ZGUpICYmIGluX2FycmF5
KCRwbF9jWyd0eXBlJ10sICRleGNsdWRlKSkKCQkJCQkJY29udGludWUgMjsKCQkJCQlpZiAo
aXNfc3RyaW5nKCRleGNsdWRlKSAmJiAkcGxfY1sndHlwZSddID09PSAkZXhjbHVkZSkKCQkJ
CQkJY29udGludWUgMjsKCQkJCX0KCgkJCSRwZXJtbGlua3NbJGlkXSA9ICRwbDsKCgkJCWlm
ICgkc29ydCkKCQkJCSRwcmVjZWRlbmNlWyRpZF0gPSAkcGVybWxpbmtzWyRpZF1bJ3NldHRp
bmdzJ11bJ3BsX3ByZWNlZGVuY2UnXTsKCQl9CgoJCS8vIElmIG1vcmUgdGhhbiBvbmUgcGVy
bWFuZW50IGxpbmssIHNvcnQgYnkgdGhlaXIgcHJlY2VkZW5jZSB2YWx1ZS4KCQlpZiAoJHNv
cnQgJiYgY291bnQoJHBlcm1saW5rcykgPiAxKQoJCQlhcnJheV9tdWx0aXNvcnQoJHByZWNl
ZGVuY2UsIFNPUlRfREVTQywgJHBlcm1saW5rcyk7CgoJCWlmIChAdHhwaW50ZXJmYWNlID09
ICdwdWJsaWMnKSB7CgkJCWZvcmVhY2ggKCRwZXJtbGlua3MgYXMgJHBsKQoJCQkJJHRoaXMt
PmRlYnVnKCRwbFsnc2V0dGluZ3MnXVsncGxfcHJlY2VkZW5jZSddLic6ICcuJHBsWydzZXR0
aW5ncyddWydwbF9uYW1lJ10uJyAoJy4kcGxbJ3NldHRpbmdzJ11bJ3BsX3ByZXZpZXcnXS4n
KScpOwoJCX0KCgkJcmV0dXJuICRwZXJtbGlua3M7Cgl9CgoJZnVuY3Rpb24gZ2V0X3Blcm1s
aW5rICgkaWQpIHsKCQkkcGVybWxpbmsgPSAkdGhpcy0+cHJlZigkaWQpOwoJCXJldHVybiBp
c19hcnJheSgkcGVybWxpbmspID8gJHBlcm1saW5rIDogYXJyYXkoKTsKCX0KCglmdW5jdGlv
biByZW1vdmVfcGVybWxpbmsgKCRpZCkgewoJCSRwZXJtbGluayA9ICR0aGlzLT5nZXRfcGVy
bWxpbmsoJGlkKTsKCQlzYWZlX2RlbGV0ZSgndHhwX3ByZWZzJywgImBldmVudGAgPSAneyR0
aGlzLT5ldmVudH0nIEFORCBgbmFtZWAgTElLRSAneyR0aGlzLT5wbHVnaW5fbmFtZX1feyRp
ZH0lJyIpOwoJCXJldHVybiAkcGVybWxpbmtbJ3NldHRpbmdzJ11bJ3BsX25hbWUnXTsKCX0K
CglmdW5jdGlvbiBfZmVlZF9lbnRyeSAoKSB7CgkJc3RhdGljICRzZXQ7CgkJaWYgKCFpc3Nl
dCgkc2V0KSkgewoJCQkvLyBXZSdyZSBpbiBhIGZlZWQgZm9yY2UgZGVidWdnaW5nIG9mZi4K
CQkJJHRoaXMtPnByZWZlcmVuY2VzWydkZWJ1ZyddWyd2YWx1ZSddID0gJEdMT0JBTFNbJ3By
ZWZzJ11bJHRoaXMtPnBsdWdpbl9uYW1lLidfZGVidWcnXSA9IDA7CgoJCQkkdGhpcy0+c2V0
X3Blcm1saW5rX21vZGUodHJ1ZSk7CgkJCSRzZXQgPSB0cnVlOwoJCX0KCX0KCglmdW5jdGlv
biBfdGV4dHBhdHRlcm4gKCkgewoJCWdsb2JhbCAkcGx1Z2luc192ZXIsICRwcmV0ZXh0LCAk
cHJlZnMsICRwbHVnaW5fY2FsbGJhY2s7CgoJCSR0aGlzLT5kZWJ1ZygnUGx1Z2luOiAnLiR0
aGlzLT5wbHVnaW5fbmFtZS4nIC0gJy4kcGx1Z2luc192ZXJbJHRoaXMtPnBsdWdpbl9uYW1l
XSk7CgkJJHRoaXMtPmRlYnVnKCdGdW5jdGlvbjogJy5fX0ZVTkNUSU9OX18uJygpJyk7CgoJ
CS8vIFVSSQoJCSRyZXEgPSAkcHJldGV4dFsncmVxJ107CgkJJHJlcSA9IHByZWdfcmVwbGFj
ZSgnJVw/W15cL10rJCUnLCAnJywgJHJlcSk7CgkJJHRoaXMtPmRlYnVnKCdSZXF1ZXN0IFVS
STogJy4kcmVxKTsKCQkkdXJpID0gZXhwbG9kZSgnLycsIHRyaW0oJHJlcSwgJy8nKSk7CgoJ
CS8vIFRoZSBudW1iZXIgb2YgY29tcG9uZW50cyBjb21lcyBpbiB1c2VmdWwgd2hlbiBkZXRl
cm1pbmluZyB0aGUgYmVzdCBwYXJ0aWFsIG1hdGNoLgoJCSR1cmlfY29tcG9uZW50X2NvdW50
ID0gY291bnQoJHVyaSk7CgoJCS8vIFBlcm1hbmVudCBsaW5rcwoJCSRwZXJtbGlua3MgPSAk
dGhpcy0+Z2V0X2FsbF9wZXJtbGlua3MoMSk7CgoJCS8vIEZvcmNlIFRleHRwYXR0ZXJuIGFu
ZCB0YWdzIHRvIHVzZSBtZXNzeSBVUkxzIC0gdGhlc2UgYXJlIGVhc2llciB0bwoJCS8vIGZp
bmQgaW4gcmVnZXgKCQkkdGhpcy0+c2V0X3Blcm1saW5rX21vZGUoKTsKCgkJaWYgKGNvdW50
KCRwZXJtbGlua3MpKSB7CgoJCQkvLyBXZSBhbHNvIHdhbnQgdG8gbWF0Y2ggdGhlIGZyb250
IHBhZ2Ugb2YgdGhlIHNpdGUgKGZvciBwYWdlIG51bWJlcnMgLyBmZWVkcyBldGMuLikuCgkJ
CS8vIEFkZCBhIHBlcm1saW5rcyBydWxlIHdoaWNoIHdpbGwgZG8gdGhhdC4KCQkJJHBlcm1s
aW5rc1snZGVmYXVsdCddID0gYXJyYXkoCgkJCQknY29tcG9uZW50cycgPT4gYXJyYXkoKSwK
CQkJCSdzZXR0aW5ncycgPT4gYXJyYXkoCgkJCQkJJ3BsX25hbWUnID0+ICdnYnBfcGVybWFu
ZW50X2xpbmtzX2RlZmF1bHQnLCAncGxfcHJlY2VkZW5jZScgPT4gJycsICdwbF9wcmV2aWV3
JyA9PiAnLycsCgkJCQkJJ2Nvbl9zZWN0aW9uJyA9PiAnJywgJ2Nvbl9jYXRlZ29yeScgPT4g
JycsICdkZXNfc2VjdGlvbicgPT4gJycsICdkZXNfY2F0ZWdvcnknID0+ICcnLAoJCQkJCSdk
ZXNfcGVybWxpbmsnID0+ICcnLCAnZGVzX2ZlZWQnID0+ICcnLCAnZGVzX2xvY2F0aW9uJyA9
PiAnJywgJ2Rlc19wYWdlJyA9PiAnJwoJCQkpKTsKCgkJCS8vIEV4dGVuZCB0aGUgcHJldGV4
dF9yZXBsYWNlbWVudCBzY29wZSBvdXRzaWRlIHRoZSBmb3JlYWNoIHBlcm1saW5rIGxvb3AK
CQkJJHByZXRleHRfcmVwbGFjZW1lbnQgPSBOVUxMOwoKCQkJZm9yZWFjaCgkcGVybWxpbmtz
IGFzICRpZCA9PiAkcGwpIHsKCQkJCS8vIEV4dHJhY3QgdGhlIHBlcm1saW5rIHNldHRpbmdz
CgkJCQkkcGxfc2V0dGluZ3MgPSAkcGxbJ3NldHRpbmdzJ107CgkJCQlleHRyYWN0KCRwbF9z
ZXR0aW5ncyk7CgoJCQkJJHRoaXMtPmRlYnVnKCdQZXJtbGluayBuYW1lOiAnLiRwbF9uYW1l
KTsKCQkJCSR0aGlzLT5kZWJ1ZygnUGVybWxpbmsgaWQ6ICcuJGlkKTsKCQkJCSR0aGlzLT5k
ZWJ1ZygnUHJldmlldzogJy4kcGxfcHJldmlldyk7CgoJCQkJJHBsX2NvbXBvbmVudHMgPSAk
cGxbJ2NvbXBvbmVudHMnXTsKCgkJCQkvLyBVUkkgY29tcG9uZW50cwoJCQkJJHVyaV9jb21w
b25lbnRzID0gJHVyaTsKCgkJCQkkdGhpcy0+ZGVidWcoJ1BMIGNvbXBvbmVudCBjb3VudDog
Jy5jb3VudCgkcGxfY29tcG9uZW50cykpOwoJCQkJJHRoaXMtPmRlYnVnKCdVUkwgY29tcG9u
ZW50IGNvdW50OiAnLmNvdW50KCR1cmlfY29tcG9uZW50cykpOwoKCQkJCSRkYXRlID0gZmFs
c2U7ICR0aXRsZV9wYWdlX2ZlZWQgPSBmYWxzZTsKCQkJCWZvcmVhY2goJHBsX2NvbXBvbmVu
dHMgYXMgJHBsX2MpCgkJCQkJLy8gQXJlIHdlIGV4cGVjdGluZyBhIGRhdGUgY29tcG9uZW50
PyBJZiBzbyB0aGUgbnVtYmVyIG9mIHBsIGFuZCB1cmkgY29tcG9uZW50cyB3b24ndCBtYXRj
aAoJCQkJCWlmICgkcGxfY1sndHlwZSddID09ICdkYXRlJykKCQkJCQkJJGRhdGUgPSB0cnVl
OwoJCQkJCS8vIERvIHdlIGhhdmUgZWl0aGVyIGEgdGl0bGUsIHBhZ2Ugb3IgYSBmZWVkIGNv
bXBvbmVudD8KCQkJCQllbHNlIGlmIChpbl9hcnJheSgkcGxfY1sndHlwZSddLCBhcnJheSgn
dGl0bGUnLCAncGFnZScsICdmZWVkJykpKQoJCQkJCQkkdGl0bGVfcGFnZV9mZWVkID0gdHJ1
ZTsKCgkJCQlpZiAoISR0aXRsZV9wYWdlX2ZlZWQpCgkJCQkJLy8gSWYgdGhlcmUgaXNuJ3Qg
YSB0aXRsZSwgcGFnZSBvciBmZWVkIGNvbXBvbmVudCB0aGVuIGFwcGVuZCBhIHNwZWNpYWwg
dHlwZSBmb3IgY2xlYXZlciBwYXJ0aWFsIG1hdGNoaW5nCgkJCQkJJHBsX2NvbXBvbmVudHNb
XSA9IGFycmF5KCd0eXBlJyA9PiAndGl0bGVfcGFnZV9mZWVkJywgJ3ByZWZpeCcgPT4gJycs
ICdzdWZmaXgnID0+ICcnLCAncmVnZXgnID0+ICcnLCAndGV4dCcgPT4gJycpOwoKCQkJCS8v
IEV4aXQgZWFybHkgaWYgdGhlcmUgYXJlIG1vcmUgVVJMIGNvbXBvbmVudHMgdGhhbiBQTCBj
b21wb25lbnRzLAoJCQkJLy8gdGFraW5nIGludG8gYWNjb3VudCB3aGV0aGVyIHRoZXJlIGlz
IGEgZGF0YSBjb21wb25lbnQKCQkJCWlmICghJHVyaV9jb21wb25lbnRzWzBdIHx8IGNvdW50
KCR1cmlfY29tcG9uZW50cykgPiBjb3VudCgkcGxfY29tcG9uZW50cykgKyAoJGRhdGUgPyAy
IDogMCkpIHsKCQkJCQkkdGhpcy0+ZGVidWcoJ01vcmUgVVJMIGNvbXBvbmVudHMgdGhhbiBQ
TCBjb21wb25lbnRzJyk7CgkJCQkJY29udGludWU7CgkJCQl9CgoJCQkJLy8gUmVzZXQgcHJl
dGV4dF9yZXBsYWNlbWVudCBhcyB3ZSBhcmUgYWJvdXQgdG8gc3RhcnQgYW5vdGhlciBjb21w
YXJpc29uCgkJCQkkcHJldGV4dF9yZXBsYWNlbWVudCA9IGFycmF5KCdwZXJtbGlua19pZCcg
PT4gJGlkKTsKCgkJCQkvLyBSZXNldCB0aGUgYXJ0aWNsZSBjb250ZXh0IHN0cmluZwoJCQkJ
JGNvbnRleHQgPSBhcnJheSgpOwoJCQkJdW5zZXQoJGNvbnRleHRfc3RyKTsKCQkJCWlmICgh
ZW1wdHkoJGRlc19zZWN0aW9uKSkKCQkJCQkkY29udGV4dFtdID0gImBTZWN0aW9uYCA9ICck
ZGVzX3NlY3Rpb24nIjsKCQkJCWlmICghZW1wdHkoJGRlc19jYXRlZ29yeSkpCgkJCQkJJGNv
bnRleHRbXSA9ICIoYENhdGVnb3J5MWAgPSAnJGRlc19jYXRlZ29yeScgT1IgYENhdGVnb3J5
MmAgPSAnJGRlc19jYXRlZ29yeScpIjsKCQkJCSRjb250ZXh0X3N0ciA9IChjb3VudCgkY29u
dGV4dCkgPiAwID8gJ2FuZCAnLmpvaW4oJyBhbmQgJywgJGNvbnRleHQpIDogJycpOwoKCQkJ
CS8vIEFzc3VtZSB0aGVyZSBpcyBubyBtYXRjaAoJCQkJJHBhcnRpYWxfbWF0Y2ggPSBmYWxz
ZTsKCQkJCSRjbGVhdmVyX3BhcnRpYWxfbWF0Y2ggPSBmYWxzZTsKCgkJCQkvLyBMb29wIHRo
cm91Z2ggdGhlIHBlcm1saW5rIGNvbXBvbmVudHMKCQkJCWZvcmVhY2ggKCRwbF9jb21wb25l
bnRzIGFzICRwbF9jX2luZGV4ID0+ICRwbF9jKSB7CgkJCQkJLy8gQXNzdW1lIHRoZXJlIGlz
IG5vIG1hdGNoCgkJCQkJJG1hdGNoID0gZmFsc2U7CgoJCQkJCS8vIENoZWNrIHRvIHNlZSBp
ZiB0aGVyZSBhcmUgc3RpbGwgVVJJIGNvbXBvbmVudHMgdG8gYmUgY2hlY2tlZC4KCQkJCQlp
ZiAoY291bnQoJHVyaV9jb21wb25lbnRzKSkKCQkJCQkJLy8gR2V0IHRoZSBuZXh0IGNvbXBv
bmVudC4KCQkJCQkJJHVyaV9jID0gYXJyYXlfc2hpZnQoJHVyaV9jb21wb25lbnRzKTsKCgkJ
CQkJZWxzZSBpZiAoISR0aXRsZV9wYWdlX2ZlZWQgJiYgY291bnQoJHBsX2NvbXBvbmVudHMp
IC0gMSA9PSAkdXJpX2NvbXBvbmVudF9jb3VudCkgewoJCQkJCQkvLyBJZiB3ZSBhcHBlbmRl
ZCBhIHRpdGxlX3BhZ2VfZmVlZCBjb21wb25lbnQgZWFybGllciBhbmQgcGVybWxpbmsgYW5k
IFVSSSBjb21wb25lbnRzCgkJCQkJCS8vIGNvdW50cyBhcmUgZXF1YWwsIHdlIG11c3Qgb2Yg
ZmluaXNoZWQgY2hlY2tpbmcgdGhpcyBwZXJtbGluaywgYW5kIGl0IG1hdGNoZXMgc28gYnJl
YWsuCgkJCQkJCSRtYXRjaCA9IHRydWU7CgkJCQkJCWJyZWFrOwoKCQkJCQl9IGVsc2UgewoJ
CQkJCQkvLyBJZiB0aGVyZSBhcmUgbm8gbW9yZSBVUkkgY29tcG9uZW50cyB0aGVuIHdlIGhh
dmUgYSBwYXJ0aWFsIG1hdGNoLgoJCQkJCQkvLyBTdG9yZSB0aGUgcGFydGlhbCBtYXRjaCBk
YXRhIHVubGVzcyB0aGVyZSBoYXMgYmVlbiBhIHByZWNlZGluZyBwZXJtbGluayB3aXRoIHRo
ZQoJCQkJCQkvLyBzYW1lIG51bWJlciBvZiBjb21wb25lbnRzLCBhcyBwZXJtbGluayBoYXZl
IGFscmVhZHkgYmVlbiBzb3J0ZWQgYnkgcHJlY2VkZW5jZS4KCQkJCQkJaWYgKCFhcnJheV9r
ZXlfZXhpc3RzKCR1cmlfY29tcG9uZW50X2NvdW50LCAkdGhpcy0+cGFydGlhbF9tYXRjaGVz
KSkKCQkJCQkJCSR0aGlzLT5wYXJ0aWFsX21hdGNoZXNbJHVyaV9jb21wb25lbnRfY291bnRd
ID0gJHByZXRleHRfcmVwbGFjZW1lbnQ7CgoJCQkJCQkvLyBVbnNldCBwcmV0ZXh0X3JlcGxh
Y2VtZW50IGFzIGNoYW5nZXMgY291bGQgb2YgYmVlbiBtYWRlIGluIGEgcHJlY2VkaW5nIGNv
bXBvbmVudAoJCQkJCQl1bnNldCgkcHJldGV4dF9yZXBsYWNlbWVudCk7CgoJCQkJCQkvLyBC
cmVhayBlYXJseSBmb3JtIHRoZSBmb3JlYWNoIHBlcm1saW5rIGNvbXBvbmVudHMgbG9vcC4K
CQkJCQkJJHBhcnRpYWxfbWF0Y2ggPSB0cnVlOwoJCQkJCQlicmVhazsKCQkJCQl9CgoJCQkJ
CS8vIEV4dHJhY3QgdGhlIHBlcm1saW5rIGNvbXBvbmVudHMuCgkJCQkJZXh0cmFjdCgkcGxf
Yyk7CgoJCQkJCS8vIElmIGl0J3MgYSBkYXRlLCBncmFiIGFuZCBjb21iaW5lIHRoZSBuZXh0
IHR3byBVUkkgY29tcG9uZW50cy4KCQkJCQlpZiAoJHR5cGUgPT0gJ2RhdGUnKQoJCQkJCQkk
dXJpX2MgLj0gJy8nLmFycmF5X3NoaWZ0KCR1cmlfY29tcG9uZW50cykuJy8nLmFycmF5X3No
aWZ0KCR1cmlfY29tcG9uZW50cyk7CgoJCQkJCS8vIERlY29kZSB0aGUgVVJMCgkJCQkJJHVy
aV9jID0gdXJsZGVjb2RlKCR1cmlfYyk7CgoJCQkJCS8vIEFsd2F5cyBjaGVjayB0aGUgdHlw
ZSB1bmxlc3MgdGhlIHByZWZpeCBvciBzdWZmaXggYXJlbid0IHRoZXJlCgkJCQkJJGNoZWNr
X3R5cGUgPSB0cnVlOwoKCQkJCQkvLyBDaGVjayBwcmVmaXgKCQkJCQlpZiAoJHByZWZpeCAm
JiAkdGhpcy0+cHJlZignc2hvd19wcmVmaXgnKSkgewoJCQkJCQkkc2FuaXRpemVkX3ByZWZp
eCA9IHVybGRlY29kZSgkdGhpcy0+ZW5jb2RlX3VybCgkcHJlZml4KSk7CgkJCQkJCWlmICgo
JHBvcyA9IHN0cnBvcygkdXJpX2MsICRzYW5pdGl6ZWRfcHJlZml4KSkgPT09IGZhbHNlIHx8
ICRwb3MgIT0gMCkgewoJCQkJCQkJJGNoZWNrX3R5cGUgPSBmYWxzZTsKCQkJCQkJCSR0aGlz
LT5kZWJ1ZygnQ2FuXCd0IGZpbmQgcHJlZml4OiAnLiRwcmVmaXgpOwoJCQkJCQl9IGVsc2UK
CQkJCQkJCS8vIENoZWNrIHBhc3NlZCwgcmVtb3ZlIHByZWZpeCByZWFkeSBmb3IgdGhlIG5l
eHQgY2hlY2sKCQkJCQkJCSR1cmlfYyA9IHN1YnN0cl9yZXBsYWNlKCR1cmlfYywgJycsIDAs
IHN0cmxlbigkc2FuaXRpemVkX3ByZWZpeCkpOwoJCQkJCX0KCgkJCQkJLy8gQ2hlY2sgc3Vm
Zml4CgkJCQkJaWYgKCRjaGVja190eXBlICYmICRzdWZmaXggJiYgJHRoaXMtPnByZWYoJ3No
b3dfc3VmZml4JykpIHsKCQkJCQkJJHNhbml0aXplZF9zdWZmaXggPSB1cmxkZWNvZGUoJHRo
aXMtPmVuY29kZV91cmwoJHN1ZmZpeCkpOwoJCQkJCQlpZiAoKCRwb3MgPSBzdHJycG9zKCR1
cmlfYywgJHNhbml0aXplZF9zdWZmaXgpKSA9PT0gZmFsc2UpIHsKCQkJCQkJCSRjaGVja190
eXBlID0gZmFsc2U7CgkJCQkJCQkkdGhpcy0+ZGVidWcoJ0NhblwndCBmaW5kIHN1ZmZpeDog
Jy4kc3VmZml4KTsKCQkJCQkJfSBlbHNlCgkJCQkJCQkvLyBDaGVjayBwYXNzZWQsIHJlbW92
ZSBzdWZmaXggcmVhZHkgZm9yIHRoZSBuZXh0IGNoZWNrCgkJCQkJCQkkdXJpX2MgPSBzdWJz
dHJfcmVwbGFjZSgkdXJpX2MsICcnLCAkcG9zLCBzdHJsZW4oJHNhbml0aXplZF9zdWZmaXgp
KTsKCQkJCQl9CgoJCQkJCS8vIEJvdGggdGhlIHByZWZpeCBhbmQgc3VmZml4IHNldHRpbmdz
IGhhdmUgcGFzc2VkCgkJCQkJaWYgKCRjaGVja190eXBlKSB7CgkJCQkJCSR0aGlzLT5kZWJ1
ZygnQ2hlY2tpbmcgaWYgIicuJHVyaV9jLiciIGlzIG9mIHR5cGUgIicuJHR5cGUuJyInKTsK
CQkJCQkJJHVyaV9jID0gZG9TbGFzaCgkdXJpX2MpOwoKCQkJCQkJLy8KCQkJCQkJaWYgKCRw
cmVmc1sncGVybWFsaW5rX3RpdGxlX2Zvcm1hdCddKSB7CgkJCQkJCQkkbXRfc2VhcmNoID0g
YXJyYXkoJy9fLycsICcvXC5odG1sJC8nKTsKCQkJCQkJCSRtdF9yZXBsYWNlID0gYXJyYXko
Jy0nLCAnJyk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkbXRfc2VhcmNoID0gYXJyYXkoJy8o
PzpefF8pKC4pL2UnLCAnL1wuaHRtbCQvJyk7CgkJCQkJCQkkbXRfcmVwbGFjZSA9IGFycmF5
KCJzdHJ0b3VwcGVyKCdcXDEnKSIsICcnKTsKCQkJCQkJfQoJCQkJCQkkbXRfdXJpX2MgPSAk
dGhpcy0+cHJlZigncmVkaXJlY3RfbXRfc3R5bGVfbGlua3MnKQoJCQkJCQkJPyBwcmVnX3Jl
cGxhY2UoJG10X3NlYXJjaCwgJG10X3JlcGxhY2UsICR1cmlfYykKCQkJCQkJCTogJyc7CgoJ
CQkJCQkvLyBDb21wYXJlIGJhc2VkIG9uIHR5cGUKCQkJCQkJc3dpdGNoICgkdHlwZSkgewoJ
CQkJCQkJY2FzZSAnc2VjdGlvbic6CgkJCQkJCQkJaWYgKCRycyA9IHNhZmVfcm93KCduYW1l
JywgJ3R4cF9zZWN0aW9uJywgIihgbmFtZWAgbGlrZSAnJHVyaV9jJyBvciBgbmFtZWAgbGlr
ZSAnJG10X3VyaV9jJykgbGltaXQgMSIpKSB7CgkJCQkJCQkJCSR0aGlzLT5kZWJ1ZygnU2Vj
dGlvbiBuYW1lOiAnLiRyc1snbmFtZSddKTsKCQkJCQkJCQkJJHByZXRleHRfcmVwbGFjZW1l
bnRbJ3MnXSA9ICRyc1snbmFtZSddOwoJCQkJCQkJCQkkY29udGV4dFtdID0gImBTZWN0aW9u
YCA9ICd7JHJzWyduYW1lJ119JyI7CgkJCQkJCQkJCSRtYXRjaCA9IHRydWU7CgkJCQkJCQkJ
fQoJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICdjYXRlZ29yeSc6CgkJCQkJCQkJaWYgKCRy
cyA9IHNhZmVfcm93KCduYW1lJywgJ3R4cF9jYXRlZ29yeScsICIoYG5hbWVgIGxpa2UgJyR1
cmlfYycgb3IgYG5hbWVgIGxpa2UgJyRtdF91cmlfYycpIGFuZCBgdHlwZWAgPSAnYXJ0aWNs
ZScgbGltaXQgMSIpKSB7CgkJCQkJCQkJCSR0aGlzLT5kZWJ1ZygnQ2F0ZWdvcnkgbmFtZTog
Jy4kcnNbJ25hbWUnXSk7CgkJCQkJCQkJCSRwcmV0ZXh0X3JlcGxhY2VtZW50WydjJ10gPSAk
cnNbJ25hbWUnXTsKCQkJCQkJCQkJJGNvbnRleHRbXSA9ICIoYENhdGVnb3J5MWAgPSAneyRy
c1snbmFtZSddfScgT1IgYENhdGVnb3J5MmAgPSAnJHVyaV9jJykiOwoJCQkJCQkJCQkkbWF0
Y2ggPSB0cnVlOwoJCQkJCQkJCX0KCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAndGl0bGUn
OgoJCQkJCQkJCWlmICgkcnMgPSBzYWZlX3JvdygndXJsX3RpdGxlJywgJ3RleHRwYXR0ZXJu
JywgIihgdXJsX3RpdGxlYCBsaWtlICckdXJpX2MnIG9yIGB1cmxfdGl0bGVgIGxpa2UgJyRt
dF91cmlfYycpICRjb250ZXh0X3N0ciBhbmQgYFN0YXR1c2AgPj0gNCBsaW1pdCAxIikpIHsK
CQkJCQkJCQkJJHRoaXMtPmRlYnVnKCdVUkwgVGl0bGU6ICcuJHJzWyd1cmxfdGl0bGUnXSk7
CgkJCQkJCQkJCSRtdF9yZWRpcmVjdCA9ICgkdXJpX2MgIT0gJG10X3VyaV9jKTsKCQkJCQkJ
CQkJJHByZXRleHRfcmVwbGFjZW1lbnRbJ3VybF90aXRsZSddID0gJHJzWyd1cmxfdGl0bGUn
XTsKCQkJCQkJCQkJJG1hdGNoID0gdHJ1ZTsKCQkJCQkJCQl9CgkJCQkJCQlicmVhazsKCQkJ
CQkJCWNhc2UgJ2lkJzoKCQkJCQkJCQlpZiAoJHJzID0gc2FmZV9yb3coJ0lELCBQb3N0ZWQn
LCAndGV4dHBhdHRlcm4nLCAiYElEYCA9ICckdXJpX2MnICRjb250ZXh0X3N0ciBhbmQgYFN0
YXR1c2AgPj0gNCBsaW1pdCAxIikpIHsKCQkJCQkJCQkJJHByZXRleHRfcmVwbGFjZW1lbnRb
J2lkJ10gPSAkcnNbJ0lEJ107CgkJCQkJCQkJCSRwcmV0ZXh0X3JlcGxhY2VtZW50WydQb3N0
ZWQnXSA9ICRyc1snUG9zdGVkJ107CgkJCQkJCQkJCSRwcmV0ZXh0WydudW1QYWdlcyddID0g
MTsKCQkJCQkJCQkJJHByZXRleHRbJ2lzX2FydGljbGVfbGlzdCddID0gZmFsc2U7CgkJCQkJ
CQkJCSRtYXRjaCA9IHRydWU7CgkJCQkJCQkJfQoJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNl
ICdhdXRob3InOgoJCQkJCQkJCWlmICgkYXV0aG9yID0gc2FmZV9maWVsZCgnbmFtZScsICd0
eHBfdXNlcnMnLCAiUmVhbE5hbWUgbGlrZSAnJHVyaV9jJyBsaW1pdCAxIikpIHsKCQkJCQkJ
CQkJJHByZXRleHRfcmVwbGFjZW1lbnRbJ2F1dGhvciddID0gJGF1dGhvcjsKCQkJCQkJCQkJ
JGNvbnRleHRbXSA9ICJgQXV0aG9ySURgID0gJyRhdXRob3InIjsKCQkJCQkJCQkJJG1hdGNo
ID0gdHJ1ZTsKCQkJCQkJCQl9CgkJCQkJCQlicmVhazsKCQkJCQkJCWNhc2UgJ2xvZ2luJzoK
CQkJCQkJCQlpZiAoJGF1dGhvciA9IHNhZmVfZmllbGQoJ25hbWUnLCAndHhwX3VzZXJzJywg
Im5hbWUgbGlrZSAnJHVyaV9jJyBsaW1pdCAxIikpIHsKCQkJCQkJCQkJJHByZXRleHRfcmVw
bGFjZW1lbnRbJ2F1dGhvciddID0gJGF1dGhvcjsKCQkJCQkJCQkJJGNvbnRleHRbXSA9ICJg
QXV0aG9ySURgID0gJyRhdXRob3InIjsKCQkJCQkJCQkJJG1hdGNoID0gdHJ1ZTsKCQkJCQkJ
CQl9CgkJCQkJCQlicmVhazsKCQkJCQkJCWNhc2UgJ2N1c3RvbSc6CgkJCQkJCQkJJGN1c3Rv
bV9vcHRpb25zID0gYXJyYXlfdmFsdWVzKGFycmF5X21hcChhcnJheSgkdGhpcywgImVuY29k
ZV91cmwiKSwgc2FmZV9jb2x1bW4oImN1c3RvbV8kY3VzdG9tIiwgJ3RleHRwYXR0ZXJuJywg
ImN1c3RvbV8kY3VzdG9tICE9ICcnIikpKTsKCQkJCQkJCQlpZiAoJHRoaXMtPnByZWYoJ2Zv
cmNlX2xvd2VyY2FzZV91cmxzJykpCgkJCQkJCQkJCSRjdXN0b21fb3B0aW9ucyA9IGFycmF5
X21hcCgic3RydG9sb3dlciIsICRjdXN0b21fb3B0aW9ucyk7CgkJCQkJCQkJaWYgKGluX2Fy
cmF5KCR1cmlfYywgJGN1c3RvbV9vcHRpb25zKSkgewoJCQkJCQkJCQkkbWF0Y2ggPSB0cnVl
OwoJCQkJCQkJCX0KCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnZGF0ZSc6CgkJCQkJCQkJ
aWYgKHByZWdfbWF0Y2goJy9eXGR7NH1cL1xkezJ9XC9cZHsyfSQvJywgJHVyaV9jKSkgewoJ
CQkJCQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFsnZGF0ZSddID0gc3RyX3JlcGxhY2UoJy8n
LCAnLScsICR1cmlfYyk7CgkJCQkJCQkJCSRtYXRjaCA9IHRydWU7CgkJCQkJCQkJfQoJCQkJ
CQkJYnJlYWs7CgkJCQkJCQljYXNlICd5ZWFyJzoKCQkJCQkJCQlpZiAocHJlZ19tYXRjaCgn
L15cZHs0fSQvJywgJHVyaV9jKSkgewoJCQkJCQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFsn
eWVhciddID0gJHVyaV9jOwoJCQkJCQkJCQkkbWF0Y2ggPSB0cnVlOwoJCQkJCQkJCX0KCQkJ
CQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnbW9udGgnOgoJCQkJCQkJY2FzZSAnZGF5JzoKCQkJ
CQkJCQlpZiAocHJlZ19tYXRjaCgnL15cZHsyfSQvJywgJHVyaV9jKSkgewoJCQkJCQkJCQkk
cHJldGV4dF9yZXBsYWNlbWVudFskdHlwZV0gPSAkdXJpX2M7CgkJCQkJCQkJCSRtYXRjaCA9
IHRydWU7CgkJCQkJCQkJfQoJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICdwYWdlJzoKCQkJ
CQkJCQlpZiAoaXNfbnVtZXJpYygkdXJpX2MpKSB7CgkJCQkJCQkJCSRwcmV0ZXh0X3JlcGxh
Y2VtZW50WydwZyddID0gJHVyaV9jOwoJCQkJCQkJCQkkbWF0Y2ggPSB0cnVlOwoJCQkJCQkJ
CX0KCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnZmVlZCc6CgkJCQkJCQkJaWYgKGluX2Fy
cmF5KCR1cmlfYywgYXJyYXkoJ3JzcycsICdhdG9tJykpKSB7CgkJCQkJCQkJCSRwcmV0ZXh0
X3JlcGxhY2VtZW50WyR1cmlfY10gPSAxOwoJCQkJCQkJCQkkbWF0Y2ggPSB0cnVlOwoJCQkJ
CQkJCX0KCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnc2VhcmNoJzoKCQkJCQkJCQkJJHBy
ZXRleHRfcmVwbGFjZW1lbnRbJ3EnXSA9ICR1cmlfYzsKCQkJCQkJCQkJJG1hdGNoID0gdHJ1
ZTsKCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAndGV4dCc6CgkJCQkJCQkJaWYgKCR0aGlz
LT5lbmNvZGVfdXJsKCR0ZXh0KSA9PSAkdXJpX2MpIHsKCQkJCQkJCQkJJG1hdGNoID0gdHJ1
ZTsKCQkJCQkJCQkJJHByZXRleHRfcmVwbGFjZW1lbnRbInBlcm1saW5rX3RleHRfeyRuYW1l
fSJdID0gJHVyaV9jOwoJCQkJCQkJCX0KCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAncmVn
ZXgnOgoJCQkJCQkJCS8vIENoZWNrIHRvIHNlZSBpZiByZWdleCBpcyB2YWxpZCB3aXRob3V0
IG91dHB1dHRpbmcgZXJyb3IgbWVzc2FnZXMuCgkJCQkJCQkJb2Jfc3RhcnQoKTsKCQkJCQkJ
CQlwcmVnX21hdGNoKCRyZWdleCwgJHVyaV9jLCAkcmVnZXhfbWF0Y2hlcyk7CgkJCQkJCQkJ
JGlzX3ZhbGlkX3JlZ2V4ID0gIShvYl9nZXRfY2xlYW4oKSk7CgkJCQkJCQkJaWYgKCRpc192
YWxpZF9yZWdleCAmJiBAJHJlZ2V4X21hdGNoZXNbMF0pIHsKCQkJCQkJCQkJJG1hdGNoID0g
dHJ1ZTsKCQkJCQkJCQkJJHByZXRleHRfcmVwbGFjZW1lbnRbInBlcm1saW5rX3JlZ2V4X3sk
bmFtZX0iXSA9ICRyZWdleF9tYXRjaGVzWzBdOwoJCQkJCQkJCX0KCQkJCQkJCWJyZWFrOwoJ
CQkJCQl9IC8vIHN3aXRjaCB0eXBlIGVuZAoKCQkJCQkJLy8gVXBkYXRlIHRoZSBhcnRpY2xl
IGNvbnRleHQgc3RyaW5nCgkJCQkJCSRjb250ZXh0X3N0ciA9IChjb3VudCgkY29udGV4dCkg
PiAwID8gJ2FuZCAnLmpvaW4oJyBhbmQgJywgJGNvbnRleHQpIDogJycpOwoKCQkJCQkJJHRo
aXMtPmRlYnVnKCgkbWF0Y2ggPT0gdHJ1ZSkgPyAnWUVTJyA6ICdOTycpOwoKCQkJCQkJaWYg
KCEkbWF0Y2ggJiYgISRjbGVhdmVyX3BhcnRpYWxfbWF0Y2ggJiYgJHRoaXMtPnByZWYoJ3Vz
ZV9jbGVhdmVyX3BhcnRpYWxfbWF0Y2hlcycpKSB7CgkJCQkJCQkvLyBUaGVyZSBoYXNuJ3Qg
YmVlbiBhIG1hdGNoIG9yIGEgY29tcGxldGUgY2xlYXZlciBwYXJ0aWFsIG1hdGNoLiBMZXRz
IHRyeSB0byBiZSBjbGVhdmVyIGFuZAoJCQkJCQkJLy8gY2hlY2sgdG8gc2VlIGlmIHRoaXMg
Y29tcG9uZW50IGlzIGVpdGhlciBhIHRpdGxlLCBwYWdlIG9yIGEgZmVlZC4gVGhpcyBtYWtl
cyBpdCBtb3JlIHByb2JhYmxlCgkJCQkJCQkvLyBhIHN1Y2Nlc3NmdWwgbWF0Y2ggZm9yIGEg
Z2l2ZW4gcGVybWxpbmsgcnVsZSBvY2N1cnMuCgkJCQkJCQkkdGhpcy0+ZGVidWcoJ0NoZWNr
aW5nIGlmICInLiR1cmlfYy4nIiBpcyBvZiB0eXBlICJ0aXRsZV9wYWdlX2ZlZWQiJyk7CgoJ
CQkJCQkJaWYgKCR0eXBlICE9ICd0aXRsZScgJiYgJHVybF90aXRsZSA9IHNhZmVfZmllbGQo
J3VybF90aXRsZScsICd0ZXh0cGF0dGVybicsICJgdXJsX3RpdGxlYCBsaWtlICckdXJpX2Mn
ICRjb250ZXh0X3N0ciBhbmQgYFN0YXR1c2AgPj0gNCBsaW1pdCAxIikpIHsKCQkJCQkJCQkk
cHJldGV4dF9yZXBsYWNlbWVudFsndXJsX3RpdGxlJ10gPSAkdXJsX3RpdGxlOwoJCQkJCQkJ
CSRwcmV0ZXh0WydudW1QYWdlcyddID0gMTsKCQkJCQkJCQkkcHJldGV4dFsnaXNfYXJ0aWNs
ZV9saXN0J10gPSBmYWxzZTsKCQkJCQkJCQkkY2xlYXZlcl9wYXJ0aWFsX21hdGNoID0gdHJ1
ZTsKCQkJCQkJCX0gZWxzZSBpZiAoJHRoaXMtPnByZWYoJ2NsZWFuX3BhZ2VfYXJjaGl2ZV9s
aW5rcycpICYmICR0eXBlICE9ICdwYWdlJyAmJiBpc19udW1lcmljKCR1cmlfYykpIHsKCQkJ
CQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFsncGcnXSA9ICR1cmlfYzsKCQkJCQkJCQkkY2xl
YXZlcl9wYXJ0aWFsX21hdGNoID0gdHJ1ZTsKCQkJCQkJCX0gZWxzZSBpZiAoJHR5cGUgIT0g
J2ZlZWQnICYmIGluX2FycmF5KCR1cmlfYywgYXJyYXkoJ3JzcycsICdhdG9tJykpKSB7CgkJ
CQkJCQkJJHByZXRleHRfcmVwbGFjZW1lbnRbJHVyaV9jXSA9IDE7CgkJCQkJCQkJJGNsZWF2
ZXJfcGFydGlhbF9tYXRjaCA9IHRydWU7CgkJCQkJCQl9CgoJCQkJCQkJJHRoaXMtPmRlYnVn
KCgkY2xlYXZlcl9wYXJ0aWFsX21hdGNoID09IHRydWUpID8gJ1lFUycgOiAnTk8nKTsKCgkJ
CQkJCQlpZiAoJGNsZWF2ZXJfcGFydGlhbF9tYXRjaCkgewoJCQkJCQkJCSR0aGlzLT5jbGVh
dmVyX3BhcnRpYWxfbWF0Y2ggPSAkcHJldGV4dF9yZXBsYWNlbWVudDsKCgkJCQkJCQkJLy8g
VW5zZXQgcHJldGV4dF9yZXBsYWNlbWVudCBhcyBjaGFuZ2VzIGNvdWxkIG9mIGJlZW4gbWFk
ZSBpbiBhIHByZWNlZGluZyBjb21wb25lbnQKCQkJCQkJCQl1bnNldCgkcHJldGV4dF9yZXBs
YWNlbWVudCk7CgoJCQkJCQkJCSRjbGVhdmVyX3BhcnRpYWxfbWF0Y2ggPSB0cnVlOwoJCQkJ
CQkJCWNvbnRpbnVlIDI7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9IC8vIGNoZWNrIHR5cGUg
ZW5kCgoJCQkJCS8vIEJyZWFrIGVhcmx5IGlmIHRoZSBjb21wb25lbnQgZG9lc24ndCBtYXRj
aCwgYXMgdGhlcmUgaXMgbm8gcG9pbnQgY29udGludWluZwoJCQkJCWlmICgkbWF0Y2ggPT0g
ZmFsc2UpIHsKCQkJCQkJLy8gVW5zZXQgcHJldGV4dF9yZXBsYWNlbWVudCBhcyBjaGFuZ2Vz
IGNvdWxkIG9mIGJlZW4gbWFkZSBpbiBhIHByZWNlZGluZyBjb21wb25lbnQKCQkJCQkJdW5z
ZXQoJHByZXRleHRfcmVwbGFjZW1lbnQpOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQl9IC8v
IGZvcmVhY2ggcGVybWxpbmsgY29tcG9uZW50IGVuZAoKCQkJCWlmICghaXNzZXQoJHByZXRl
eHRfcmVwbGFjZW1lbnRbJ2lkJ10pKSB7CgkJCQkJaWYoaXNzZXQoJHByZXRleHRfcmVwbGFj
ZW1lbnRbJ3VybF90aXRsZSddKSkgewoJCQkJCQlpZihpc3NldCgkcHJldGV4dF9yZXBsYWNl
bWVudFsnZGF0ZSddKSkgewoJCQkJCQkJJGRhdGVfdmFsID0gJHByZXRleHRfcmVwbGFjZW1l
bnRbJ2RhdGUnXTsKCQkJCQkJfSBlbHNlIGlmKGlzc2V0KCRwcmV0ZXh0X3JlcGxhY2VtZW50
Wyd5ZWFyJ10pKSB7CgkJCQkJCQkkZGF0ZV92YWwgPSAkcHJldGV4dF9yZXBsYWNlbWVudFsn
eWVhciddOwoJCQkJCQkJaWYoaXNzZXQoJHByZXRleHRfcmVwbGFjZW1lbnRbJ21vbnRoJ10p
KSB7CgkJCQkJCQkJJGRhdGVfdmFsIC49ICctJyAuICRwcmV0ZXh0X3JlcGxhY2VtZW50Wydt
b250aCddOwoJCQkJCQkJCWlmKGlzc2V0KCRwcmV0ZXh0X3JlcGxhY2VtZW50WydkYXknXSkp
IHsKCQkJCQkJCQkJJGRhdGVfdmFsIC49ICctJyAuICRwcmV0ZXh0X3JlcGxhY2VtZW50Wydk
YXknXTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJaWYoaXNzZXQoJGRhdGVf
dmFsKSkgJGNvbnRleHRfc3RyIC49ICIgYW5kIGBQb3N0ZWRgIGxpa2UgJyRkYXRlX3ZhbCUn
IjsKCQkJCQkJaWYgKCRycyA9IHNhZmVfcm93KCdJRCwgUG9zdGVkJywgJ3RleHRwYXR0ZXJu
JywgImB1cmxfdGl0bGVgIGxpa2UgJ3skcHJldGV4dF9yZXBsYWNlbWVudFsndXJsX3RpdGxl
J119JyAkY29udGV4dF9zdHIgYW5kIGBTdGF0dXNgID49IDQgb3JkZXIgYnkgYFBvc3RlZGAg
ZGVzYyBsaW1pdCAxIikpIHsKCQkJCQkJCWlmKGlzc2V0KCRkYXRlX3ZhbCkpICR0aGlzLT5k
ZWJ1ZygnRm91bmQgZGF0ZSBhbmQgdGl0bGUtYmFzZWQgbWF0Y2guJyk7CgkJCQkJCQllbHNl
ICR0aGlzLT5kZWJ1ZygnRm91bmQgdGl0bGUtYmFzZWQgbWF0Y2guJyk7CgkJCQkJCQkkcHJl
dGV4dF9yZXBsYWNlbWVudFsnaWQnXSA9ICRyc1snSUQnXTsKCQkJCQkJCSRwcmV0ZXh0X3Jl
cGxhY2VtZW50WydQb3N0ZWQnXSA9ICRyc1snUG9zdGVkJ107CgkJCQkJCQkkcHJldGV4dFsn
bnVtUGFnZXMnXSA9IDE7CgkJCQkJCQkkcHJldGV4dFsnaXNfYXJ0aWNsZV9saXN0J10gPSBm
YWxzZTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSRtYXRjaCA9IGZhbHNlOwoJCQkJCQkJdW5z
ZXQoJHByZXRleHRfcmVwbGFjZW1lbnQpOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCWlm
ICghaXNzZXQoJHByZXRleHRfcmVwbGFjZW1lbnRbJ2lkJ10pKSB7CgkJCQkJaWYgKGlzc2V0
KCRwcmV0ZXh0X3JlcGxhY2VtZW50Wyd1cmxfdGl0bGUnXSkpIHsKCQkJCQkJaWYgKGlzc2V0
KCRwcmV0ZXh0X3JlcGxhY2VtZW50WydkYXRlJ10pKSB7CgkJCQkJCQkkZGF0ZV92YWwgPSAk
cHJldGV4dF9yZXBsYWNlbWVudFsnZGF0ZSddOwoJCQkJCQl9IGVsc2UgaWYgKGlzc2V0KCRw
cmV0ZXh0X3JlcGxhY2VtZW50Wyd5ZWFyJ10pKSB7CgkJCQkJCQkkZGF0ZV92YWwgPSAkcHJl
dGV4dF9yZXBsYWNlbWVudFsneWVhciddOwoJCQkJCQkJaWYgKGlzc2V0KCRwcmV0ZXh0X3Jl
cGxhY2VtZW50Wydtb250aCddKSkgewoJCQkJCQkJCSRkYXRlX3ZhbCAuPSAnLScgLiAkcHJl
dGV4dF9yZXBsYWNlbWVudFsnbW9udGgnXTsKCQkJCQkJCQlpZiAoaXNzZXQoJHByZXRleHRf
cmVwbGFjZW1lbnRbJ2RheSddKSkgewoJCQkJCQkJCQkkZGF0ZV92YWwgLj0gJy0nIC4gJHBy
ZXRleHRfcmVwbGFjZW1lbnRbJ2RheSddOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJ
CQkJCQlpZiAoaXNzZXQoJGRhdGVfdmFsKSkKCQkJCQkJCSRjb250ZXh0X3N0ciAuPSAiIGFu
ZCBgUG9zdGVkYCBsaWtlICckZGF0ZV92YWwlJyI7CgkJCQkJCWlmICgkcnMgPSBzYWZlX3Jv
dygnSUQsIFBvc3RlZCcsICd0ZXh0cGF0dGVybicsICJgdXJsX3RpdGxlYCBsaWtlICd7JHBy
ZXRleHRfcmVwbGFjZW1lbnRbJ3VybF90aXRsZSddfScgJGNvbnRleHRfc3RyIGFuZCBgU3Rh
dHVzYCA+PSA0IG9yZGVyIGJ5IGBQb3N0ZWRgIGRlc2MgbGltaXQgMSIpKSB7CgkJCQkJCQlp
ZiAoaXNzZXQoJGRhdGVfdmFsKSkKCQkJCQkJCQkkdGhpcy0+ZGVidWcoJ0ZvdW5kIGRhdGUg
YW5kIHRpdGxlLWJhc2VkIG1hdGNoLicpOwoJCQkJCQkJZWxzZQoJCQkJCQkJCSR0aGlzLT5k
ZWJ1ZygnRm91bmQgdGl0bGUtYmFzZWQgbWF0Y2guJyk7CgkJCQkJCQkkcHJldGV4dF9yZXBs
YWNlbWVudFsnaWQnXSA9ICRyc1snSUQnXTsKCQkJCQkJCSRwcmV0ZXh0X3JlcGxhY2VtZW50
WydQb3N0ZWQnXSA9ICRyc1snUG9zdGVkJ107CgkJCQkJCQkkcHJldGV4dFsnbnVtUGFnZXMn
XSA9IDE7CgkJCQkJCQkkcHJldGV4dFsnaXNfYXJ0aWNsZV9saXN0J10gPSBmYWxzZTsKCQkJ
CQkJfSBlbHNlIHsKCQkJCQkJCSRtYXRjaCA9IGZhbHNlOwoJCQkJCQkJdW5zZXQoJHByZXRl
eHRfcmVwbGFjZW1lbnQpOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCWlmICgkbWF0Y2gg
fHwgJHBhcnRpYWxfbWF0Y2ggfHwgJGNsZWF2ZXJfcGFydGlhbF9tYXRjaCkgewoJCQkJCS8v
IEV4dHJhY3QgdGhlIHNldHRpbmdzIGZvciB0aGlzIHBlcm1saW5rCgkJCQkJQGV4dHJhY3Qo
JHBlcm1saW5rc1skcHJldGV4dF9yZXBsYWNlbWVudFsncGVybWxpbmtfaWQnXV1bJ3NldHRp
bmdzJ10pOwoKCQkJCQkvLyBDaGVjayB0aGUgcGVybWxpbmsgc2VjdGlvbiBhbmQgY2F0ZWdv
cnkgY29uZGl0aW9ucwoJCQkJCWlmICgoIWVtcHR5KCRjb25fc2VjdGlvbikgJiYgJGNvbl9z
ZWN0aW9uICE9IEAkcHJldGV4dF9yZXBsYWNlbWVudFsncyddKSB8fAoJCQkJCSghZW1wdHko
JGNvbl9jYXRlZ29yeSkgJiYgJGNvbl9jYXRlZ29yeSAhPSBAJHByZXRleHRfcmVwbGFjZW1l
bnRbJ2MnXSkpIHsKCQkJCQkJJHRoaXMtPmRlYnVnKCdQZXJtbGluayBjb25kaXRpb25zIGZh
aWxlZCcpOwoJCQkJCQlpZiAoQCRjb25fc2VjdGlvbikgICR0aGlzLT5kZWJ1ZygnY29uX3Nl
Y3Rpb24gPSAnLiAkY29uX3NlY3Rpb24pOwoJCQkJCQlpZiAoQCRjb25fY2F0ZWdvcnkpICR0
aGlzLT5kZWJ1ZygnY29uX2NhdGVnb3J5ID0gJy4gJGNvbl9jYXRlZ29yeSk7CgoJCQkJCQl1
bnNldCgkcHJldGV4dF9yZXBsYWNlbWVudCk7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKCRtYXRj
aCAmJiBpc3NldCgkcHJldGV4dF9yZXBsYWNlbWVudCkpCgkJCQkJCSR0aGlzLT5kZWJ1Zygn
V2UgaGF2ZSBhIG1hdGNoIScpOwoKCQkJCQllbHNlIGlmICgkcGFydGlhbF9tYXRjaCAmJiBj
b3VudCgkdGhpcy0+cGFydGlhbF9tYXRjaGVzKSkKCQkJCQkJJHRoaXMtPmRlYnVnKCdXZSBo
YXZlIGEgXCdwYXJ0aWFsIG1hdGNoXCcnKTsKCgkJCQkJZWxzZSBpZiAoJGNsZWF2ZXJfcGFy
dGlhbF9tYXRjaCAmJiBpc3NldCgkY2xlYXZlcl9wYXJ0aWFsX21hdGNoKSkKCQkJCQkJJHRo
aXMtPmRlYnVnKCdXZSBoYXZlIGEgXCdjbGVhdmVyIHBhcnRpYWwgbWF0Y2hcJycpOwoKCQkJ
CQllbHNlIHsKCQkJCQkJJHRoaXMtPmRlYnVnKCdFcnJvcjogQ2FuXCd0IGRldGVybWluZSB0
aGUgY29ycmVjdCB0eXBlIG1hdGNoJyk7CgkJCQkJCS8vIFRoaXMgcGVybWxpbmsgaGFzIGZh
aWxlZCwgY29udGludWUgZXhlY3V0aW9uIG9mIHRoZSBmb3JlYWNoIHBlcm1saW5rcyBsb29w
CgkJCQkJCXVuc2V0KCRwcmV0ZXh0X3JlcGxhY2VtZW50KTsKCQkJCQl9CgkJCQl9CgoJCQkJ
Ly8gV2UgaGF2ZSBhIG1hdGNoCgkJCQlpZiAoQCRwcmV0ZXh0X3JlcGxhY2VtZW50KQoJCQkJ
CWJyZWFrOwoKCQkJfSAvLyBmb3JlYWNoIHBlcm1saW5rcyBlbmQKCgkJCS8vIElmIHRoZXJl
IGlzIG5vIG1hdGNoIHJlc3RvcmUgdGhlIG1vc3QgbGlrZWx5IHBhcnRpYWwgbWF0Y2guIFNv
cnRlZCBieSBudW1iZXIgb2YgY29tcG9uZW50cyBhbmQgdGhlbiBwcmVjZWRlbmNlCgkJCWlm
ICghQCRwcmV0ZXh0X3JlcGxhY2VtZW50ICYmIGNvdW50KCR0aGlzLT5wYXJ0aWFsX21hdGNo
ZXMpKSB7CgkJCQkkcHRfc2xpY2UgPSBhcnJheV9zbGljZSgkdGhpcy0+cGFydGlhbF9tYXRj
aGVzLCAtMSk7CgkJCQkkcHJldGV4dF9yZXBsYWNlbWVudCA9IGFycmF5X3NoaWZ0KCRwdF9z
bGljZSk7CgkJCX0KCQkJdW5zZXQoJHRoaXMtPnBhcnRpYWxfbWF0Y2hlcyk7CgoJCQkvLyBS
ZXN0b3JlIHRoZSBjbGVhdmVyX3BhcnRpYWxfbWF0Y2ggaWYgdGhlcmUgaXMgbm8gb3RoZXIg
bWF0Y2hlcwoJCQlpZiAoIUAkcHJldGV4dF9yZXBsYWNlbWVudCAmJiAkdGhpcy0+Y2xlYXZl
cl9wYXJ0aWFsX21hdGNoKQoJCQkJJHByZXRleHRfcmVwbGFjZW1lbnQgPSAkdGhpcy0+Y2xl
YXZlcl9wYXJ0aWFsX21hdGNoOwoJCQl1bnNldCgkdGhpcy0+Y2xlYXZlcl9wYXJ0aWFsX21h
dGNoKTsKCgkJCS8vIEV4dHJhY3QgdGhlIHNldHRpbmdzIGZvciB0aGlzIHBlcm1saW5rCgkJ
CUBleHRyYWN0KCRwZXJtbGlua3NbJHByZXRleHRfcmVwbGFjZW1lbnRbJ3Blcm1saW5rX2lk
J11dWydzZXR0aW5ncyddKTsKCgkJCS8vIElmIHByZXRleHRfcmVwbGFjZW1lbnQgaXMgc3Rp
bGwgc2V0IGhlcmUgdGhlbiB3ZSBoYXZlIGEgbWF0Y2gKCQkJaWYgKEAkcHJldGV4dF9yZXBs
YWNlbWVudCkgewoJCQkJJHRoaXMtPmRlYnVnKCdQcmV0ZXh0IFJlcGxhY2VtZW50ICcucHJp
bnRfcigkcHJldGV4dF9yZXBsYWNlbWVudCwgMSkpOwoKCQkJCWlmICghZW1wdHkoJGRlc19z
ZWN0aW9uKSkKCQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFsncyddID0gJGRlc19zZWN0aW9u
OwoJCQkJaWYgKCFlbXB0eSgkZGVzX2NhdGVnb3J5KSkKCQkJCQkkcHJldGV4dF9yZXBsYWNl
bWVudFsnYyddID0gJGRlc19jYXRlZ29yeTsKCQkJCWlmICghZW1wdHkoJGRlc19mZWVkKSkK
CQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFskZGVzX2ZlZWRdID0gMTsKCgkJCQlpZiAoQCRw
cmV0ZXh0X3JlcGxhY2VtZW50WydpZCddICYmIEAkcHJldGV4dF9yZXBsYWNlbWVudFsnUG9z
dGVkJ10pIHsKCQkJCQlpZiAoJG5wID0gZ2V0TmV4dFByZXYoJHByZXRleHRfcmVwbGFjZW1l
bnRbJ2lkJ10sICRwcmV0ZXh0X3JlcGxhY2VtZW50WydQb3N0ZWQnXSwgQCRwcmV0ZXh0X3Jl
cGxhY2VtZW50WydzJ10pKQoJCQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudCA9IGFycmF5X21l
cmdlKCRwcmV0ZXh0X3JlcGxhY2VtZW50LCAkbnApOwoJCQkJfQoJCQkJdW5zZXQoJHByZXRl
eHRfcmVwbGFjZW1lbnRbJ1Bvc3RlZCddKTsKCgkJCQkvLyBJZiB0aGVyZSBpcyBhIG1hdGNo
IHRoZW4gd2UgbW9zdCBzZXQgdGhlIGh0dHAgc3RhdHVzIGNvcnJlY3RseSBhcyB0eHAncyBw
cmV0ZXh0IG1pZ2h0IHNldCBpdCB0byA0MDQKCQkJCSRwcmV0ZXh0X3JlcGxhY2VtZW50Wydz
dGF0dXMnXSA9ICcyMDAnOwoKCQkJCS8vIFN0b3JlIHRoZSBvcmdpbmlhbCBIVFRQIHN0YXR1
cyBjb2RlCgkJCQkvLyBXZSBtaWdodCBuZWVkIHRvIGxvZyB0aGUgcGFnZSBoaXQgaWYgaXQg
ZXF1YWxzIDQwNAoJCQkJJG9yZ2luaWFsX3N0YXR1cyA9ICRwcmV0ZXh0WydzdGF0dXMnXTsK
CgkJCQkvLyBUeHAgb25seSBsb29rcyBhdCB0aGUgbW9udGgsIGJ1dCBkdWUgdG8gaG93IHdl
IHBoYXNlIHRoZSBtb250aCB3ZSBjYW4gbWFuaXB1bGF0ZSB0aGUgc3FsIHRvIG91ciBuZWVk
cwoJCQkJaWYgKGFycmF5X2tleV9leGlzdHMoJ2RhdGUnLCAkcHJldGV4dF9yZXBsYWNlbWVu
dCkpIHsKCQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFsnbW9udGgnXSA9ICRwcmV0ZXh0X3Jl
cGxhY2VtZW50WydkYXRlJ107CgkJCQkJdW5zZXQoJHByZXRleHRfcmVwbGFjZW1lbnRbJ2Rh
dGUnXSk7CgkJCQl9IGVsc2UgaWYgKGFycmF5X2tleV9leGlzdHMoJ3llYXInLCAkcHJldGV4
dF9yZXBsYWNlbWVudCkgfHwKCQkJCWFycmF5X2tleV9leGlzdHMoJ21vbnRoJywgJHByZXRl
eHRfcmVwbGFjZW1lbnQpIHx8CgkJCQlhcnJheV9rZXlfZXhpc3RzKCdkYXknLCAkcHJldGV4
dF9yZXBsYWNlbWVudCkpIHsKCQkJCQkkbW9udGggPSAnJzsKCQkJCQkkbW9udGggLj0gKGFy
cmF5X2tleV9leGlzdHMoJ3llYXInLCAkcHJldGV4dF9yZXBsYWNlbWVudCkpCgkJCQkJCT8g
JHByZXRleHRfcmVwbGFjZW1lbnRbJ3llYXInXS4nLScgOiAnX19fXy0nOwoJCQkJCSRtb250
aCAuPSAoYXJyYXlfa2V5X2V4aXN0cygnbW9udGgnLCAkcHJldGV4dF9yZXBsYWNlbWVudCkp
CgkJCQkJCT8gJHByZXRleHRfcmVwbGFjZW1lbnRbJ21vbnRoJ10uJy0nIDogJ19fLSc7CgkJ
CQkJJG1vbnRoIC49IChhcnJheV9rZXlfZXhpc3RzKCdkYXknLCAkcHJldGV4dF9yZXBsYWNl
bWVudCkpCgkJCQkJCT8gJHByZXRleHRfcmVwbGFjZW1lbnRbJ2RheSddLicgJyA6ICdfXyAn
OwoKCQkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFsnbW9udGgnXSA9ICRtb250aDsKCQkJCQl1
bnNldCgkcHJldGV4dF9yZXBsYWNlbWVudFsneWVhciddKTsKCQkJCQl1bnNldCgkcHJldGV4
dF9yZXBsYWNlbWVudFsnZGF5J10pOwoJCQkJfQoKCQkJCS8vIFNlY3Rpb24gbmVlZHMgdG8g
YmUgZGVmaW5lZCBzbyB3ZSBjYW4gYWx3YXlzIGdldCBhIHBhZ2UgdGVtcGxhdGUuCgkJCQlp
ZiAoIWFycmF5X2tleV9leGlzdHMoJ3MnLCAkcHJldGV4dF9yZXBsYWNlbWVudCkpCgkJCQl7
CgkJCQkJaWYgKCFAJHByZXRleHRfcmVwbGFjZW1lbnRbJ2lkJ10pCgkJCQkJCSRwcmV0ZXh0
X3JlcGxhY2VtZW50WydzJ10gPSAnZGVmYXVsdCc7CgkJCQkJZWxzZQoJCQkJCQkkcHJldGV4
dF9yZXBsYWNlbWVudFsncyddID0gc2FmZV9maWVsZCgnU2VjdGlvbicsICd0ZXh0cGF0dGVy
bicsICdJRCA9ICcuJHByZXRleHRfcmVwbGFjZW1lbnRbJ2lkJ10pOwoJCQkJfQoKCQkJCS8v
IFNldCB0aGUgY3NzIGFuZCBwYWdlIHRlbXBsYXRlLCBvdGhlcndpc2Ugd2UgZ2V0IGFuIHVu
a25vd24gc2VjdGlvbgoJCQkJJHNlY3Rpb25fc2V0dGluZ3MgPSBzYWZlX3JvdygnY3NzLCBw
YWdlJywgJ3R4cF9zZWN0aW9uJywgIm5hbWUgPSAneyRwcmV0ZXh0X3JlcGxhY2VtZW50Wydz
J119JyBsaW1pdCAxIik7CgkJCQkkcHJldGV4dF9yZXBsYWNlbWVudFsncGFnZSddID0gKEAk
ZGVzX3BhZ2UpID8gJGRlc19wYWdlIDogJHNlY3Rpb25fc2V0dGluZ3NbJ3BhZ2UnXTsKCQkJ
CSRwcmV0ZXh0X3JlcGxhY2VtZW50Wydjc3MnXSAgPSAkc2VjdGlvbl9zZXR0aW5nc1snY3Nz
J107CgoJCQkJJHRoaXMtPm1hdGNoZWRfcGVybWxpbmsgPSAkcHJldGV4dF9yZXBsYWNlbWVu
dDsKCgkJCQlnbG9iYWwgJHBlcm1saW5rX21vZGU7CgoJCQkJaWYgKGluX2FycmF5KCRwcmVm
c1sncGVybWxpbmtfbW9kZSddLCBhcnJheSgnaWRfdGl0bGUnLCAnc2VjdGlvbl9pZF90aXRs
ZScpKSAmJiBAJHByZXRleHRfcmVwbGFjZW1lbnRbJ3BnJ10gJiYgIUAkcHJldGV4dF9yZXBs
YWNlbWVudFsnaWQnXSkgewoJCQkJCSRwcmV0ZXh0X3JlcGxhY2VtZW50WydpZCddID0gJyc7
CgkJCQkJJHByZXRleHRfcmVwbGFjZW1lbnRbJ2lzX2FydGljbGVfbGlzdCddID0gdHJ1ZTsK
CQkJCX0KCgkJCQkvLyBNZXJnZSBwcmV0ZXh0X3JlcGxhY2VtZW50IHdpdGggcHJldGV4dAoJ
CQkJJHByZXRleHQgPSBhcnJheV9tZXJnZSgkcHJldGV4dCwgJHByZXRleHRfcmVwbGFjZW1l
bnQpOwoKCQkJCWlmIChpc19udW1lcmljKEAkcHJldGV4dFsnaWQnXSkpIHsKCQkJCQkkYSA9
IHNhZmVfcm93KCcqLCB1bml4X3RpbWVzdGFtcChQb3N0ZWQpIGFzIHVQb3N0ZWQsIHVuaXhf
dGltZXN0YW1wKEV4cGlyZXMpIGFzIHVFeHBpcmVzLCB1bml4X3RpbWVzdGFtcChMYXN0TW9k
KSBhcyB1TGFzdE1vZCcsICd0ZXh0cGF0dGVybicsICdJRD0nLmludHZhbCgkcHJldGV4dFsn
aWQnXSkuJyBhbmQgU3RhdHVzID49IDQnKTsKCQkJCQlwb3B1bGF0ZUFydGljbGVEYXRhKCRh
KTsKCQkJCX0KCgkJCQkvLyBFeHBvcnQgcmVxdWlyZWQgdmFsdWVzIHRvIHRoZSBnbG9iYWwg
bmFtZXNwYWNlCgkJCQlmb3JlYWNoIChhcnJheSgnaWQnLCAncycsICdjJywgJ3BnJywgJ2lz
X2FydGljbGVfbGlzdCcsICdwcmV2X2lkJywgJ3ByZXZfdGl0bGUnLCAnbmV4dF9pZCcsICdu
ZXh0X3RpdGxlJywgJ2NzcycpIGFzICRrZXkpIHsKCQkJCQlpZiAoYXJyYXlfa2V5X2V4aXN0
cygka2V5LCAkcHJldGV4dCkpCgkJCQkJCSRHTE9CQUxTWyRrZXldID0gJHByZXRleHRbJGtl
eV07CgkJCQl9CgoJCQkJaWYgKGNvdW50KCR0aGlzLT5tYXRjaGVkX3Blcm1saW5rKSB8fCBA
JG10X3JlZGlyZWN0KSB7CgkJCQkJJHBsX2luZGV4ID0gJHByZXRleHRbJ3Blcm1saW5rX2lk
J107CgkJCQkJaWYgKCFAJG10X3JlZGlyZWN0IHx8ICEkdGhpcy0+cHJlZigncmVkaXJlY3Rf
bXRfc3R5bGVfbGlua3MnKSkgewoJCQkJCQkkcGwgPSAkdGhpcy0+Z2V0X3Blcm1saW5rKCRw
cmV0ZXh0WydwZXJtbGlua19pZCddKTsKCQkJCQkJJHBsX2luZGV4ID0gQCRwbFsnc2V0dGlu
Z3MnXVsnZGVzX3Blcm1saW5rJ107CgkJCQkJfQoKCQkJCQlpZiAoQCRwcmV0ZXh0WydpZCdd
ICYmICRwbF9pbmRleCkgewoJCQkJCQlpZiAoY291bnQoJHRoaXMtPmdldF9wZXJtbGluaygk
cGxfaW5kZXgpKSA+IDApIHsKCQkJCQkJCW9iX2NsZWFuKCk7CgkJCQkJCQlnbG9iYWwgJHNp
dGV1cmw7CgkJCQkJCQkkcnMgPSBzYWZlX3JvdygnKiwgSUQgYXMgdGhpc2lkLCB1bml4X3Rp
bWVzdGFtcChQb3N0ZWQpIGFzIHBvc3RlZCcsICd0ZXh0cGF0dGVybicsICJJRCA9ICd7JHBy
ZXRleHRbJ2lkJ119JyIpOwoJCQkJCQkJJGhvc3QgPSBydHJpbShzdHJfcmVwbGFjZShydHJp
bShkb1N0cmlwKCRwcmV0ZXh0WydzdWJwYXRoJ10pLCAnLycpLCAnJywgaHUpLCAnLycpOwoJ
CQkJCQkJJHRoaXMtPnJlZGlyZWN0KCRob3N0LiR0aGlzLT5fcGVybWxpbmt1cmwoJHJzLCBQ
RVJNTElOS1VSTCwgJHBsX2luZGV4KSwgJHRoaXMtPnByZWYoJ3Blcm1saW5rX3JlZGlyZWN0
X2h0dHBfc3RhdHVzJykpOwoJCQkJCQl9CgkJCQkJfSBlbHNlIGlmICgkdXJsID0gQCRwbFsn
c2V0dGluZ3MnXVsnZGVzX2xvY2F0aW9uJ10pIHsKCQkJCQkJb2JfY2xlYW4oKTsKCQkJCQkJ
JHRoaXMtPnJlZGlyZWN0KCR1cmwsICR0aGlzLT5wcmVmKCd1cmxfcmVkaXJlY3RfaHR0cF9z
dGF0dXMnKSk7CgkJCQkJfQoJCQkJfQoKCQkJCWlmIChAJHByZXRleHRbJ3JzcyddKSB7CgkJ
CQkJaWYgKEAkcHJldGV4dFsncyddKQoJCQkJCQkkX1BPU1RbJ3NlY3Rpb24nXSA9ICRwcmV0
ZXh0WydzJ107CgkJCQkJaWYgKEAkcHJldGV4dFsnYyddKQoJCQkJCQkkX1BPU1RbJ2NhdGVn
b3J5J10gPSAkcHJldGV4dFsnYyddOwoJCQkJCW9iX2NsZWFuKCk7CgkJCQkJaW5jbHVkZSB0
eHBhdGguJy9wdWJsaXNoL3Jzcy5waHAnOwoJCQkJCWV4aXQocnNzKCkpOwoJCQkJfQoKCQkJ
CWlmIChAJHByZXRleHRbJ2F0b20nXSkgewoJCQkJCWlmIChAJHByZXRleHRbJ3MnXSkKCQkJ
CQkJJF9QT1NUWydzZWN0aW9uJ10gPSAkcHJldGV4dFsncyddOwoJCQkJCWlmIChAJHByZXRl
eHRbJ2MnXSkKCQkJCQkJJF9QT1NUWydjYXRlZ29yeSddID0gJHByZXRleHRbJ2MnXTsKCQkJ
CQlvYl9jbGVhbigpOwoJCQkJCWluY2x1ZGUgdHhwYXRoLicvcHVibGlzaC9hdG9tLnBocCc7
CgkJCQkJZXhpdChhdG9tKCkpOwoJCQkJfQoKCQkJCSR0aGlzLT5kZWJ1ZygnUHJldGV4dCAn
LnByaW50X3IoJHByZXRleHQsIDEpKTsKCQkJfSBlbHNlIHsKCQkJCSR0aGlzLT5kZWJ1Zygn
Tk8gQ0hBTkdFUyBNQURFJyk7CgkJCX0KCgkJCS8vIExvZyB0aGlzIHBhZ2UgaGl0CgkJCWlm
IChAJG9yZ2luaWFsX3N0YXR1cyA9PSA0MDQpCgkJCQlsb2dfaGl0KCRwcmV0ZXh0WydzdGF0
dXMnXSk7CgoJCQkvLyBTdGFydCBvdXRwdXQgYnVmZmVyaW5nIGFuZCBwc2V1ZG8gY2FsbGJh
Y2sgdG8gdGV4dHBhdHRlcm5fZW5kCgkJCW9iX3N0YXJ0KGFycmF5KCYkdGhpcywgJ190ZXh0
cGF0dGVybl9lbmRfY2FsbGJhY2snKSk7CgoJCQkvLyBUeFAgNC4wLjUgKHIyNDM2KSBpbnRy
b2R1Y2VkIHRoZSB0ZXh0cGF0dGVybl9lbmQgY2FsbGJhY2sgbWFraW5nIHRoZSBmb2xsb3dp
bmcgcmVkdW5kYW50CgkJCSR2ZXJzaW9uID0gYXJyYXlfc3VtKGFycmF5X21hcCgKCQkJCWNy
ZWF0ZV9mdW5jdGlvbignJGxpbmUnLCAnaWYgKHByZWdfbWF0Y2goXCcvXlwkJy4nTGFzdENo
YW5nZWRSZXZpc2lvbjogKFx3KykgXCQvXCcsICRsaW5lLCAkbWF0Y2gpKSByZXR1cm4gJG1h
dGNoWzFdOycpLAoJCQkJQGZpbGUodHhwYXRoIC4gJy9wdWJsaXNoLnBocCcpCgkJCSkpOwoJ
CQlpZiAoJHZlcnNpb24gPj0gJzI0MzYnKSByZXR1cm47CgoJCQkvLyBSZW1vdmUgdGhlIHBs
dWdpbiBjYWxsYmFja3Mgd2hpY2ggaGF2ZSBhbHJlYWR5IGJlZW4gY2FsbGVkCgkJCWZ1bmN0
aW9uIGZpbHRlcl9jYWxsYmFja3MoJGMpIHsKCQkJCWlmICgkY1snZXZlbnQnXSE9J3RleHRw
YXR0ZXJuJykgcmV0dXJuIHRydWU7CgkJCQlpZiAoQCRjWydmdW5jdGlvbiddWzBdLT5wbHVn
aW5fbmFtZSA9PSAnZ2JwX3Blcm1hbmVudF9saW5rcycgJiYKCQkJCQkJQCRjWydmdW5jdGlv
biddWzFdID09ICdfdGV4dHBhdHRlcm4nKQoJCQkJewoJCQkJCSRHTE9CQUxTWydnYnBfZm91
bmRfc2VsZiddID0gdHJ1ZTsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCQlyZXR1cm4g
QCRHTE9CQUxTWydnYnBfZm91bmRfc2VsZiddOwoJCQl9CgkJCSRwbHVnaW5fY2FsbGJhY2sg
PSBhcnJheV9maWx0ZXIoJHBsdWdpbl9jYWxsYmFjaywgJ2ZpbHRlcl9jYWxsYmFja3MnKTsK
CQkJdW5zZXQoJEdMT0JBTFNbJ2dicF9mb3VuZF9zZWxmJ10pOwoKCQkJLy8gUmUtY2FsbCB0
ZXh0cGF0dGVybgoJCQl0ZXh0cGF0dGVybigpOwoKCQkJLy8gQ2FsbCBjdXN0b20gdGV4dHBh
dHRlcm5fZW5kIGNhbGxiYWNrCgkJCSR0aGlzLT5fdGV4dHBhdHRlcm5fZW5kKCk7CgoJCQkv
LyB0ZXh0cGF0dGVybigpIGhhcyBydW4sIGtpbGwgdGhlIGNvbm5lY3Rpb24KCQkJZGllKCk7
CgkJfQoKCX0gLy8gZnVuY3Rpb24gX3RleHRwYXR0ZXJuIGVuZAoKCWZ1bmN0aW9uIF90ZXh0
cGF0dGVybl9lbmQgKCkgewoJCS8vIFJlZGlyZWN0IHRvIGEgNDA0IGlmIHRoZSBwYWdlIG51
bWJlciBpcyBncmVhdGVyIHRoYW4gdGhlIG1heCBudW1iZXIgb2YgcGFnZXMKCQkvLyBIYXMg
dG8gYmUgYWZ0ZXIgdGV4dHBhdHRlcm4oKSBhcyAkdGhpc3BhZ2UgaXMgc2V0IGR1cmluZyA8
dHhwOmFydGljbGUgLz4KCQlnbG9iYWwgJHRoaXNwYWdlLCAkcHJldGV4dDsKCQlpZiAoKEAk
cHJldGV4dFsncGcnXSAmJiBpc3NldCgkdGhpc3BhZ2UpKSAmJgoJCSgkdGhpc3BhZ2VbJ251
bVBhZ2VzJ10gPCAkcHJldGV4dFsncGcnXSkpIHsKCQkJb2JfZW5kX2NsZWFuKCk7CgkJCXR4
cF9kaWUoZ1R4dCgnNDA0X25vdF9mb3VuZCcpLCAnNDA0Jyk7CgkJfQoKCQkvLyBTdG9wIG91
dHB1dCBidWZmZXJpbmcsIHRoaXMgc2VuZHMgdGhlIGJ1ZmZlciB0byBfdGV4dHBhdHRlcm5f
ZW5kX2NhbGxiYWNrKCkKCQl3aGlsZSAoQG9iX2VuZF9mbHVzaCgpKTsKCgl9IC8vIGZ1bmN0
aW9uIF90ZXh0cGF0dGVybl9lbmQgZW5kCgoJZnVuY3Rpb24gX3RleHRwYXR0ZXJuX2VuZF9j
YWxsYmFjayAoJGh0bWwsICRvdmVycmlkZSA9ICcnKSB7CgkJZ2xvYmFsICRwcmV0ZXh0LCAk
cHJvZHVjdGlvbl9zdGF0dXM7CgoJCWlmICgkb3ZlcnJpZGUpICRwcmV0ZXh0WydwZXJtbGlu
a19vdmVycmlkZSddID0gJG92ZXJyaWRlOwoJCSRodG1sID0gcHJlZ19yZXBsYWNlX2NhbGxi
YWNrKAoJCQknJWhyZWY9IignLmh1Lid8XD8pKFteIl0qKSIlJywKCQkJYXJyYXkoJiR0aGlz
LCAnX3BhZ2VsaW5rdXJsJyksCgkJCSRodG1sCgkJKTsKCQl1bnNldCgkcHJldGV4dFsncGVy
bWxpbmtfb3ZlcnJpZGUnXSk7CgoJCWlmICgkdGhpcy0+cHJlZignZGVidWcnKSAmJiBpbl9h
cnJheSgkcHJvZHVjdGlvbl9zdGF0dXMsIGFycmF5KCdkZWJ1ZycsICd0ZXN0aW5nJykpKSB7
CgkJCSRkZWJ1ZyA9IGpvaW4obiwgJHRoaXMtPmJ1ZmZlcl9kZWJ1Zyk7CgkJCSR0aGlzLT5i
dWZmZXJfZGVidWcgPSBhcnJheSgpOwoJCQlpZiAoJGRlYnVnKQoJCQkJJGh0bWwgPSBjb21t
ZW50KG4uJGRlYnVnLm4pIC4gJGh0bWw7CgkJfQoKCQlyZXR1cm4gJGh0bWw7Cgl9IC8vIGZ1
bmN0aW9uIF90ZXh0cGF0dGVybl9lbmRfY2FsbGJhY2sgZW5kCgoJZnVuY3Rpb24gY2hlY2tf
cGVybWxpbmtfY29uZGl0aW9ucyAoJHBsLCAkYXJ0aWNsZV9hcnJheSkgewoJCWlmIChlbXB0
eSgkYXJ0aWNsZV9hcnJheVsnc2VjdGlvbiddKSkgJGFydGljbGVfYXJyYXlbJ3NlY3Rpb24n
XSA9IEAkYXJ0aWNsZV9hcnJheVsnU2VjdGlvbiddOwoJCWlmIChlbXB0eSgkYXJ0aWNsZV9h
cnJheVsnY2F0ZWdvcnkxJ10pKSAkYXJ0aWNsZV9hcnJheVsnY2F0ZWdvcnkxJ10gPSBAJGFy
dGljbGVfYXJyYXlbJ0NhdGVnb3J5MSddOwoJCWlmIChlbXB0eSgkYXJ0aWNsZV9hcnJheVsn
Y2F0ZWdvcnkyJ10pKSAkYXJ0aWNsZV9hcnJheVsnY2F0ZWdvcnkyJ10gPSBAJGFydGljbGVf
YXJyYXlbJ0NhdGVnb3J5MiddOwoKCQlpZiAoQCRwbFsnc2V0dGluZ3MnXVsnY29uX2NhdGVn
b3J5J10gJiYgKCRwbFsnc2V0dGluZ3MnXVsnY29uX2NhdGVnb3J5J10gIT0gJGFydGljbGVf
YXJyYXlbJ2NhdGVnb3J5MSddIHx8ICRwbFsnc2V0dGluZ3MnXVsnY29uX2NhdGVnb3J5J10g
IT0gJGFydGljbGVfYXJyYXlbJ2NhdGVnb3J5MiddKSkKCQkJcmV0dXJuIGZhbHNlOwoJCWlm
IChAJHBsWydzZXR0aW5ncyddWydjb25fc2VjdGlvbiddICYmICRwbFsnc2V0dGluZ3MnXVsn
Y29uX3NlY3Rpb24nXSAhPSAkYXJ0aWNsZV9hcnJheVsnc2VjdGlvbiddKQoJCQlyZXR1cm4g
ZmFsc2U7CgoJCXJldHVybiB0cnVlOwoJfQoKCWZ1bmN0aW9uIF9wZXJtbGlua3VybCAoJGFy
dGljbGVfYXJyYXksICR0eXBlID0gUEVSTUxJTktVUkwsICRwbF9pbmRleCA9IE5VTEwpIHsK
CQlnbG9iYWwgJHByZXRleHQsICRwcmVmcywgJHByb2R1Y3Rpb25fc3RhdHVzOwoKCQlpZiAo
JHR5cGUgPT0gUEFHRUxJTktVUkwpCgkJCXJldHVybiAkdGhpcy0+dG9nZ2xlX2N1c3RvbV91
cmxfZnVuYygncGFnZWxpbmt1cmwnLCAkYXJ0aWNsZV9hcnJheSk7CgoJCWlmIChlbXB0eSgk
YXJ0aWNsZV9hcnJheSkpIHJldHVybjsKCgkJaWYgKCRwbF9pbmRleCkKCQkJJHBsID0gJHRo
aXMtPmdldF9wZXJtbGluaygkcGxfaW5kZXgpOwoJCWVsc2UgewoJCQkvLyBHZXQgdGhlIG1h
dGNoZWQgcHJldGV4dCByZXBsYWNlbWVudCBhcnJheS4KCQkJJG1hdGNoZWQgPSAoY291bnQo
JHRoaXMtPm1hdGNoZWRfcGVybWxpbmspKQoJCQk/ICR0aGlzLT5tYXRjaGVkX3Blcm1saW5r
CgkJCTogQGFycmF5X3NoaWZ0KGFycmF5X3NsaWNlKCR0aGlzLT5wYXJ0aWFsX21hdGNoZXMs
IC0xKSk7CgoJCQlpZiAoIWlzc2V0KCRwbCkgJiYgJG1hdGNoZWQgJiYgYXJyYXlfa2V5X2V4
aXN0cygnaWQnLCAkbWF0Y2hlZCkpIHsKCQkJCS8vIFRoZSBwZXJtbGluayBpZCBpcyBzdG9y
ZWQgaW4gdGhlIHByZXRleHQgcmVwbGFjZW1lbnQgYXJyYXksIHNvIHdlIGNhbiBmaW5kIHRo
ZSBwZXJtbGluay4KCQkJCSRwbCA9ICR0aGlzLT5nZXRfcGVybWxpbmsoJG1hdGNoZWRbJ3Bl
cm1saW5rX2lkJ10pOwoJCQkJZm9yZWFjaCAoJHBsWydjb21wb25lbnRzJ10gYXMgJHBsX2Mp
CgkJCQkJaWYgKGluX2FycmF5KCRwbF9jWyd0eXBlJ10sIGFycmF5KCdmZWVkJywgJ3BhZ2Un
KSkgfHwgISR0aGlzLT5jaGVja19wZXJtbGlua19jb25kaXRpb25zKCRwbCwgJGFydGljbGVf
YXJyYXkpKSB7CgkJCQkJCXVuc2V0KCRwbCk7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJfQoK
CQkJaWYgKCFpc3NldCgkcGwpKSB7CgkJCQkvLyBXZSBoYXZlIG5vIHBlcm1saW5rIGlkIHNv
IGdyYWIgdGhlIHBlcm1saW5rIHdpdGggdGhlIGhpZ2hlc3QgcHJlY2VkZW5jZS4KCQkJCSRw
ZXJtbGlua3MgPSAkdGhpcy0+Z2V0X2FsbF9wZXJtbGlua3MoMSwgYXJyYXkoJ2ZlZWQnLCAn
cGFnZScpKTsKCQkJCWZvcmVhY2ggKCRwZXJtbGlua3MgYXMgJGtleSA9PiAkcGwpCgkJCQkJ
aWYgKCEkdGhpcy0+Y2hlY2tfcGVybWxpbmtfY29uZGl0aW9ucygkcGwsICRhcnRpY2xlX2Fy
cmF5KSkKCQkJCQkJdW5zZXQoJHBlcm1saW5rc1ska2V5XSk7CgkJCQkkcGwgPSBhcnJheV9z
aGlmdCgkcGVybWxpbmtzKTsKCQkJfQoJCX0KCgkJJHVyaSA9ICcnOwoKCQlpZiAoaXNfYXJy
YXkoJHBsKSAmJiBhcnJheV9rZXlfZXhpc3RzKCdjb21wb25lbnRzJywgJHBsKSkgewoJCQll
eHRyYWN0KCRhcnRpY2xlX2FycmF5KTsKCgkJCWlmICghaXNzZXQoJHRpdGxlKSkgJHRpdGxl
ID0gJFRpdGxlOwoJCQlpZiAoZW1wdHkoJHVybF90aXRsZSkpICR1cmxfdGl0bGUgPSBzdHJp
cFNwYWNlKCR0aXRsZSk7CgkJCWlmIChlbXB0eSgkc2VjdGlvbikpICRzZWN0aW9uID0gJFNl
Y3Rpb247CgkJCWlmIChlbXB0eSgkcG9zdGVkKSkgJHBvc3RlZCA9ICRQb3N0ZWQ7CgkJCWlm
IChlbXB0eSgkYXV0aG9yaWQpKSAkYXV0aG9yaWQgPSBAJEF1dGhvcklEOwoJCQlpZiAoZW1w
dHkoJGNhdGVnb3J5MSkpICRjYXRlZ29yeTEgPSBAJENhdGVnb3J5MTsKCQkJaWYgKGVtcHR5
KCRjYXRlZ29yeTIpKSAkY2F0ZWdvcnkyID0gQCRDYXRlZ29yeTI7CgkJCWlmIChlbXB0eSgk
dGhpc2lkKSkgJHRoaXNpZCA9ICRJRDsKCgkJCSRwbF9jb21wb25lbnRzID0gJHBsWydjb21w
b25lbnRzJ107CgoJCQkvLyBDaGVjayB0byBzZWUgaWYgdGhlcmUgaXMgYSB0aXRsZSBjb21w
b25lbnQuCgkJCSR0aXRsZSA9IGZhbHNlOwoJCQlmb3JlYWNoKCRwbF9jb21wb25lbnRzIGFz
ICRwbF9jKQoJCQkJaWYgKCRwbF9jWyd0eXBlJ10gPT0gJ3RpdGxlJyB8fCAkcGxfY1sndHlw
ZSddID09ICdpZCcpCgkJCQkJJHRpdGxlID0gdHJ1ZTsKCgkJCS8vIElmIHRoZXJlIGlzbid0
IGEgdGl0bGUgY29tcG9uZW50IHRoZW4gd2UgbmVlZCB0byBhcHBlbmQgb25lIHRvIHRoZSBl
bmQgb2YgdGhlIFVSSQoJCQlpZiAoISR0aXRsZSAmJiAkdGhpcy0+cHJlZignYXV0b21hdGlj
YWxseV9hcHBlbmRfdGl0bGUnKSkKCQkJCSRwbF9jb21wb25lbnRzW10gPSBhcnJheSgndHlw
ZScgPT4gJ3RpdGxlJywgJ3ByZWZpeCcgPT4gJycsICdzdWZmaXgnID0+ICcnLCAncmVnZXgn
ID0+ICcnLCAndGV4dCcgPT4gJycpOwoKCQkJJHVyaSA9IHJ0cmltKGRvU3RyaXAoQCRwcmV0
ZXh0WydzdWJwYXRoJ10pLCAnLycpOwoJCQlmb3JlYWNoICgkcGxfY29tcG9uZW50cyBhcyAk
cGxfYykgewoJCQkJJHVyaSAuPSAnLyc7CgoJCQkJJHR5cGUgPSAkcGxfY1sndHlwZSddOwoJ
CQkJc3dpdGNoICgkdHlwZSkgewoJCQkJCWNhc2UgJ2NhdGVnb3J5JzoKCQkJCQkJaWYgKCFA
JHBsX2NbJ2NhdGVnb3J5J10pICRwbF9jWydjYXRlZ29yeSddID0gMTsKCQkJCQkJJHByaW1h
cnkgPSAnY2F0ZWdvcnknLiAkcGxfY1snY2F0ZWdvcnknXTsKCQkJCQkJJHNlY29uZGFyeSA9
ICdjYXRlZ29yeScuICgzLShpbnQpJHBsX2NbJ2NhdGVnb3J5J10pOwoJCQkJCQkkY2hlY2tf
Y29udGV4dCA9ICgkdGhpcy0+cHJlZignam9pbl9wcmV0ZXh0X3RvX3BhZ2VsaW5rcycpICYm
ICR0aGlzLT5wcmVmKCdjaGVja19wcmV0ZXh0X2NhdGVnb3J5X2NvbnRleHQnKSk7CgkJCQkJ
CWlmICghJGNoZWNrX2NvbnRleHQgfHwgJCRwcmltYXJ5ID09ICRwcmV0ZXh0WydjJ10pCgkJ
CQkJCQkkdXJpX2MgPSAkJHByaW1hcnk7CgkJCQkJCWVsc2UgaWYgKCEkY2hlY2tfY29udGV4
dCB8fCAkJHNlY29uZGFyeSA9PSAkcHJldGV4dFsnYyddKQoJCQkJCQkJJHVyaV9jID0gJCRz
ZWNvbmRhcnk7CgkJCQkJCWVsc2UgaWYgKCR0aGlzLT5wcmVmKCdkZWJ1ZycpICYmIGluX2Fy
cmF5KCRwcm9kdWN0aW9uX3N0YXR1cywgYXJyYXkoJ2RlYnVnJywgJ3Rlc3RpbmcnKSkpCgkJ
CQkJCQkkdXJpX2MgPSAnLS1JTlZBTElEX0NBVEVHT1JZLS0nOwoJCQkJCQllbHNlIHsKCQkJ
CQkJCXVuc2V0KCR1cmkpOwoJCQkJCQkJYnJlYWsgMjsKCQkJCQkJfQoJCQkJCWJyZWFrOwoJ
CQkJCWNhc2UgJ3NlY3Rpb24nOgoJCQkJCQkkY2hlY2tfY29udGV4dCA9ICgkdGhpcy0+cHJl
Zignam9pbl9wcmV0ZXh0X3RvX3BhZ2VsaW5rcycpICYmICR0aGlzLT5wcmVmKCdjaGVja19w
cmV0ZXh0X3NlY3Rpb25fY29udGV4dCcpKTsKCQkJCQkJaWYgKCEkY2hlY2tfY29udGV4dCB8
fCAkc2VjdGlvbiA9PSAkcHJldGV4dFsncyddKQoJCQkJCQkJJHVyaV9jID0gJHNlY3Rpb247
CgkJCQkJCWVsc2UgewoJCQkJCQkJdW5zZXQoJHVyaSk7CgkJCQkJCQlicmVhayAyOwoJCQkJ
CQl9CgkJCQkJYnJlYWs7CgkJCQkJY2FzZSAndGl0bGUnOiAkdXJpX2MgPSAkdXJsX3RpdGxl
OyBicmVhazsKCQkJCQljYXNlICdpZCc6ICR1cmlfYyA9ICR0aGlzaWQ7IGJyZWFrOwoJCQkJ
CWNhc2UgJ2F1dGhvcic6ICR1cmlfYyA9IHNhZmVfZmllbGQoJ1JlYWxOYW1lJywgJ3R4cF91
c2VycycsICJuYW1lIGxpa2UgJ3skYXV0aG9yaWR9JyIpOyBicmVhazsKCQkJCQljYXNlICds
b2dpbic6ICR1cmlfYyA9ICRhdXRob3JpZDsgYnJlYWs7CgkJCQkJY2FzZSAnZGF0ZSc6ICR1
cmlfYyA9IGV4cGxvZGUoJy8nLCBkYXRlKCdZL20vZCcsICRwb3N0ZWQpKTsgYnJlYWs7CgkJ
CQkJY2FzZSAneWVhcic6ICR1cmlfYyA9IGRhdGUoJ1knLCAkcG9zdGVkKTsgYnJlYWs7CgkJ
CQkJY2FzZSAnbW9udGgnOiAkdXJpX2MgPSBkYXRlKCdtJywgJHBvc3RlZCk7IGJyZWFrOwoJ
CQkJCWNhc2UgJ2RheSc6ICR1cmlfYyA9IGRhdGUoJ2QnLCAkcG9zdGVkKTsgYnJlYWs7CgkJ
CQkJY2FzZSAnY3VzdG9tJzoKCQkJCQkJaWYgKCR1cmlfYyA9IEAkYXJ0aWNsZV9hcnJheVsk
cHJlZnNbImN1c3RvbV97JHBsX2NbJ2N1c3RvbSddfV9zZXQiXV0pOwoJCQkJCQllbHNlIGlm
ICgkdXJpX2MgPSBAJGFydGljbGVfYXJyYXlbImN1c3RvbV97JHBsX2NbJ2N1c3RvbSddfSJd
KTsKCQkJCQkJZWxzZSBpZiAoJHRoaXMtPnByZWYoJ2RlYnVnJykgJiYgaW5fYXJyYXkoJHBy
b2R1Y3Rpb25fc3RhdHVzLCBhcnJheSgnZGVidWcnLCAndGVzdGluZycpKSkKCQkJCQkJCSR1
cmlfYyA9ICctLVVOU0VUX0NVU1RPTV9GSUVMRC0tJzsKCQkJCQkJZWxzZSB7CgkJCQkJCQl1
bnNldCgkdXJpKTsKCQkJCQkJCWJyZWFrIDI7CgkJCQkJCX0KCQkJCQlicmVhazsKCQkJCQlj
YXNlICd0ZXh0JzogJHVyaV9jID0gJHBsX2NbJ3RleHQnXTsgYnJlYWs7CgkJCQkJY2FzZSAn
cmVnZXgnOgoJCQkJCQkvLyBDaGVjayB0byBzZWUgaWYgcmVnZXggaXMgdmFsaWQgd2l0aG91
dCBvdXRwdXR0aW5nIGVycm9yIG1lc3NhZ2VzLgoJCQkJCQlvYl9zdGFydCgpOwoJCQkJCQlw
cmVnX21hdGNoKCRwbF9jWydyZWdleCddLCAkcGxfY1sncmVnZXgnXSwgJHJlZ2V4X21hdGNo
ZXMpOwoJCQkJCQkkaXNfdmFsaWRfcmVnZXggPSAhKG9iX2dldF9jbGVhbigpKTsKCQkJCQkJ
aWYgKCRpc192YWxpZF9yZWdleCkgewoJCQkJCQkJJGtleSA9ICJwZXJtbGlua19yZWdleF97
JHBsX2NbJ25hbWUnXX0iOwoJCQkJCQkJJHVyaV9jID0gKGFycmF5X2tleV9leGlzdHMoJGtl
eSwgJHByZXRleHQpKSA/ICRwcmV0ZXh0WyRrZXldIDogJHJlZ2V4X21hdGNoZXNbMF07CgkJ
CQkJCX0gZWxzZSBpZiAoJHRoaXMtPnByZWYoJ2RlYnVnJykpCgkJCQkJCQkkdXJpX2MgPSAn
LS1JTlZBTElEX1JFR0VYLS0nOwoJCQkJCWJyZWFrOwoJCQkJfQoKCQkJCWlmIChlbXB0eSgk
dXJpX2MpKQoJCQkJCWlmICgkdGhpcy0+cHJlZignZGVidWcnKSAmJiBpbl9hcnJheSgkcHJv
ZHVjdGlvbl9zdGF0dXMsIGFycmF5KCdkZWJ1ZycsICd0ZXN0aW5nJykpKQoJCQkJCQkkdXJp
X2MgPSAnLS1QRVJNTElOS19GT1JNQVRfRVJST1ItLSc7CgkJCQkJZWxzZSB7CgkJCQkJCXVu
c2V0KCR1cmkpOwoJCQkJCQlicmVhazsKCQkJCQl9CgoJCQkJaWYgKEAkcGxfY1sncHJlZml4
J10pCgkJCQkJJHVyaSAuPSAkdGhpcy0+ZW5jb2RlX3VybCgkcGxfY1sncHJlZml4J10pOwoK
CQkJCWlmIChpc19hcnJheSgkdXJpX2MpKSB7CgkJCQkJZm9yZWFjaCAoJHVyaV9jIGFzICR1
cmlfYzIpCgkJCQkJCSR1cmkgLj0gJHRoaXMtPmVuY29kZV91cmwoJHVyaV9jMikgLiAnLyc7
CgkJCQkJJHVyaSA9IHJ0cmltKCR1cmksICcvJyk7CgkJCQl9IGVsc2UKCQkJCQkkdXJpIC49
ICR0aGlzLT5lbmNvZGVfdXJsKCR1cmlfYyk7CgoJCQkJaWYgKEAkcGxfY1snc3VmZml4J10p
CgkJCQkJJHVyaSAuPSAkdGhpcy0+ZW5jb2RlX3VybCgkcGxfY1snc3VmZml4J10pOwoKCQkJ
CXVuc2V0KCR1cmlfYyk7CgkJCX0KCgkJCWlmIChpc3NldCgkdXJpKSkKCQkJCSR1cmkgLj0g
Jy8nOwoJCX0KCgkJaWYgKCR1cmlfZW1wdHkgPSBlbXB0eSgkdXJpKSkgewoJCQkvLyBJdCBp
cyBwb3NzaWJsZSB0aGUgdXJpIGlzIHN0aWxsIGVtcHR5IGlmIHRoZXJlIGlzIG5vIG1hdGNo
IG9yIGlmIHdlJ3JlIHVzaW5nCgkJCS8vIHN0cmljdCBtYXRjaGluZyBpZiBzbyB0cnkgdGhl
IGRlZmF1bHQgcGVybWxpbmsgbW9kZS4KCQkJJHVyaSA9ICR0aGlzLT50b2dnbGVfcGVybWxp
bmtfbW9kZSgncGVybWxpbmt1cmwnLCAkYXJ0aWNsZV9hcnJheSk7CgkJfQoKCQlpZiAoJHRo
aXMtPnByZWYoJ29taXRfdHJhaWxpbmdfc2xhc2gnKSkKCQkJJHVyaSA9IHJ0cmltKCR1cmks
ICcvJyk7CgoJCWlmICghJHVyaV9lbXB0eSAmJiBpbl9hcnJheSh0eHBhdGguJy9wdWJsaXNo
L3Jzcy5waHAnLCBnZXRfaW5jbHVkZWRfZmlsZXMoKSkgfHwgaW5fYXJyYXkodHhwYXRoLicv
cHVibGlzaC9hdG9tLnBocCcsIGdldF9pbmNsdWRlZF9maWxlcygpKSB8fCB0eHBpbnRlcmZh
Y2UgPT0gJ2FkbWluJykgewoJCQkkaG9zdCA9IHJ0cmltKHN0cl9yZXBsYWNlKHJ0cmltKGRv
U3RyaXAoQCRwcmV0ZXh0WydzdWJwYXRoJ10pLCAnLycpLCAnJywgaHUpLCAnLycpOwoJCQkk
dXJpID0gJGhvc3QgLiAkdXJpOwoJCX0KCgkJcmV0dXJuICgkdGhpcy0+cHJlZignZm9yY2Vf
bG93ZXJjYXNlX3VybHMnKSkgPyBzdHJ0b2xvd2VyKCR1cmkpIDogJHVyaTsKCX0KCglmdW5j
dGlvbiBfcGFnZWxpbmt1cmwgKCRwYXJ0cykgewoJCWV4dHJhY3QobEF0dHMoYXJyYXkoCgkJ
CSdwYXRoJwkJPT4gJ2luZGV4LnBocCcsCgkJCSdxdWVyeScJCT0+ICcnLAoJCQknZnJhZ21l
bnQnCT0+ICcnLAoJCSksIHBhcnNlX3VybChodG1sX2VudGl0eV9kZWNvZGUoc3RyX3JlcGxh
Y2UoJyYjMzg7JywgJyYnLCAkcGFydHNbMl0pKSkpKTsKCgkJLy8gVGlkeSB1cCBsaW5rcyBi
YWNrIHRvIHRoZSBzaXRlIGhvbWVwYWdlCgkJaWYgKCRwYXRoID09ICdpbmRleC5waHAnICYm
IGVtcHR5KCRxdWVyeSkpCgkJCXJldHVybiAnaHJlZj0iJyAuaHUuICciJzsKCgkJLy8gRml4
IG1hdGNoZXMgbGlrZSBocmVmPSI/cz1mb28iCgkJZWxzZSBpZiAoJHBhdGggJiYgZW1wdHko
JHF1ZXJ5KSAmJiAkcGFydHNbMV0gPT0gJz8nKSB7CgkJCSRxdWVyeSA9ICRwYXRoOwoJCQkk
cGF0aCA9ICdpbmRleC5waHAnOwoJCX0KCgkJLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZXJlIGlz
IHF1ZXJ5IHRvIHdvcmsgd2l0aC4KCQllbHNlIGlmIChlbXB0eSgkcXVlcnkpIHx8ICRwYXRo
ICE9ICdpbmRleC5waHAnIHx8IHN0cnBvcygkcXVlcnksICcvJykgPT09IHRydWUpCgkJCXJl
dHVybiAkcGFydHNbMF07CgoJCS8vICcmYW1wOycgd2lsbCBicmVhayBwYXJzZV9zdHIoKSBp
ZiB0aGV5IGFyZSBmb3VuZCBpbiBhIHF1ZXJ5IHN0cmluZwoJCSRxdWVyeSA9IHN0cl9yZXBs
YWNlKCcmYW1wOycsICcmJywgJHF1ZXJ5KTsKCgkJaWYgKCRmcmFnbWVudCkKCQkJJGZyYWdt
ZW50ID0gJyMnLiRmcmFnbWVudDsKCgkJZ2xvYmFsICRwcmV0ZXh0OwoJCXBhcnNlX3N0cigk
cXVlcnksICRxdWVyeV9wYXJ0KTsKCQlpZiAoIWFycmF5X2tleV9leGlzdHMoJ3BnJywgJHF1
ZXJ5X3BhcnQpKQoJCQkkcXVlcnlfcGFydFsncGcnXSA9IDA7CgkJaWYgKCFhcnJheV9rZXlf
ZXhpc3RzKCdpZCcsICRxdWVyeV9wYXJ0KSkKCQkJJHF1ZXJ5X3BhcnRbJ2lkJ10gPSAwOwoJ
CWlmICghYXJyYXlfa2V5X2V4aXN0cygncnNzJywgJHF1ZXJ5X3BhcnQpKQoJCQkkcXVlcnlf
cGFydFsncnNzJ10gPSAwOwoJCWlmICghYXJyYXlfa2V5X2V4aXN0cygnYXRvbScsICRxdWVy
eV9wYXJ0KSkKCQkJJHF1ZXJ5X3BhcnRbJ2F0b20nXSA9IDA7CgkJaWYgKCR0aGlzLT5wcmVm
KCdqb2luX3ByZXRleHRfdG9fcGFnZWxpbmtzJykpCgkJCWV4dHJhY3QoYXJyYXlfbWVyZ2Uo
JHByZXRleHQsICRxdWVyeV9wYXJ0KSk7CgkJZWxzZQoJCQlleHRyYWN0KCRxdWVyeV9wYXJ0
KTsKCgkJLy8gV2UgaGF2ZSBhIGlkLCBwYXNzIHRvIHBlcm1saW5rdXJsKCkKCQlpZiAoJGlk
KSB7CgkJCWlmIChAJHMgPT0gJ2ZpbGVfZG93bmxvYWQnKSB7CgkJCQkkdGl0bGUgPSAodmVy
c2lvbl9jb21wYXJlKCRkYnZlcnNpb24sICc0LjInLCAnPj0nKSkgPyBOVUxMIDogc2FmZV9m
aWVsZCgnZmlsZW5hbWUnLCAndHhwX2ZpbGUnLCAiaWQgPSAneyRpZH0nIik7CgkJCQkkdXJs
ID0gJHRoaXMtPnRvZ2dsZV9wZXJtbGlua19tb2RlKCdmaWxlZG93bmxvYWR1cmwnLCBhcnJh
eSgkaWQsICR0aXRsZSksIHRydWUpOwoJCQl9IGVsc2UgewoJCQkJJHJzID0gc2FmZV9yb3co
JyosIElEIGFzIHRoaXNpZCwgdW5peF90aW1lc3RhbXAoUG9zdGVkKSBhcyBwb3N0ZWQnLCAn
dGV4dHBhdHRlcm4nLCAiSUQgPSAneyRpZH0nIik7CgkJCQkkdXJsID0gJHRoaXMtPl9wZXJt
bGlua3VybCgkcnMsIFBFUk1MSU5LVVJMKSAuICRmcmFnbWVudDsKCQkJfQoJCQlyZXR1cm4g
J2hyZWY9IicuICR1cmwgLiciJzsKCQl9CgoJCWlmIChAJHMgPT0gJ2RlZmF1bHQnKQoJCQl1
bnNldCgkcyk7CgoJCS8vIFNvbWUgVHhQIHRhZ3MsIGUuZy4gPHR4cDpmZWVkX2xpbmsgLz4g
dXNlICdzZWN0aW9uJyBvciAnY2F0ZWdvcnknIGluY29uc2lzdGVudAoJCS8vIHdpdGggbW9z
dCBvdGhlciB0YWdzLiBQcm9jZXNzIHRoZXNlIG5vdyBzbyB3ZSBvbmx5IGhhdmUgdG8gY2hl
Y2sgJHMgYW5kICRjLgoJCWlmIChAJHNlY3Rpb24pICAkcyA9ICRzZWN0aW9uOwoJCWlmIChA
JGNhdGVnb3J5KSAkYyA9ICRjYXRlZ29yeTsKCgkJLy8gRGVidWdnaW5nIGZvciBidWZmZXJz
CgkJJHRoaXMtPmJ1ZmZlcl9kZWJ1Z1tdID0gJ3VybDogJy5zdHJfcmVwbGFjZSgnJmFtcDsn
LCAnJicsICRwYXJ0c1sxXS4kcGFydHNbMl0pOwoJCSR0aGlzLT5idWZmZXJfZGVidWdbXSA9
ICdwYXRoOiAnLiRwYXRoOwoJCSR0aGlzLT5idWZmZXJfZGVidWdbXSA9ICdxdWVyeTogJy4k
cXVlcnk7CgkJaWYgKCRmcmFnbWVudCkgJHRoaXMtPmJ1ZmZlcl9kZWJ1Z1tdID0gJ2ZyYWdt
ZW50OiAnLiRmcmFnbWVudDsKCgkJaWYgKEAkaWQpICR0aGlzLT5idWZmZXJfZGVidWdbXSA9
ICdpZDogJy4kaWQ7CgkJaWYgKEAkcykgJHRoaXMtPmJ1ZmZlcl9kZWJ1Z1tdID0gJ3M6ICcu
JHM7CgkJaWYgKEAkYykgJHRoaXMtPmJ1ZmZlcl9kZWJ1Z1tdID0gJ2M6ICcuJGM7CgkJaWYg
KEAkcnNzKSAkdGhpcy0+YnVmZmVyX2RlYnVnW10gPSAncnNzOiAnLiRyc3M7CgkJaWYgKEAk
YXRvbSkgJHRoaXMtPmJ1ZmZlcl9kZWJ1Z1tdID0gJ2F0b206ICcuJGF0b207CgkJaWYgKEAk
cGcpICR0aGlzLT5idWZmZXJfZGVidWdbXSA9ICdwZzogJy4kcGc7CgkJaWYgKEAkcSkgJHRo
aXMtPmJ1ZmZlcl9kZWJ1Z1tdID0gJ3E6ICcuJHE7CgoJCWlmIChAJHByZXRleHRbJ3Blcm1s
aW5rX292ZXJyaWRlJ10pIHsKCQkJJG92ZXJyaWRlX2lkcyA9IGV4cGxvZGUoJywnLCAkcHJl
dGV4dFsncGVybWxpbmtfb3ZlcnJpZGUnXSk7CgkJCWZvcmVhY2ggKCRvdmVycmlkZV9pZHMg
YXMgJG92ZXJyaWRlX2lkKSB7CgkJCQkkcGwgPSAkdGhpcy0+Z2V0X3Blcm1saW5rKCRvdmVy
cmlkZV9pZCk7CgkJCQlpZiAoY291bnQoJHBsKSA+IDApICRwZXJtbGlua3NbXSA9ICRwbDsK
CQkJfQoJCX0KCgkJaWYgKGVtcHR5KCRwZXJtbGlua3MpKSB7CgkJCSRwZXJtbGlua3MgPSAk
dGhpcy0+Z2V0X2FsbF9wZXJtbGlua3MoMSk7CgoJCQkkcGVybWxpbmtzWydnYnBfcGVybWFu
ZW50X2xpbmtzX2RlZmF1bHQnXSA9IGFycmF5KAoJCQkJJ2NvbXBvbmVudHMnID0+IGFycmF5
KAoJCQkJCWFycmF5KCd0eXBlJyA9PiAndGV4dCcsICd0ZXh0JyA9PiBzdHJ0b2xvd2VyKHVy
bGVuY29kZShnVHh0KCdjYXRlZ29yeScpKSkpLAoJCQkJCWFycmF5KCd0eXBlJyA9PiAnY2F0
ZWdvcnknKSwKCQkJCSksCgkJCQknc2V0dGluZ3MnID0+IGFycmF5KAoJCQkJCSdwbF9uYW1l
JyA9PiAnZ2JwX3Blcm1hbmVudF9saW5rc19kZWZhdWx0JywgJ3BsX3ByZWNlZGVuY2UnID0+
ICcnLCAncGxfcHJldmlldycgPT4gJycsCgkJCQkJJ2Nvbl9zZWN0aW9uJyA9PiAnJywgJ2Nv
bl9jYXRlZ29yeScgPT4gJycsICdkZXNfc2VjdGlvbicgPT4gJycsICdkZXNfY2F0ZWdvcnkn
ID0+ICcnLAoJCQkJCSdkZXNfcGVybWxpbmsnID0+ICcnLCAnZGVzX2ZlZWQnID0+ICcnLCAn
ZGVzX2xvY2F0aW9uJyA9PiAnJywKCQkJKSk7CgkJfQoKCQkkY3VycmVudF9zZWdtZW50cyA9
IGV4cGxvZGUoJy8nLCBsdHJpbSgkcHJldGV4dFsncmVxdWVzdF91cmknXSwgJy8nKSk7CgoJ
CSRoaWdoZXN0X21hdGNoX2NvdW50ID0gbnVsbDsKCQlmb3JlYWNoICgkcGVybWxpbmtzIGFz
ICRrZXkgPT4gJHBsKSB7CgkJCSR0aGlzLT5idWZmZXJfZGVidWdbXSA9ICdUZXN0aW5nIHBl
cm1saW5rOiAnLiAkcGxbJ3NldHRpbmdzJ11bJ3BsX25hbWUnXSAuJyAtICcuICRrZXk7CgkJ
CSR0aGlzLT5idWZmZXJfZGVidWdbXSA9ICdQcmV2aWV3OiAnLiAkcGxbJ3NldHRpbmdzJ11b
J3BsX3ByZXZpZXcnXTsKCQkJJG91dCA9IGFycmF5KCk7ICRrZXlzID0gYXJyYXkoKTsgJG1h
dGNoX2NvdW50ID0gMDsKCQkJZm9yZWFjaCAoJHBsWydjb21wb25lbnRzJ10gYXMgJGkgPT4g
JHBsX2MpIHsKCQkJCXN3aXRjaCAoJHBsX2NbJ3R5cGUnXSkgewoJCQkJCWNhc2UgJ3RleHQn
OgoJCQkJCQkkb3V0W10gPSAkcGxfY1sndGV4dCddOwoJCQkJCWJyZWFrOwoJCQkJCWNhc2Ug
J3JlZ2V4JzoKCQkJCQkJJG91dFtdID0gJHByZXRleHRbJ3Blcm1saW5rX3JlZ2V4XycuJHBs
X2NbJ25hbWUnXV07CgkJCQkJYnJlYWs7CgkJCQkJY2FzZSAnc2VjdGlvbic6CgkJCQkJCWlm
IChAJHMpICRvdXRbXSA9ICRzOwoJCQkJCQllbHNlIGJyZWFrIDI7CgkJCQkJYnJlYWs7CgkJ
CQkJY2FzZSAnY2F0ZWdvcnknOgoJCQkJCQlpZiAoQCRjKSAkb3V0W10gPSAkYzsKCQkJCQkJ
ZWxzZSBicmVhayAyOwoJCQkJCWJyZWFrOwoJCQkJCWNhc2UgJ2ZlZWQnOgoJCQkJCQlpZiAo
QCRyc3MpICRrZXlzW10gPSAkb3V0W10gPSAncnNzJzsKCQkJCQkJZWxzZSBpZiAoQCRhdG9t
KSAka2V5c1tdID0gJG91dFtdID0gJ2F0b20nOwoJCQkJCQllbHNlIGJyZWFrIDI7CgkJCQkJ
YnJlYWs7CgkJCQkJY2FzZSAnc2VhcmNoJzoKCQkJCQkJaWYgKEAkcSkgJG91dFtdID0gJHE7
CgkJCQkJCWVsc2UgYnJlYWsgMjsKCQkJCQlicmVhazsKCQkJCQljYXNlICdwYWdlJzoKCQkJ
CQkJaWYgKEAkcGcpIHsKCQkJCQkJCSRvdXRbXSA9ICRwZzsKCQkJCQkJCSRrZXlzW10gPSAn
cGcnOwoJCQkJCQl9CgkJCQkJCWVsc2UgYnJlYWsgMjsKCQkJCQlicmVhazsKCQkJCQlkZWZh
dWx0OiBicmVhayAyOwoJCQkJfQoJCQkJaWYgKGluX2FycmF5KCRwbF9jWyd0eXBlJ10sIGFy
cmF5KCd0ZXh0JywgJ3JlZ2V4JykpKSB7CgkJCQkJaWYgKCRjdXJyZW50X3NlZ21lbnRzWyRp
XSA9PSBlbmQoJG91dCkgJiYgc3RybGVuKGVuZCgkb3V0KSkgPiAwKQoJCQkJCQkkbWF0Y2hf
Y291bnQgKz0gJHRoaXMtPnByZWYoJ3RleHRfYW5kX3JlZ2V4X3NlZ21lbnRfc2NvcmVzJyk7
CgkJCQl9CgkJCQllbHNlaWYgKCFpbl9hcnJheSgkcGxfY1sndHlwZSddLCBhcnJheSgndGl0
bGUnLCAnaWQnKSkpCgkJCQkJJG1hdGNoX2NvdW50Kys7CgkJCQllbHNlIGJyZWFrOwoJCQl9
CgoJCQkkdGhpcy0+YnVmZmVyX2RlYnVnW10gPSAnTWF0Y2ggY291bnQ6ICcuICRtYXRjaF9j
b3VudDsKCgkJCS8vIFRvZG86IFN0b3JlIGFjY29yZGluZyB0byB0aGUgcHJlY2VkZW5jZSB2
YWx1ZQoJCQlpZiAoY291bnQoJG91dCkgPiAwICYmICgkbWF0Y2hfY291bnQgPiAkaGlnaGVz
dF9tYXRjaF9jb3VudCB8fCAhaXNzZXQoJGhpZ2hlc3RfbWF0Y2hfY291bnQpKSAmJgoJCQkh
KCRrZXkgPT0gJ2dicF9wZXJtYW5lbnRfbGlua3NfZGVmYXVsdCcgJiYgISRtYXRjaF9jb3Vu
dCkpIHsKCQkJCWV4dHJhY3QoJHBsWydzZXR0aW5ncyddKTsKCQkJCWlmICgoZW1wdHkoJHMp
ICYmIGVtcHR5KCRjKSkgfHwKCQkJCShlbXB0eSgkY29uX3NlY3Rpb24pIHx8IEAkcyA9PSAk
Y29uX3NlY3Rpb24pIHx8CgkJCQkoZW1wdHkoJGNvbl9jYXRlZ29yeSkgfHwgQCRjID09ICRj
b25fY2F0ZWdvcnkpKSB7CgkJCQkJJHRoaXMtPmJ1ZmZlcl9kZWJ1Z1tdID0gJ05ldyBoaWdo
ZXN0IG1hdGNoISAnLiBpbXBsb2RlKCcvJywgJG91dCk7CgkJCQkJJGhpZ2hlc3RfbWF0Y2hf
Y291bnQgPSAkbWF0Y2hfY291bnQ7CgkJCQkJJG1hdGNoID0gJG91dDsKCQkJCQkkbWF0Y2hf
a2V5cyA9ICRrZXlzOwoJCQkJfQoJCQl9CgkJfQoKCQlpZiAoZW1wdHkoJG1hdGNoKSAmJiAo
IShAJHBnICYmICR0aGlzLT5wcmVmKCdjbGVhbl9wYWdlX2FyY2hpdmVfbGlua3MnKSkgfHwg
KEAkcGcgJiYgQCRxKSkpIHsKCQkJZ2xvYmFsICRwcmVmcywgJHByZXRleHQsICRwZXJtbGlu
a19tb2RlOwoJCQkkdGhpcy0+YnVmZmVyX2RlYnVnW10gPSAnTm8gbWF0Y2gnOwoJCQkkdGhp
cy0+YnVmZmVyX2RlYnVnW10gPSAnLS0tLSc7CgkJCSRwcmV0ZXh0WydwZXJtbGlua19tb2Rl
J10gPSAkcGVybWxpbmtfbW9kZSA9ICRwcmVmc1sncGVybWxpbmtfbW9kZSddOwoJCQkkdXJs
ID0gcGFnZWxpbmt1cmwoJHF1ZXJ5X3BhcnQpOwoJCQkkcHJldGV4dFsncGVybWxpbmtfbW9k
ZSddID0gJHBlcm1saW5rX21vZGUgPSAnbWVzc3knOwoJCQlyZXR1cm4gJ2hyZWY9IicuICR1
cmwgLiciJzsKCQl9CgoJCSR0aGlzLT5idWZmZXJfZGVidWdbXSA9ICdtYXRjaDogJy4gICAg
ICBzZXJpYWxpemUoJG1hdGNoKTsKCQkkdGhpcy0+YnVmZmVyX2RlYnVnW10gPSAnbWF0Y2hf
a2V5czogJy4gc2VyaWFsaXplKCRtYXRjaF9rZXlzKTsKCgkJJHVybCA9ICcvJy5qb2luKCcv
JywgJG1hdGNoKTsKCQkkdXJsID0gcnRyaW0oaHUsICcvJykucnRyaW0oJHVybCwgJy8nKS4n
Lyc7CgoJCWlmICgkcnNzICYmICFpbl9hcnJheSgncnNzJywgJG1hdGNoX2tleXMpKQoJCQkk
dXJsIC49ICdyc3MnOwoJCWVsc2UgaWYgKCRhdG9tICYmICFpbl9hcnJheSgnYXRvbScsICRt
YXRjaF9rZXlzKSkKCQkJJHVybCAuPSAnYXRvbSc7CgkJZWxzZSBpZiAoJHBnICYmICFpbl9h
cnJheSgncGcnLCAkbWF0Y2hfa2V5cykpIHsKCQkJaWYgKCR0aGlzLT5wcmVmKCdjbGVhbl9w
YWdlX2FyY2hpdmVfbGlua3MnKSkKCQkJCSR1cmwgLj0gJHBnOwoJCQllbHNlIHsKCQkJCSR1
cmwgLj0gJz9wZz0nLiAkcGc7CgkJCQkkb21pdF90cmFpbGluZ19zbGFzaCA9IHRydWU7CgkJ
CX0KCQl9CgoJCSR1cmwgPSBydHJpbSgkdXJsLCAnLycpIC4gJy8nOwoKCQlpZiAoQCRvbWl0
X3RyYWlsaW5nX3NsYXNoIHx8ICR0aGlzLT5wcmVmKCdvbWl0X3RyYWlsaW5nX3NsYXNoJykp
CgkJCSR1cmwgPSBydHJpbSgkdXJsLCAnLycpOwoKCQkkdGhpcy0+YnVmZmVyX2RlYnVnW10g
PSAkdXJsOwoJCSR0aGlzLT5idWZmZXJfZGVidWdbXSA9ICctLS0tJzsKCgkJaWYgKCRwYXRo
ID09ICdpbmRleC5waHAnICYmICR1cmwgIT0gaHUpCgkJCXJldHVybiAnaHJlZj0iJy4gJHVy
bCAuICRmcmFnbWVudCAuJyInOwoKCQkvKgoJCTEgPSBpbmRleCwgdGV4dHBhdHRlcm4vY3Nz
LCBOVUxMICg9aW5kZXgpCgkJMiA9IGlkLCBzLCBzZWN0aW9uLCBjLCBjYXRlZ29yeSwgcnNz
LCBhdG9tLCBwZywgcSwgKG4sIHAsIG1vbnRoLCBhdXRob3IpCgkJKi8KCgkJcmV0dXJuICgk
dGhpcy0+cHJlZignZm9yY2VfbG93ZXJjYXNlX3VybHMnKSkgPyBzdHJ0b2xvd2VyKCRwYXJ0
c1swXSkgOiAkcGFydHNbMF07Cgl9CgoJZnVuY3Rpb24gc2V0X3Blcm1saW5rX21vZGUgKCRy
ZXNldF9mdW5jdGlvbiA9IGZhbHNlKSB7CgkJZ2xvYmFsICRwcmVmcywgJHByZXRleHQsICRw
ZXJtbGlua19tb2RlOwoJCSRwcmVmc1snY3VzdG9tX3VybF9mdW5jJ10gPSBhcnJheSgmJHRo
aXMsICdfcGVybWxpbmt1cmwnKTsKCgkJaWYgKCEkcmVzZXRfZnVuY3Rpb24pCgkJCSRwcmV0
ZXh0WydwZXJtbGlua19tb2RlJ10gPSAkcGVybWxpbmtfbW9kZSA9ICdtZXNzeSc7CgkJZWxz
ZQoJCQkkcHJldGV4dFsncGVybWxpbmtfbW9kZSddID0gJHBlcm1saW5rX21vZGUgPSAkcHJl
ZnNbJ3Blcm1saW5rX21vZGUnXTsKCX0KCglmdW5jdGlvbiByZXNldF9wZXJtbGlua19tb2Rl
ICgpIHsKCQlnbG9iYWwgJHByZWZzLCAkcHJldGV4dCwgJHBlcm1saW5rX21vZGU7CgkJdW5z
ZXQoJHByZWZzWydjdXN0b21fdXJsX2Z1bmMnXSk7CgkJJHByZXRleHRbJ3Blcm1saW5rX21v
ZGUnXSA9ICRwZXJtbGlua19tb2RlID0gJHByZWZzWydwZXJtbGlua19tb2RlJ107Cgl9CgoJ
ZnVuY3Rpb24gdG9nZ2xlX2N1c3RvbV91cmxfZnVuYyAoJGZ1bmMsICRhdHRzID0gTlVMTCwg
JHRvb2dsZV9wZXJtbGlua19tb2RlID0gZmFsc2UsICRleHBhbmRfYXJndW1lbnRzID0gZmFs
c2UpIHsKCQlnbG9iYWwgJHByZWZzLCAkcHJldGV4dDsKCgkJaWYgKCR0b29nbGVfcGVybWxp
bmtfbW9kZSkgewoJCQlnbG9iYWwgJHBlcm1saW5rX21vZGU7CgkJCSRfcGVybWxpbmtfbW9k
ZSA9ICRwZXJtbGlua19tb2RlOwoJCX0KCgkJJF9jYWxsX3VzZXJfZnVuYyA9IEAkcHJlZnNb
J2N1c3RvbV91cmxfZnVuYyddOwoKCQl1bnNldCgkcHJlZnNbJ2N1c3RvbV91cmxfZnVuYydd
KTsKCQlpZiAoJHRvb2dsZV9wZXJtbGlua19tb2RlKQoJCQkkcHJldGV4dFsncGVybWxpbmtf
bW9kZSddID0gJHBlcm1saW5rX21vZGUgPSAkcHJlZnNbJ3Blcm1saW5rX21vZGUnXTsKCgkJ
aWYgKGlzX2NhbGxhYmxlKCRmdW5jKSkgewoJCQlpZiAoaXNfYXJyYXkoJGF0dHMpIGFuZCAk
ZXhwYW5kX2FyZ3VtZW50cykKCQkJCSRycyA9IGNhbGxfdXNlcl9mdW5jX2FycmF5KCRmdW5j
LCAkYXR0cyk7CgkJCWVsc2UKCQkJCSRycyA9IGNhbGxfdXNlcl9mdW5jKCRmdW5jLCAkYXR0
cyk7CgkJfQoKCQkkcHJlZnNbJ2N1c3RvbV91cmxfZnVuYyddID0gJF9jYWxsX3VzZXJfZnVu
YzsKCgkJaWYgKCR0b29nbGVfcGVybWxpbmtfbW9kZSkKCQkJJHByZXRleHRbJ3Blcm1saW5r
X21vZGUnXSA9ICRwZXJtbGlua19tb2RlID0gJF9wZXJtbGlua19tb2RlOwoKCQlyZXR1cm4g
JHJzOwoJfQoKCWZ1bmN0aW9uIHRvZ2dsZV9wZXJtbGlua19tb2RlICgkZnVuYywgJGF0dHMg
PSBOVUxMLCAkZXhwYW5kX2FyZ3VtZW50cyA9IGZhbHNlKSB7CgkJcmV0dXJuICR0aGlzLT50
b2dnbGVfY3VzdG9tX3VybF9mdW5jKCRmdW5jLCAkYXR0cywgdHJ1ZSwgJGV4cGFuZF9hcmd1
bWVudHMpOwoJfQoKCWZ1bmN0aW9uIGVuY29kZV91cmwgKCR0ZXh0KSB7CgkJcmV0dXJuIHVy
bGVuY29kZSh0cmltKGR1bWJEb3duKHVybGRlY29kZSgkdGV4dCkpKSk7Cgl9CgoJZnVuY3Rp
b24gZGVidWcgKCkgewoJCWlmICgkdGhpcy0+cHJlZignZGVidWcnKSkgewoJCQlnbG9iYWwg
JHByb2R1Y3Rpb25fc3RhdHVzOwoJCQkkYSA9IGZ1bmNfZ2V0X2FyZ3MoKTsKCgkJCWlmIChA
dHhwaW50ZXJmYWNlID09ICdhZG1pbicpCgkJCQlmb3JlYWNoICgkYSBhcyAkdGhpbmcpCgkJ
CQkJZG1wKCR0aGluZyk7CgoJCQlpZiAoQHR4cGludGVyZmFjZSA9PSAncHVibGljJyAmJiBp
bl9hcnJheSgkcHJvZHVjdGlvbl9zdGF0dXMsIGFycmF5KCdkZWJ1ZycsICd0ZXN0aW5nJykp
KQoJCQkJZm9yZWFjaCAoJGEgYXMgJHRoaW5nKQoJCQkJCWVjaG8gY29tbWVudChpc19zY2Fs
YXIoJHRoaW5nKSA/IHN0cnZhbCgkdGhpbmcpIDogdmFyX2V4cG9ydCgkdGhpbmcsIHRydWUp
KSxuOwoJCX0KCX0KfQoKY2xhc3MgUGVybWFuZW50TGlua3NCdWlsZFRhYlZpZXcgZXh0ZW5k
cyBHQlBBZG1pblRhYlZpZXcKewoJdmFyICRwZXJtaXNzaW9ucyA9ICcxLDInOwoJZnVuY3Rp
b24gcHJlbG9hZCAoKSB7CgkJcmVnaXN0ZXJfY2FsbGJhY2soYXJyYXkoJiR0aGlzLCAncG9z
dF9zYXZlX3Blcm1saW5rJyksICR0aGlzLT5wYXJlbnQtPmV2ZW50LCBnYnBfc2F2ZSwgMSk7
CgkJcmVnaXN0ZXJfY2FsbGJhY2soYXJyYXkoJiR0aGlzLCAncG9zdF9zYXZlX3Blcm1saW5r
JyksICR0aGlzLT5wYXJlbnQtPmV2ZW50LCBnYnBfcG9zdCwgMSk7Cgl9CgoJZnVuY3Rpb24g
bWFpbiAoKSB7CgkJZ2xvYmFsICRwcmVmczsKCQlleHRyYWN0KGdwc2EoYXJyYXkoJ3N0ZXAn
LCBnYnBfaWQpKSk7CgoJCS8vIFdpdGggaGF2ZSBhbiBJRCwgZWl0aGVyIHRoZSBwZXJtbGlu
ayBoYXMganVzdCBiZWVuIHNhdmVkIG9yIHRoZSB1c2VyIHdhbnRzIHRvIGVkaXQgaXQKCQlp
ZiAoJGlkKSB7CgkJCS8vIE5ld2x5IHNhdmVkIG9yIGJlZW5pbmcgZWRpdGVkLCBlaXRoZXIg
d2F5IHdlJ3JlIGVkaXRpbmcgYSBwZXJtbGluawoJCQkkc3RlcCA9IGdicF9zYXZlOwoKCQkJ
Ly8gVXNlIHRoZSBJRCB0byBncmFiIHRoZSBwZXJtbGluayBkYXRhIChjb21wb25lbnRzICYg
c2V0dGluZ3MpCgkJCSRwZXJtbGluayA9ICR0aGlzLT5wYXJlbnQtPmdldF9wZXJtbGluaygk
aWQpOwoJCQkkY29tcG9uZW50cyA9ICR0aGlzLT5waHBBcnJheVRvSnNBcnJheSgnY29tcG9u
ZW50cycsICRwZXJtbGlua1snY29tcG9uZW50cyddKTsKCQkJJHNldHRpbmdzID0gJHBlcm1s
aW5rWydzZXR0aW5ncyddOwoJCX0gZWxzZSB7CgkJCS8vIENyZWF0aW5nIGEgbmV3IElEIGFu
ZCBwZXJtbGluay4KCQkJJHN0ZXAgPSBnYnBfcG9zdDsKCQkJJGlkID0gdW5pcWlkKCcnKTsK
CgkJCS8vIFNldCB0aGUgZGVmYXVsdCBzZXQgb2YgY29tcG9uZW50cyBkZXBlbmRpbmcgb24g
d2hldGhlciB0aGVyZSBpcyBwYXJlbnQgcGVybWxpbmsKCQkJJGNvbXBvbmVudHMgPSAkdGhp
cy0+cGhwQXJyYXlUb0pzQXJyYXkoJ2NvbXBvbmVudHMnLCBhcnJheSgKCQkJCWFycmF5KCd0
eXBlJyA9PiAnc2VjdGlvbicsICdwcmVmaXgnID0+ICcnLCAnc3VmZml4JyA9PiAnJywgJ3Jl
Z2V4JyA9PiAnJywgJ3RleHQnID0+ICcnKSwKCQkJCWFycmF5KCd0eXBlJyA9PiAnY2F0ZWdv
cnknLCAncHJlZml4JyA9PiAnJywgJ3N1ZmZpeCcgPT4gJycsICdyZWdleCcgPT4gJycsICd0
ZXh0JyA9PiAnJywgJ2NhdGVnb3J5JyA9PiAnMScpLAoJCQkJYXJyYXkoJ3R5cGUnID0+ICd0
aXRsZScsICdwcmVmaXgnID0+ICcnLCAnc3VmZml4JyA9PiAnJywgJ3JlZ2V4JyA9PiAnJywg
J3RleHQnID0+ICcnKSwKCQkJKSk7CgoJCQkkc2V0dGluZ3MgPSBhcnJheSgKCQkJCSdwbF9u
YW1lJyA9PiAnVW50aXRsZWQnLCAncGxfcHJlY2VkZW5jZScgPT4gJzAnLAoJCQkJJ2Nvbl9z
ZWN0aW9uJyA9PiAnJywgJ2Nvbl9jYXRlZ29yeScgPT4gJycsCgkJCQknZGVzX3NlY3Rpb24n
ID0+ICcnLCAnZGVzX2NhdGVnb3J5JyA9PiAnJywgJ2Rlc19wYWdlJyA9PiAnJywKCQkJCSdk
ZXNfcGVybWxpbmsnID0+ICcnLCAnZGVzX2ZlZWQnID0+ICcnLCAnZGVzX2xvY2F0aW9uJyA9
PiAnJywKCQkJKTsKCQl9CgoJCS8vIEV4dHJhY3Qgc2V0dGluZ3MgLSB0aGlzIHdpbGwgYmUg
dXNlZnVsIHdoZW4gY3JlYXRpbmcgdGhlIHVzZXIgaW50ZXJmYWNlCgkJZXh0cmFjdCgkc2V0
dGluZ3MpOwoKCQkvLyBQSFAgJiBKYXZhc2NyaXB0IGNvbnN0YW50czsKCQkkc2VwYXJhdG9y
ID0gZ2JwX3NlcGFyYXRvcjsKCQkkY29tcG9uZW50c19kaXYgPSAncGVybWxpbmtfY29tcG9u
ZW50c191aSc7CgkJJGNvbXBvbmVudHNfZm9ybSA9ICdwZXJtbGlua19jb21wb25lbnRzJzsK
CQkkc2V0dGluZ3NfZm9ybSA9ICdwZXJtbGlua19zZXR0aW5ncyc7CgkJJHNob3dfcHJlZml4
ID0gJHRoaXMtPnByZWYoJ3Nob3dfcHJlZml4Jyk7CgkJJHNob3dfc3VmZml4ID0gJHRoaXMt
PnByZWYoJ3Nob3dfc3VmZml4Jyk7CgoJCS8vIEEgbGl0dGxlIGNyZWRpdCBoZXJlIGFuZCB0
aGVyZSBkb2Vzbid0IGh1cnQKCQkkb3V0W10gPSAiPCEtLSB7JHRoaXMtPnBhcmVudC0+cGx1
Z2luX25hbWV9IGJ5IEdyYWVtZSBQb3J0ZW91cyAtLT4iOwoKCQkvLyBUaGUgSmF2YXNjcmlw
dAokb3V0W10gPSA8PDxIVE1MCgk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgbGFu
Z3VhZ2U9ImphdmFzY3JpcHQiIGNoYXJzZXQ9InV0Zi04Ij4KCS8vIDwhW0NEQVRBWwoKCS8v
IEdsb2JhbCB2YXJpYWJsZXMKdmFyIHskY29tcG9uZW50c30vLyBjb21wb25lbnRzIGFycmF5
IGZvciBhbGwgdGhlIGRhdGEKCgl2YXIgX2N1cnJlbnQgPSAwOyAvLyBJbmRleCBvZiB0aGUg
Y29tcG9uZW50cyBhcnJheSwgb2YgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBjb21wb25lbnQK
CXZhciBjX3ZhbHMgPSBuZXcgQXJyYXkoJ3R5cGUnLCAnY3VzdG9tJywgJ2NhdGVnb3J5Jywg
J25hbWUnLCAncHJlZml4JywgJ3N1ZmZpeCcsICdyZWdleCcsICd0ZXh0Jyk7CgoJd2luZG93
Lm9ubG9hZCA9IGZ1bmN0aW9uKCkgewoJCWNvbXBvbmVudF9yZWZyZXNoX2FsbCgpOwoJCWNv
bXBvbmVudF9zd2l0Y2goY29tcG9uZW50KF9jdXJyZW50KSk7Cgl9CgoJZnVuY3Rpb24gY29t
cG9uZW50X2FkZCAoKSB7CgkJLy8gQ3JlYXRlIGRhdGEgc2V0CgkJdmFyIGRhdGEgPSBuZXcg
QXJyYXkoKTsKCQlmb3IgKGtleSBpbiBjX3ZhbHMpIHsKCQkJZGF0YVtjX3ZhbHNba2V5XV0g
PSAnJzsKCQl9CgoJCS8vIEFkZCBkYXRhCgkJY29tcG9uZW50cy5wdXNoKGRhdGEpOwoKCQkv
LyBSZXNldCBjb21wb25lbnQgdHlwZSBsaXN0CgkJZm9ybSgneyRjb21wb25lbnRzX2Zvcm19
JykudHlwZS52YWx1ZSA9ICcnOwoKCQkvLyBTd2l0Y2ggdG8gdGhlIG5ldyBjb21wb25lbnQK
CQlfY3VycmVudCA9IGNvbXBvbmVudHMubGVuZ3RoIC0gMTsKCgkJLy8gUmVmcmVzaCBVSQoJ
CWNvbXBvbmVudF9yZWZyZXNoX2FsbCgpOwoJCWNvbXBvbmVudF91cGRhdGUoKTsKCX0KCglm
dW5jdGlvbiBjb21wb25lbnRfcmVmcmVzaCAoZWxlbWVudCkgewoJCXZhciBjID0gY29tcG9u
ZW50c1tlbGVtZW50LmlkXTsKCgkJLy8gQ1NTCgkJaWYgKF9jdXJyZW50ID09IGVsZW1lbnQu
aWQpCgkJCWVsZW1lbnQuc3R5bGVbJ2JhY2tncm91bmRDb2xvciddID0gJ3JnYigyNDksIDIw
NiwgNzMpJzsKCQllbHNlCgkJCWVsZW1lbnQuc3R5bGVbJ2JhY2tncm91bmRDb2xvciddID0g
J3JnYigyNTUsIDI1NCwgMjExKSc7CgkJZWxlbWVudC5zdHlsZVsnY29sb3InXSA9ICdyZ2Io
MCwgMCwgMCknOwoJCWVsZW1lbnQuc3R5bGVbJ2ZvbnRGYW1pbHknXSA9ICdBcmlhbCc7CgkJ
ZWxlbWVudC5zdHlsZVsnZm9udFdlaWdodCddID0gJ2JvbGQnOwoJCWVsZW1lbnQuc3R5bGVb
J3ZlcnRpY2FsQWxpZ24nXSA9ICdtaWRkbGUnOwoJCWVsZW1lbnQuc3R5bGVbJ3RleHRBbGln
biddID0gJ2NlbnRlcic7CgkJZWxlbWVudC5zdHlsZVsnbGluZUhlaWdodCddID0gJzEuNWVt
JzsKCQllbGVtZW50LnN0eWxlWydoZWlnaHQnXSA9ICcxLjVlbSc7CgkJZWxlbWVudC5zdHls
ZVsncGFkZGluZyddID0gJzAgNXB4JzsKCQllbGVtZW50LnN0eWxlWydtYXJnaW5SaWdodCdd
ID0gJzVweCc7CgkJZWxlbWVudC5zdHlsZVsnY3NzRmxvYXQnXSA9ICdsZWZ0JzsKCQllbGVt
ZW50LnN0eWxlWydkaXNwbGF5J10gPSAnaW5saW5lJzsKCgkJLy8gUmVtb3ZlIGFsbCBjaGls
ZCBub2RlcwoJCXdoaWxlIChlbGVtZW50Lmhhc0NoaWxkTm9kZXMoKSkgeyBlbGVtZW50LnJl
bW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RDaGlsZCk7IH0KCgkJLy8gQ3JlYXRlIHRoZSB2aXNp
YmxlIHN0cmluZyByZXByZXNlbnRpbmcgdGhpcyBjb21wb25lbnQKCQlzd2l0Y2ggKGNbJ3R5
cGUnXSkgewoJCQljYXNlICcnIDoKCQkJCXN0cmluZyA9ICcvJzsKCQkJCWJyZWFrOwoJCQlj
YXNlICdyZWdleCcgOgoJCQljYXNlICd0ZXh0JyA6CgkJCQlzdHJpbmcgPSBjW2NbJ3R5cGUn
XV0gKyAnIC8nOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ2RhdGUnIDoKCQkJCXN0cmluZyA9IGNb
J3R5cGUnXSArICcgLyc7CgkJCQlicmVhazsKCQkJY2FzZSAnY3VzdG9tJyA6CgkJCQlzdHJp
bmcgPSBjWydwcmVmaXgnXSArICdjdXN0b21fJyArIGNbJ2N1c3RvbSddICsgY1snc3VmZml4
J10gKyAnIC8nOwoJCQkJYnJlYWs7CgkJCWRlZmF1bHQgOgoJCQkJc3RyaW5nID0gY1sncHJl
Zml4J10gKyBjWyd0eXBlJ10gKyBjWydzdWZmaXgnXSArICcgLyc7CgkJCWJyZWFrOwoJCX0K
CgkJLy8gU2V0IHRoZSB2aXNpYmxlIHN0cmluZwoJCWVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9j
dW1lbnQuY3JlYXRlVGV4dE5vZGUoc3RyaW5nKSk7CgoJCXJldHVybiBlbGVtZW50OwoJfQoK
CWZ1bmN0aW9uIGNvbXBvbmVudF9yZWZyZXNoX2FsbCAoKSB7CgkJLy8gUmVtb3ZlIGFsbCBj
aGlsZCBub2RlcwoJCXdoaWxlIChwZXJtbGlua19kaXYoKS5oYXNDaGlsZE5vZGVzKCkpIHsg
cGVybWxpbmtfZGl2KCkucmVtb3ZlQ2hpbGQocGVybWxpbmtfZGl2KCkuZmlyc3RDaGlsZCk7
IH0KCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBjb21wb25lbnRzLmxlbmd0aDsgaSsrKSB7CgkJ
CXZhciBjID0gY29tcG9uZW50c1tpXTsKCgkJCS8vIENyZWF0ZSB0aGUgbmV3IGNvbXBvbmVu
dAoJCQl2YXIgbmV3X2NvbXBvbmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Rpdicp
OwoKCQkJLy8gU2V0IHRoZSBpZCBpbnRlcmdlciBmb3IgdGhpcyBjb21wb25lbnQKCQkJbmV3
X2NvbXBvbmVudC5pZCA9IGk7CgoJCQkvLyBKYXZhc2NyaXB0LCBvbm1vdXNldXAgc2V0dGlu
ZwoJCQluZXdfY29tcG9uZW50LnNldEF0dHJpYnV0ZSgnb25tb3VzZWRvd24nLCAnY29tcG9u
ZW50X3N3aXRjaCh0aGlzKTsnKTsKCQkJbmV3X2NvbXBvbmVudC5vbm1vdXNlZG93biA9IGZ1
bmN0aW9uKCkgeyBjb21wb25lbnRfc3dpdGNoKHRoaXMpOyB9OwoKCQkJLy8gUmVmcmVzaCB0
aGUgbG9vayBvZiB0aGUgY29tcG9uZW50CgkJCW5ld19jb21wb25lbnQgPSBjb21wb25lbnRf
cmVmcmVzaChuZXdfY29tcG9uZW50KTsKCgkJCS8vIEFuZCBhZGQgdGhlIG5ldyBjb21wb25l
bnQgdG8gdGhlIHVpCgkJCXBlcm1saW5rX2RpdigpLmFwcGVuZENoaWxkKG5ld19jb21wb25l
bnQpOwoJCX0KCX0KCglmdW5jdGlvbiBjb21wb25lbnRfcmVtb3ZlICgpIHsKCQlpZiAoY29t
cG9uZW50cy5sZW5ndGggPiAxKSB7CgkJCWNvbXBvbmVudHMuc3BsaWNlKF9jdXJyZW50LCAx
KTsKCgkJCWlmIChfY3VycmVudCA+PSBjb21wb25lbnRzLmxlbmd0aCkKCQkJCV9jdXJyZW50
ID0gY29tcG9uZW50cy5sZW5ndGggLSAxOwoKCQkJY29tcG9uZW50X3JlZnJlc2hfYWxsKCk7
CgkJfQoJfQoKCWZ1bmN0aW9uIGNvbXBvbmVudF9zd2l0Y2ggKGVsZW1lbnQpIHsKCQkvLyBV
cGRhdGUgY3VycmVudCBpbmRleAoJCV9jdXJyZW50ID0gZWxlbWVudC5pZDsKCgkJLy8gUmVm
cmVzaCBVSQoJCWNvbXBvbmVudF9yZWZyZXNoX2FsbCgpOwoKCQkvLyBTZXQgZm9ybSBpbnB1
dCB2YWx1ZXMKCQl2YXIgYyA9IGNvbXBvbmVudHNbX2N1cnJlbnRdOwoJCWZvciAoa2V5IGlu
IGNfdmFscykgewoJCQl2YXIgayA9IGNfdmFsc1trZXldOwoJCQl2YXIgZSA9IGZvcm0oJ3sk
Y29tcG9uZW50c19mb3JtfScpLmVsZW1lbnRzLm5hbWVkSXRlbShrKTsKCgkJCWlmIChjW2td
KSBlLnZhbHVlID0gY1trXTsKCQkJZWxzZSBlLnZhbHVlID0gJyc7CgkJfQoKCQkvLyBIaWRl
IHVubmVlZGVkIGZvcm0gaW5wdXRzCgkJY29tcG9uZW50X3VwZGF0ZSgpOwoJfQoKCWZ1bmN0
aW9uIGNvbXBvbmVudF91cGRhdGUgKGVsZW1lbnQpIHsKCQkvLyBTdG9yZSB0aGUgZGF0YSBp
biBmb3JtIGlucHV0cywgYW5kIGhpZGUgYWxsIGZvcm0gaW5wdXRzCgkJdmFyIGMgPSBuZXcg
QXJyYXkoKQoJCWZvciAoa2V5IGluIGNfdmFscykgewoJCQl2YXIgayA9IGNfdmFsc1trZXld
OwoJCQl2YXIgZSA9IGZvcm0oJ3skY29tcG9uZW50c19mb3JtfScpLmVsZW1lbnRzLm5hbWVk
SXRlbShrKTsKCgkJCWNba10gPSBlLnZhbHVlOwoKCQkJZS5wYXJlbnROb2RlLnN0eWxlWydk
aXNwbGF5J10gPSAnbm9uZSc7CgkJfQoKCQkvLyBSZXNob3cgdHlwZSBvcHRpb24gbGlzdAoJ
CWZvcm0oJ3skY29tcG9uZW50c19mb3JtfScpLnR5cGUucGFyZW50Tm9kZS5zdHlsZVsnZGlz
cGxheSddID0gJyc7CgoJCS8vIFNldCBvdGhlciBmb3JtIGlucHV0cyB0byB0aGUgY29ycmVj
dCB2aXNpYmlsaXR5IHN0YXRlLCBkZXBlbmRlbnQgb24gdHlwZQoJCXN3aXRjaCAoY1sndHlw
ZSddKSB7CgkJCWNhc2UgJycgOgoJCQljYXNlICdkYXRlJyA6IGJyZWFrOwoJCQljYXNlICdy
ZWdleCcgOgoJCQkJZm9ybSgneyRjb21wb25lbnRzX2Zvcm19JykubmFtZS5wYXJlbnROb2Rl
LnN0eWxlWydkaXNwbGF5J10gPSAnJzsKCQkJCWZvcm0oJ3skY29tcG9uZW50c19mb3JtfScp
LnJlZ2V4LnBhcmVudE5vZGUuc3R5bGVbJ2Rpc3BsYXknXSA9ICcnOwoJCQlicmVhazsKCQkJ
Y2FzZSAndGV4dCcgOgoJCQkJZm9ybSgneyRjb21wb25lbnRzX2Zvcm19JykubmFtZS5wYXJl
bnROb2RlLnN0eWxlWydkaXNwbGF5J10gPSAnJzsKCQkJCWZvcm0oJ3skY29tcG9uZW50c19m
b3JtfScpLnRleHQucGFyZW50Tm9kZS5zdHlsZVsnZGlzcGxheSddID0gJyc7CgkJCWJyZWFr
OwoJCQljYXNlICdjdXN0b20nIDoKCQkJCWZvcm0oJ3skY29tcG9uZW50c19mb3JtfScpLmN1
c3RvbS5wYXJlbnROb2RlLnN0eWxlWydkaXNwbGF5J10gPSAnJzsKCQkJCWRpc3BsYXlfZml4
ZXMoKTsKCQkJYnJlYWs7CgkJCWNhc2UgJ2NhdGVnb3J5JyA6CgkJCQlmb3JtKCd7JGNvbXBv
bmVudHNfZm9ybX0nKS5jYXRlZ29yeS5wYXJlbnROb2RlLnN0eWxlWydkaXNwbGF5J10gPSAn
JzsKCQkJCWRpc3BsYXlfZml4ZXMoKTsKCQkJYnJlYWs7CgkJCWRlZmF1bHQgOgoJCQkJZGlz
cGxheV9maXhlcygpOwoJCQlicmVhazsKCQl9CgoJCS8vIFNhdmUgZGF0YQoJCWNvbXBvbmVu
dHNbX2N1cnJlbnRdID0gYzsKCgkJLy8gUmVmcmVzaCBjb21wb25lbnQgdG8gcmVmbGVjdCBu
ZXcgZGF0YQoJCWNvbXBvbmVudF9yZWZyZXNoKGNvbXBvbmVudChfY3VycmVudCkpOwoKCQkv
LyBSZS1mb2N1cyB0aGUgYWN0aXZlIGZvcm0gaW5wdXQKCQlpZiAoZWxlbWVudCkKCQkJZWxl
bWVudC5mb2N1cygpOwoJfQoKCWZ1bmN0aW9uIGRpc3BsYXlfZml4ZXMgKCkgewoJCWlmICgn
eyRzaG93X3ByZWZpeH0nKQoJCQlmb3JtKCd7JGNvbXBvbmVudHNfZm9ybX0nKS5wcmVmaXgu
cGFyZW50Tm9kZS5zdHlsZVsnZGlzcGxheSddID0gJyc7CgkJaWYgKCd7JHNob3dfc3VmZml4
fScpCgkJCWZvcm0oJ3skY29tcG9uZW50c19mb3JtfScpLnN1ZmZpeC5wYXJlbnROb2RlLnN0
eWxlWydkaXNwbGF5J10gPSAnJzsKCX0KCglmdW5jdGlvbiBjb21wb25lbnRfbGVmdCAoKSB7
CgkJaWYgKGNvbXBvbmVudHMubGVuZ3RoID4gMSAmJiBfY3VycmVudCA+IDApIHsKCQkJLy8g
U3RvcmUgY3VycmVudCBjb21wb25lbnQKCQkJdmFyIGMgPSBjb21wb25lbnRzW19jdXJyZW50
XTsKCgkJCS8vIFJlbW92ZSBjdXJyZW50IGNvbXBvbmVudAoJCQljb21wb25lbnRzLnNwbGlj
ZShfY3VycmVudCwgMSk7CgoJCQkvLyBVcGRhdGUgY3VycmVudCBpbmRleAoJCQlfY3VycmVu
dC0tOwoKCQkJLy8gUmUtYWRkIGN1cnJlbnQgY29tcG9uZW50CgkJCWNvbXBvbmVudHMuc3Bs
aWNlKF9jdXJyZW50LCAwLCBjKTsKCgkJCS8vIFJlZnJlc2ggVUkKCQkJY29tcG9uZW50X3Jl
ZnJlc2hfYWxsKCk7CgkJfQoJfQoKCWZ1bmN0aW9uIGNvbXBvbmVudF9yaWdodCAoKSB7CgkJ
aWYgKF9jdXJyZW50IDwgY29tcG9uZW50cy5sZW5ndGggLSAxKSB7CgkJCS8vIFN0b3JlIGN1
cnJlbnQgY29tcG9uZW50CgkJCXZhciBjID0gY29tcG9uZW50c1tfY3VycmVudF07CgoJCQkv
LyBSZW1vdmUgY3VycmVudCBjb21wb25lbnQKCQkJY29tcG9uZW50cy5zcGxpY2UoX2N1cnJl
bnQsIDEpOwoKCQkJLy8gVXBkYXRlIGN1cnJlbnQgaW5kZXgKCQkJX2N1cnJlbnQrKzsKCgkJ
CS8vIFJlLWFkZCBjdXJyZW50IGNvbXBvbmVudAoJCQljb21wb25lbnRzLnNwbGljZShfY3Vy
cmVudCwgMCwgYyk7CgoJCQkvLyBSZWZyZXNoIFVJCgkJCWNvbXBvbmVudF9yZWZyZXNoX2Fs
bCgpOwoJCX0KCX0KCglmdW5jdGlvbiBzYXZlIChmb3JtKSB7CgkJdmFyIGMgPSAnJzsgdmFy
IGlzX3Blcm1saW5rID0gZmFsc2U7IHZhciBoYXNfcGFnZV9vcl9zZWFyY2ggPSBmYWxzZTsK
CQlmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKCQkJaWYg
KGNvbXBvbmVudHNbaV1bJ3R5cGUnXSA9PSAndGl0bGUnIHx8IGNvbXBvbmVudHNbaV1bJ3R5
cGUnXSA9PSAnaWQnKQoJCQkJaXNfcGVybWxpbmsgPSB0cnVlOwoJCQlpZiAoY29tcG9uZW50
c1tpXVsndHlwZSddID09ICdwYWdlJyB8fCBjb21wb25lbnRzW2ldWyd0eXBlJ10gPT0gJ2Zl
ZWQnIHx8IGNvbXBvbmVudHNbaV1bJ3R5cGUnXSA9PSAnc2VhcmNoJykKCQkJCWhhc19wYWdl
X2ZlZWRfc2VhcmNoID0gdHJ1ZTsKCQkJYyA9IGMgKyBqc0FycmF5VG9QaHBBcnJheShjb21w
b25lbnRzW2ldKSArICd7JHNlcGFyYXRvcn0nOwoJCX0KCgkJaWYgKGlzX3Blcm1saW5rICYm
IGhhc19wYWdlX29yX3NlYXJjaCkKCQkJYWxlcnQoIllvdXIgcGVybWFuZW50IGxpbmsgY2Fu
J3QgY29udGFpbiBlaXRoZXIgYSAncGFnZScsICdmZWVkJyBvciBhICdzZWFyY2gnIGNvbXBv
bmVudCB3aXRoICd0aXRsZScgb3IgJ2lkJyBjb21wb25lbnRzLiIpOwoKCQllbHNlIGlmIChp
c19wZXJtbGluayAmJiAoZm9ybS5wbF9uYW1lLnZhbHVlID09ICcnIHx8IGZvcm0ucGxfbmFt
ZS52YWx1ZSA9PSAnVW50aXRsZWQnKSkgewoJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgn
c2V0dGluZ3MnKS5zdHlsZVsnZGlzcGxheSddID0gJyc7CgkJCWZvcm0ucGxfbmFtZS5zdHls
ZVsnYm9yZGVyJ10gPSAnM3B4IHNvbGlkIHJnYigyMjEsIDAsIDApJzsKCQkJZm9ybS5wbF9w
cmVjZWRlbmNlLnN0eWxlWydib3JkZXInXSA9ICcnOwoJCQlhbGVydCgnUGxlYXNlIGVudGVy
IGEgbmFtZSBmb3IgdGhpcyBwZXJtYW5lbnQgbGluayBydWxlLicpOwoJCX0gZWxzZSBpZiAo
Zm9ybS5wbF9wcmVjZWRlbmNlLnZhbHVlID09ICcnKSB7CgkJCWRvY3VtZW50LmdldEVsZW1l
bnRCeUlkKCdzZXR0aW5ncycpLnN0eWxlWydkaXNwbGF5J10gPSAnJzsKCQkJZm9ybS5wbF9w
cmVjZWRlbmNlLnN0eWxlWydib3JkZXInXSA9ICczcHggc29saWQgcmdiKDIyMSwgMCwgMCkn
OwoJCQlmb3JtLnBsX25hbWUuc3R5bGVbJ2JvcmRlciddID0gJyc7CgkJCWFsZXJ0KCdQbGVh
c2UgZW50ZXIgYSBwcmVjZWRlbmNlIHZhbHVlIGZvciB0aGlzIHBlcm1hbmVudCBsaW5rIHJ1
bGUuJyk7CgkJfSBlbHNlIHsKCQkJZm9ybS5jb21wb25lbnRzLnZhbHVlID0gYzsKCQkJaWYg
KHBlcm1saW5rX2RpdigpLnRleHRDb250ZW50KQoJCQkJZm9ybS5wbF9wcmV2aWV3LnZhbHVl
ID0gcGVybWxpbmtfZGl2KCkudGV4dENvbnRlbnQ7CgkJCWVsc2UgaWYgKHBlcm1saW5rX2Rp
digpLmlubmVyVGV4dCkKCQkJCWZvcm0ucGxfcHJldmlldy52YWx1ZSA9IHBlcm1saW5rX2Rp
digpLmlubmVyVGV4dDsKCQkJcmV0dXJuIHRydWU7CgkJfQoKCQlyZXR1cm4gZmFsc2U7Cgl9
CgoJZnVuY3Rpb24ganNBcnJheVRvUGhwQXJyYXkgKGFycmF5KSB7CgkJLy8gaHR0cDovL2Zh
cm0udHVjb3dzLmNvbS9ibG9nL19hcmNoaXZlcy8yMDA1LzUvMzAvODk1OTAxLmh0bWwKCQl2
YXIgYXJyYXlfcGhwID0gIiI7CgkJdmFyIHRvdGFsID0gMDsKCQlmb3IgKHZhciBrZXkgaW4g
YXJyYXkpIHsKCQkJKysgdG90YWw7CgkJCWFycmF5X3BocCA9IGFycmF5X3BocCArICJzOiIg
KwoJCQkJU3RyaW5nKGtleSkubGVuZ3RoICsgIjpcIiIgKyBTdHJpbmcoa2V5KSArICJcIjtz
OiIgKwoJCQkJU3RyaW5nKGFycmF5W2tleV0pLmxlbmd0aCArICI6XCIiICsgU3RyaW5nKGFy
cmF5W2tleV0pICsgIlwiOyI7CgkJfQoJCWFycmF5X3BocCA9ICJhOiIgKyB0b3RhbCArICI6
eyIgKyBhcnJheV9waHAgKyAifSI7CgkJcmV0dXJuIGFycmF5X3BocDsKCX0KCglmdW5jdGlv
biBwZXJtbGlua19kaXYgKCkgewoJCS8vIFJldHVybiB0aGUgcGVybWxpbmsgcnVsZSBlbGVt
ZW50CgkJcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd7JGNvbXBvbmVudHNfZGl2
fScpOwoJfQoKCWZ1bmN0aW9uIGZvcm0gKG5hbWUpIHsKCQlpZiAoIW5hbWUpCgkJCW5hbWUg
PSAneyRjb21wb25lbnRzX2Zvcm19JwoJCS8vIFJldHVybiB0aGUgZm9ybSBlbGVtZW50IHdp
dGggbmFtZQoJCXJldHVybiBkb2N1bWVudC5mb3Jtcy5uYW1lZEl0ZW0obmFtZSk7Cgl9CgoJ
ZnVuY3Rpb24gY29tcG9uZW50IChpbmRleCkgewoJCS8vIFJldHVybiBjb21wb25lbnQgd2l0
aCBpbmRleAoJCXJldHVybiBwZXJtbGlua19kaXYoKS5jaGlsZE5vZGVzW2luZGV4XTsKCX0K
CgkvLyBdXT4KCTwvc2NyaXB0PgpIVE1MOwoKCQkvLyAtLS0gUnVsZSAtLS0gLy8KCgkJJG91
dFtdID0gaGVkKCdQZXJtYW5lbnQgbGluayBydWxlJywgMik7CgkJJG91dFtdID0gJzxkaXYg
aWQ9IicuJGNvbXBvbmVudHNfZGl2LiciIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiByZ2Io
MjMwLCAyMzAsIDIzMCk7IHdpZHRoOiBhdXRvOyBoZWlnaHQ6IDEuNWVtOyBtYXJnaW46IDEw
cHggMDsgcGFkZGluZzogNXB4OyI+PC9kaXY+JzsKCQkkb3V0W10gPSBncmFmCgkJCSgKCQkJ
JHRoaXMtPmZJbnB1dCgnYnV0dG9uJywgJ2NvbXBvbmVudF9hZGQnLCAnQWRkIGNvbXBvbmVu
dCcsIGFycmF5KCdjbGljaycgPT4gJ2NvbXBvbmVudF9hZGQoKTsnKSkubi4KCQkJJHRoaXMt
PmZJbnB1dCgnYnV0dG9uJywgJ2NvbXBvbmVudF9yZW1vdmUnLCAnUmVtb3ZlIGNvbXBvbmVu
dCcsIGFycmF5KCdjbGljaycgPT4gJ2NvbXBvbmVudF9yZW1vdmUoKTsnKSkubi4KCQkJJHRo
aXMtPmZJbnB1dCgnYnV0dG9uJywgJ2NvbXBvbmVudF9sZWZ0JywgJ01vdmUgbGVmdCcsIGFy
cmF5KCdjbGljaycgPT4gJ2NvbXBvbmVudF9sZWZ0KCk7JykpLm4uCgkJCSR0aGlzLT5mSW5w
dXQoJ2J1dHRvbicsICdjb21wb25lbnRfcmlnaHQnLCAnTW92ZSByaWdodCcsIGFycmF5KCdj
bGljaycgPT4gJ2NvbXBvbmVudF9yaWdodCgpOycpKQoJCQkpOwoKCQkvLyAtLS0gQ29tcG9u
ZW50IGZvcm0gLS0tIC8vCgoJCSRvdXRbXSA9ICc8Zm9ybSBhY3Rpb249ImluZGV4LnBocCIg
bmFtZT0iJy4kY29tcG9uZW50c19mb3JtLiciIG9uc3VibWl0PSJyZXR1cm4gZmFsc2U7Ij4n
OwoKCQkvLyAtLS0gQ29tcG9uZW50IHR5cGUgLS0tIC8vCgoJCSRjb21wb25lbnRfdHlwZXMg
PSBhcnJheSAoCgkJCSdzZWN0aW9uJyA9PiAnU2VjdGlvbicsICdjYXRlZ29yeScgPT4gJ0Nh
dGVnb3J5JywKCQkJJ3RpdGxlJyA9PiAnVGl0bGUnLCAnaWQnID0+ICdJRCcsCgkJCSdkYXRl
JyA9PiAnRGF0ZSAoeXl5eS9tbS9kZCknLCAneWVhcicgPT4gJ1llYXInLAoJCQknbW9udGgn
ID0+ICdNb250aCcsICdkYXknID0+ICdEYXknLAoJCQknYXV0aG9yJyA9PiAnQXV0aG9yIChS
ZWFsIG5hbWUpJywgJ2xvZ2luJyA9PiAnQXV0aG9yIChMb2dpbiknLAoJCQknY3VzdG9tJyA9
PiAnQ3VzdG9tIEZpZWxkJywgJ3BhZ2UnID0+ICdQYWdlIE51bWJlcicsCgkJCSdmZWVkJyA9
PiAnRmVlZCcsICdzZWFyY2gnID0+ICdTZWFyY2ggcmVxdWVzdCcsCgkJCSd0ZXh0JyA9PiAn
UGxhaW4gVGV4dCcsICdyZWdleCcgPT4gJ1JlZ3VsYXIgRXhwcmVzc2lvbicKCQkpOwoJCSRv
dXRbXSA9IGdyYWYoJHRoaXMtPmZTZWxlY3QoJ3R5cGUnLCAkY29tcG9uZW50X3R5cGVzLCAn
JywgMSwgJ0NvbXBvbmVudCB0eXBlJywgJyBvbmNoYW5nZT0iY29tcG9uZW50X3VwZGF0ZSgp
OyInKSk7CgoJCS8vIC0tLSBDb21wb25lbnQgZGF0YSAtLS0gLy8KCgkJLy8gR3JhYiB0aGUg
Y3VzdG9tIGZpZWxkIHRpdGxlcwoJCSRjdXN0b21fZmllbGRzID0gYXJyYXkoKTsKCQlmb3Ig
KCRpID0gMTsgJGkgPD0gMTA7ICRpKyspIHsKCQkJaWYgKCR2ID0gJHByZWZzWyJjdXN0b21f
eyRpfV9zZXQiXSkKCQkJCSRjdXN0b21fZmllbGRzWyRpXSA9ICR2OwoJCX0KCgkJJG91dFtd
ID0gZ3JhZiAoCgkJCSR0aGlzLT5mU2VsZWN0KCdjdXN0b20nLCAkY3VzdG9tX2ZpZWxkcywg
JycsIDAsICdDdXN0b20nLCAnIG9uY2hhbmdlPSJjb21wb25lbnRfdXBkYXRlKHRoaXMpOyIn
KS5uLgoJCQkkdGhpcy0+ZlNlbGVjdCgnY2F0ZWdvcnknLCBhcnJheSgnMScgPT4gJ0NhdGVn
b3J5IDEnLCAnMicgPT4gJ0NhdGVnb3J5IDInKSwgJycsIDAsICdQcmltYXJ5IENhdGVnb3J5
JywgJyBvbmNoYW5nZT0iY29tcG9uZW50X3VwZGF0ZSh0aGlzKTsiJykubi4KCQkJJHRoaXMt
PmZJbnB1dCgndGV4dCcsICduYW1lJywgJycsIGFycmF5KCdrZXl1cCcgPT4gJ2NvbXBvbmVu
dF91cGRhdGUodGhpcyk7JyksICdOYW1lJykubi4KCQkJJHRoaXMtPmZJbnB1dCgndGV4dCcs
ICdwcmVmaXgnLCAnJywgYXJyYXkoJ2tleXVwJyA9PiAnY29tcG9uZW50X3VwZGF0ZSh0aGlz
KTsnKSwgJ1ByZWZpeCcpLm4uCgkJCSR0aGlzLT5mSW5wdXQoJ3RleHQnLCAncmVnZXgnLCAn
JywgYXJyYXkoJ2tleXVwJyA9PiAnY29tcG9uZW50X3VwZGF0ZSh0aGlzKTsnKSwgJ1JlZ3Vs
YXIgRXhwcmVzc2lvbicpLm4uCgkJCSR0aGlzLT5mSW5wdXQoJ3RleHQnLCAnc3VmZml4Jywg
JycsIGFycmF5KCdrZXl1cCcgPT4gJ2NvbXBvbmVudF91cGRhdGUodGhpcyk7JyksICdTdWZm
aXgnKS5uLgoJCQkkdGhpcy0+ZklucHV0KCd0ZXh0JywgJ3RleHQnLCAnJywgYXJyYXkoJ2tl
eXVwJyA9PiAnY29tcG9uZW50X3VwZGF0ZSh0aGlzKTsnKSwgJ1RleHQnKQoJCSk7CgkJJGhy
ID0gJzxociBzdHlsZT0iYm9yZGVyOiAwOyBoZWlnaHQ6IDFweDsgYmFja2dyb3VuZC1jb2xv
cjogcmdiKDIwMCwgMjAwLCAyMDApOyBjb2xvcjogcmdiKDIwMCwgMjAwLCAyMDApOyBtYXJn
aW4tYm90dG9tOiAxMHB4OyIgLz4nOwoJCSRvdXRbXSA9ICRocjsKCQkkb3V0W10gPSAnPC9m
b3JtPic7CgoJCS8vIC0tLSBTZXR0aW5ncyBmb3JtIC0tLSAvLwoKCQkkb3V0W10gPSAnPGZv
cm0gYWN0aW9uPSJpbmRleC5waHAiIG1ldGhvZD0icG9zdCIgbmFtZT0iJy4kc2V0dGluZ3Nf
Zm9ybS4nIiBvbnN1Ym1pdD0icmV0dXJuIHNhdmUodGhpcyk7Ij4nOwoKCQkvLyAtLS0gU2V0
dGluZ3MgLS0tIC8vCgoJCSRvdXRbXSA9IGhlZCgnPGEgaHJlZj0iIyIgb25jbGljaz0idG9n
Z2xlRGlzcGxheShcJ3NldHRpbmdzXCcpOyByZXR1cm4gZmFsc2U7Ij5TZXR0aW5nczwvYT4n
LCAyKTsKCQkkb3V0W10gPSAnPGRpdiBpZD0ic2V0dGluZ3MiPic7CgkJJG91dFtdID0gZ3Jh
ZigkdGhpcy0+ZklucHV0KCd0ZXh0JywgJ3BsX25hbWUnLCAkcGxfbmFtZSwgTlVMTCwgJ05h
bWUnKSk7CgkJJG91dFtdID0gZ3JhZigkdGhpcy0+ZklucHV0KCd0ZXh0JywgJ3BsX3ByZWNl
ZGVuY2UnLCAkcGxfcHJlY2VkZW5jZSwgTlVMTCwgJ1ByZWNlZGVuY2UnKSk7CgkJJG91dFtd
ID0gJzwvZGl2Pic7CgkJJG91dFtdID0gJGhyOwoKCQkvLyAtLS0gQ29uZGl0aW9ucyAtLS0g
Ly8KCgkJJG91dFtdID0gaGVkKCc8YSBocmVmPSIjIiBvbmNsaWNrPSJ0b2dnbGVEaXNwbGF5
KFwnY29uZGl0aW9uc1wnKTsgcmV0dXJuIGZhbHNlOyI+Q29uZGl0aW9uczwvYT4nLCAyKTsK
CQkkb3V0W10gPSAnPGRpdiBpZD0iY29uZGl0aW9ucyIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+
JzsKCQkkb3V0W10gPSBncmFmKHN0cm9uZygnT25seSB1c2UgdGhpcyBwZXJtYW5lbnQgbGlu
ayBpZiB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXBwbHkuLi4nKSk7CgoJCS8vIEdlbmVy
YXRlIGEgc2VjdGlvbnMgYXJyYXkgKG5hbWU9PnRpdGxlKQoJCSRzZWN0aW9ucyA9IGFycmF5
KCk7CgkJJHJzID0gc2FmZV9yb3dzKCduYW1lLCB0aXRsZScsICd0eHBfc2VjdGlvbicsICJu
YW1lICE9ICdkZWZhdWx0JyBvcmRlciBieSBuYW1lIik7CgkJZm9yZWFjaCAoJHJzIGFzICRz
ZWMpIHsKCQkJJHNlY3Rpb25zWyRzZWNbJ25hbWUnXV0gPSAkc2VjWyd0aXRsZSddOwoJCX0K
CgkJLy8gR2VuZXJhdGUgYSBjYXRlZ29yaWVzIGFycmF5IChuYW1lPT50aXRsZSkKCQkkY2F0
ZWdvcmllcyA9IGFycmF5KCk7CgkJJHJzID0gc2FmZV9yb3dzKCduYW1lLCB0aXRsZScsICd0
eHBfY2F0ZWdvcnknLCAidHlwZSA9ICdhcnRpY2xlJyBhbmQgbmFtZSAhPSAncm9vdCcgb3Jk
ZXIgYnkgbmFtZSIpOwoJCWZvcmVhY2ggKCRycyBhcyAkc2VjKSB7CgkJCSRjYXRlZ29yaWVz
WyRzZWNbJ25hbWUnXV0gPSAkc2VjWyd0aXRsZSddOwoJCX0KCgkJJG91dFtdID0gZ3JhZiAo
CgkJCSR0aGlzLT5mU2VsZWN0KCdjb25fc2VjdGlvbicsICRzZWN0aW9ucywgJGNvbl9zZWN0
aW9uLCAxLCAnV2l0aGluIHNlY3Rpb24nKS5uLgoJCQkkdGhpcy0+ZlNlbGVjdCgnY29uX2Nh
dGVnb3J5JywgJGNhdGVnb3JpZXMsICRjb25fY2F0ZWdvcnksIDEsICdXaXRoaW4gY2F0ZWdv
cnknKQoJCSk7CgkJJG91dFtdID0gJzwvZGl2Pic7CgkJJG91dFtdID0gJGhyOwoKCQkvLyAt
LS0gRGVzdGluYXRpb24gLS0tIC8vCgoJCSRvdXRbXSA9IGhlZCgnPGEgaHJlZj0iIyIgb25j
bGljaz0idG9nZ2xlRGlzcGxheShcJ2Rlc3RpbmF0aW9uXCcpOyByZXR1cm4gZmFsc2U7Ij5E
ZXN0aW5hdGlvbjwvYT4nLCAyKTsKCQkkb3V0W10gPSAnPGRpdiBpZD0iZGVzdGluYXRpb24i
IHN0eWxlPSJkaXNwbGF5Om5vbmUiPic7CgkJJG91dFtdID0gZ3JhZihzdHJvbmcoJ0Zvcndh
cmQgdGhpcyBwZXJtYW5lbnQgbGluayB0by4uLicpKTsKCQkkb3V0W10gPSBncmFmICgKCQkJ
JHRoaXMtPmZTZWxlY3QoJ2Rlc19zZWN0aW9uJywgJHNlY3Rpb25zLCAkZGVzX3NlY3Rpb24s
IDEsICdTZWN0aW9uJykubi4KCQkJJHRoaXMtPmZTZWxlY3QoJ2Rlc19jYXRlZ29yeScsICRj
YXRlZ29yaWVzLCAkZGVzX2NhdGVnb3J5LCAxLCAnQ2F0ZWdvcnknKQoJCSk7CgkJJG91dFtd
ID0gZ3JhZigkdGhpcy0+ZlNlbGVjdCgnZGVzX3BhZ2UnLCBzYWZlX2NvbHVtbignbmFtZScs
ICd0eHBfcGFnZScsICIxIiksIEAkZGVzX3BhZ2UsIDEsICdQYWdlJykpOwoJCSRvdXRbXSA9
IGdyYWYoJHRoaXMtPmZCb3hlcygnZGVzX2ZlZWQnLCBhcnJheSgncnNzJywgJ2F0b20nLCAn
JyksICRkZXNfZmVlZCwgTlVMTCwgYXJyYXkoJ1JTUyBmZWVkJywgJ0F0b20gZmVlZCcsICdO
ZWl0aGVyJykpKTsKCQkkb3V0W10gPSBncmFmKHN0cm9uZygnUmVkaXJlY3QgdGhpcyBwZXJt
YW5lbnQgbGluayB0by4uLicpKTsKCQkvLyBHZW5lcmF0ZSBhIHBlcm1saW5rcyBhcnJheQoJ
CSRwZXJtbGlua3MgPSAkdGhpcy0+cGFyZW50LT5nZXRfYWxsX3Blcm1saW5rcygxKTsKCQlm
b3JlYWNoICgkcGVybWxpbmtzIGFzICRrZXkgPT4gJHBsKSB7CgkJCSRwZXJtbGlua3NbJGtl
eV0gPSAkcGxbJ3NldHRpbmdzJ11bJ3BsX25hbWUnXTsKCQl9CgkJdW5zZXQoJHBlcm1saW5r
c1skaWRdKTsKCQkkb3V0W10gPSBncmFmKCR0aGlzLT5mU2VsZWN0KCdkZXNfcGVybWxpbmsn
LCAkcGVybWxpbmtzLCBAJGRlc19wZXJtbGluaywgMSwgJ1Blcm1hbmVudCBsaW5rJykpOwoJ
CSRvdXRbXSA9IGdyYWYoJHRoaXMtPmZJbnB1dCgndGV4dCcsICdkZXNfbG9jYXRpb24nLCAk
ZGVzX2xvY2F0aW9uLCBOVUxMLCAnSFRUUCBsb2NhdGlvbicpKTsKCQkkb3V0W10gPSAnPC9k
aXY+JzsKCQkkb3V0W10gPSAkaHI7CgoJCS8vIFNhdmUgYnV0dG9uCgkJJG91dFtdID0gZklu
cHV0KCdzdWJtaXQnLCAnJywgJ1NhdmUgcGVybWFuZW50IGxpbmsnKTsKCgkJLy8gRXh0cmEg
Zm9ybSBpbnB1dHMgd2hpY2ggZ2V0IGZpbGxlZCBvbiBzdWJtaXQKCQkkb3V0W10gPSBoSW5w
dXQoJ2NvbXBvbmVudHMnLCAnJyk7CgkJJG91dFtdID0gaElucHV0KCdwbF9wcmV2aWV3Jywg
JycpOwoJCS8vIEV2ZW50IGFuZCB0YWIgZm9ybSBpbnB1dHMKCQkkb3V0W10gPSAkdGhpcy0+
Zm9ybV9pbnB1dHMoKTsKCQkvLyBTdGVwIGFuZCBJRCBmb3JtIGlucHV0cwoJCSRvdXRbXSA9
IHNJbnB1dCgkc3RlcCk7CgkJJG91dFtdID0gaElucHV0KGdicF9pZCwgJGlkKTsKCgkJJG91
dFtdID0gJzwvZm9ybT4nOwoKCQkvLyBMZXRzIGVjaG8gZXZlcnl0aGluZyBvdXQuIFlhaCEK
CQllY2hvIGpvaW4obiwgJG91dCk7Cgl9CgoJZnVuY3Rpb24gZkxhYmVsICgkbGFiZWwsICRj
b250ZW50cyA9ICcnLCAkbGFiZWxfcmlnaHQgPSBmYWxzZSkgewoJCS8vIDxsYWJlbD4gdGhl
IGNvbnRlbnRzIHdpdGggdGhlIG5hbWUgJGxhYmxlCgkJJGNvbnRlbnRzID0gKCRsYWJlbF9y
aWdodCkKCQk/ICRjb250ZW50cy4kbGFiZWwKCQk6ICRsYWJlbC4oJGNvbnRlbnRzID8gJzog
Jy4kY29udGVudHMgOiAnJyk7CgkJcmV0dXJuIHRhZygkY29udGVudHMsICdsYWJlbCcpOwoJ
fQoKCWZ1bmN0aW9uIGZCb3hlcyAoJG5hbWUgPSAnJywgJHZhbHVlID0gJycsICRjaGVja2Vk
X3ZhbHVlID0gJycsICRvbiA9IGFycmF5KCksICRsYWJlbCA9ICcnKSB7CgkJJG91dCA9IGFy
cmF5KCk7CgkJaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsKCQkJJGkgPSAwOwoJCQlmb3JlYWNo
ICgkdmFsdWUgYXMgJHZhbCkgewoJCQkJJG8gPSAnPGlucHV0IHR5cGU9InJhZGlvIiBuYW1l
PSInLiRuYW1lLiciIHZhbHVlPSInLiR2YWwuJyInOwoJCQkJJG8gLj0gKCRjaGVja2VkX3Zh
bHVlID09ICR2YWwpID8gJyBjaGVja2VkPSJjaGVja2VkIicgOiAnJzsKCQkJCWlmIChpc19h
cnJheSgkb24pKSBmb3JlYWNoKCRvbiBhcyAkayA9PiAkdikKCQkJCQkkbyAuPSAoJG9uKSA/
ICcgb24nLiRrLic9IicuJHYuJyInIDogJyc7CgkJCQkkbyAuPSAnIC8+JzsKCQkJCSRvdXRb
XSA9ICR0aGlzLT5mTGFiZWwoJGxhYmVsWyRpKytdLCAkbywgdHJ1ZSk7CgkJCX0KCQl9IGVs
c2UgewoJCQkkbyA9ICc8aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9IicuJG5hbWUuJyIg
dmFsdWU9IicuJHZhbHVlLiciJzsKCQkJJG8gLj0gKCRjaGVja2VkX3ZhbHVlID09ICR2YWx1
ZSkgPyAnIGNoZWNrZWQ9ImNoZWNrZWQiJyA6ICcnOwoJCQlpZiAoaXNfYXJyYXkoJG9uKSkg
Zm9yZWFjaCgkb24gYXMgJGsgPT4gJHYpCgkJCQkkbyAuPSAoJG9uKSA/ICcgb24nLiRrLic9
IicuJHYuJyInIDogJyc7CgkJCSRvIC49ICcgLz4nOwoJCQkkb3V0W10gPSAkdGhpcy0+Zkxh
YmVsKCRsYWJlbCwgJG8sIHRydWUpOwoJCX0KCgkJcmV0dXJuIGpvaW4oJycsICRvdXQpOwoJ
fQoKCWZ1bmN0aW9uIGZJbnB1dCAoJHR5cGUsICRuYW1lID0gJycsICR2YWx1ZSA9ICcnLCAk
b24gPSBhcnJheSgpLCAkbGFiZWwgPSAnJykgewoJCWlmICgkdHlwZSA9PSAncmFkaW8nIHx8
ICR0eXBlID09ICdjaGVja2JveCcpCgkJCXJldHVybiAkdGhpcy0+ZkJveGVzKCRuYW1lLCAk
dmFsdWUsICRvbiwgJGxhYmVsKTsKCgkJJG8gPSAnPGlucHV0IHR5cGU9IicuJHR5cGUuJyIg
bmFtZT0iJy4kbmFtZS4nIiB2YWx1ZT0iJy4kdmFsdWUuJyInOwoJCWlmIChpc19hcnJheSgk
b24pKSBmb3JlYWNoKCRvbiBhcyAkayA9PiAkdikKCQkJJG8gLj0gKCRvbikgPyAnIG9uJy4k
ay4nPSInLiR2LiciJyA6ICcnOwoJCSRvIC49ICcgLz4nOwoJCXJldHVybiAoJGxhYmVsKSA/
ICR0aGlzLT5mTGFiZWwoJGxhYmVsLCAkbykgOiAkbzsKCX0KCglmdW5jdGlvbiBmU2VsZWN0
ICgkbmFtZSA9ICcnLCAkYXJyYXkgPSAnJywgJHZhbHVlID0gJycsICRibGFua19maXJzdCA9
ICcnLCAkbGFiZWwgPSAnJywgJG9uX3N1Ym1pdCA9ICcnKSB7CgkJJG8gPSBzZWxlY3RJbnB1
dCgkbmFtZSwgJGFycmF5LCAkdmFsdWUsICRibGFua19maXJzdCwgJG9uX3N1Ym1pdCk7CgkJ
cmV0dXJuICgkbGFiZWwgPyAkdGhpcy0+ZkxhYmVsKCRsYWJlbCwgJG8pIDogJG8pOwoJfQoK
CWZ1bmN0aW9uIHBvc3Rfc2F2ZV9wZXJtbGluayAoKSB7CgkJLy8gVGhlIGZ1bmN0aW9uIHBv
c3RzIG9yIHNhdmVzIGEgcGVybWFuZW50IGxpbmsgdG8gdHhwX3ByZWZzCgoJCWV4dHJhY3Qo
Z3BzYShhcnJheSgnc3RlcCcsIGdicF9pZCkpKTsKCgkJLy8gR3JhYiB0aGUgdXNlciBkZWZp
bmVkIHNldHRpbmdzIGZyb20gdGhlIGZvcm0gUE9TVCBkYXRhCgkJJHNldHRpbmdzID0gZ3Bz
YShhcnJheSgKCQkJJ3BsX25hbWUnLCAncGxfcHJlY2VkZW5jZScsICdwbF9wcmV2aWV3JywK
CQkJJ2Nvbl9zZWN0aW9uJywgJ2Nvbl9jYXRlZ29yeScsCgkJCSdkZXNfc2VjdGlvbicsICdk
ZXNfY2F0ZWdvcnknLCAnZGVzX3BhZ2UnLAoJCQknZGVzX3Blcm1saW5rJywgJ2Rlc19mZWVk
JywgJ2Rlc19sb2NhdGlvbicsCgkJKSk7CgoJCS8vIFJlbW92ZSBzcGFjZXMgZnJvbSB0aGUg
cGVybWFuZW50IGxpbmsgcHJldmlldwoJCSRzZXR0aW5nc1sncGxfcHJldmlldyddID0gcHJl
Z19yZXBsYWNlKCclXHMrL1xzKiUnLCAnLycsICRzZXR0aW5nc1sncGxfcHJldmlldyddKTsK
CgkJLy8gRXhwbG9kZSB0aGUgc2VwYXJhdGVkIHN0cmluZyBvZiBzZXJpYWxpemUgY29tcG9u
ZW50cyAtIHRoaXMgd2FzIG1hZGUgYnkgSmF2YVNjcmlwdC4KCQkkc2VyaWFsaXplX2NvbXBv
bmVudHMgPSBleHBsb2RlKGdicF9zZXBhcmF0b3IsIHJ0cmltKGdwcygnY29tcG9uZW50cycp
LCBnYnBfc2VwYXJhdG9yKSk7CgoJCS8vIFVuc2VyaWFsaXplIHRoZSBjb21wb25lbnRzCgkJ
JGNvbXBvbmVudHMgPSBhcnJheSgpOwoJCWZvcmVhY2ggKCRzZXJpYWxpemVfY29tcG9uZW50
cyBhcyAkYykKCQkJJGNvbXBvbmVudHNbXSA9IHVuc2VyaWFsaXplKHN0cmlwc2xhc2hlcygk
YykpOwoKCQkvLyBDb21wbGV0ZSB0aGUgcGVybWFuZW50IGxpbmsgYXJyYXkgLSB0aGlzIGlz
IGV4YWN0bHkgd2hhdCBuZWVkcyB0byBiZSBzdG9yZWQgaW4gdGhlIGRiCgkJJHBlcm1saW5r
ID0gYXJyYXkoJ3NldHRpbmdzJyA9PiAkc2V0dGluZ3MsICdjb21wb25lbnRzJyA9PiAkY29t
cG9uZW50cyk7CgoJCS8vIFNhdmUgaXQKCQkkdGhpcy0+c2V0X3ByZWZlcmVuY2UoJGlkLCAk
cGVybWxpbmssICdnYnBfc2VyaWFsaXplZCcpOwoKCQkkdGhpcy0+cGFyZW50LT5tZXNzYWdl
ID0gbWVzc2VuZ2VyKCcnLCAkc2V0dGluZ3NbJ3BsX25hbWUnXSwgJ3NhdmVkJyk7Cgl9CgoJ
ZnVuY3Rpb24gcGhwQXJyYXlUb0pzQXJyYXkgKCRuYW1lLCAkYXJyYXkpIHsKCQkvLyBGcm9t
IFBIUC5uZXQKCQlpZiAoaXNfYXJyYXkoJGFycmF5KSkgewoJCQkkcmVzdWx0ID0gJG5hbWUu
JyA9IG5ldyBBcnJheSgpOycubjsKCQkJZm9yZWFjaCAoJGFycmF5IGFzICRrZXkgPT4gJHZh
bHVlKQoJCQkJJHJlc3VsdCAuPSAkdGhpcy0+cGhwQXJyYXlUb0pzQXJyYXkoJG5hbWUuJ1tc
JycuJGtleS4nXCddJywkdmFsdWUsJycpLm47CgkJfSBlbHNlIHsKCQkJJHJlc3VsdCA9ICRu
YW1lLicgPSBcJycuJGFycmF5LidcJzsnOwoJCX0KCQlyZXR1cm4gJHJlc3VsdDsKCX0KfQoK
Y2xhc3MgUGVybWFuZW50TGlua3NMaXN0VGFiVmlldyBleHRlbmRzIEdCUEFkbWluVGFiVmll
dwp7Cgl2YXIgJHBlcm1pc3Npb25zID0gJzEsMic7CglmdW5jdGlvbiBwcmVsb2FkICgpIHsK
CQlyZWdpc3Rlcl9jYWxsYmFjayhhcnJheSgmJHRoaXMsICR0aGlzLT5wYXJlbnQtPmV2ZW50
LidfbXVsdGlfZWRpdCcpLCAkdGhpcy0+cGFyZW50LT5ldmVudCwgJHRoaXMtPnBhcmVudC0+
ZXZlbnQuJ19tdWx0aV9lZGl0JywgMSk7CgkJcmVnaXN0ZXJfY2FsbGJhY2soYXJyYXkoJiR0
aGlzLCAkdGhpcy0+cGFyZW50LT5ldmVudC4nX2NoYW5nZV9wYWdlYnknKSwgJHRoaXMtPnBh
cmVudC0+ZXZlbnQsICR0aGlzLT5wYXJlbnQtPmV2ZW50LidfY2hhbmdlX3BhZ2VieScsIDEp
OwoJfQoKCWZ1bmN0aW9uIG1haW4gKCkgewoJCWV4dHJhY3QoZ3BzYShhcnJheSgncGFnZScs
ICdzb3J0JywgJ2RpcicsICdjcml0JywgJ3NlYXJjaF9tZXRob2QnKSkpOwoKCQkkZXZlbnQg
PSAkdGhpcy0+cGFyZW50LT5ldmVudDsKCgkJJHBlcm1saW5rcyA9ICR0aGlzLT5wYXJlbnQt
PmdldF9hbGxfcGVybWxpbmtzKCk7CgkJJHRvdGFsID0gY291bnQoJHBlcm1saW5rcyk7CgoJ
CWlmICgkdG90YWwgPCAxKSB7CgkJCWVjaG8gZ3JhZignWW91IGhhdmVuXCd0IGNyZWF0ZWQg
YW55IGN1c3RvbSBwZXJtYW5lbnQgbGlua3MgcnVsZXMgeWV0LicsICcgc3R5bGU9InRleHQt
YWxpZ246IGNlbnRlcjsiJykuCgkJCQkgZ3JhZignPGEgaHJlZj0iJy4kdGhpcy0+dXJsKGFy
cmF5KGdicF90YWIgPT4gJ2J1aWxkJyksIHRydWUpLiciPkNsaWNrIGhlcmU8L2E+IHRvIGFk
ZCBvbmUuJywgJyBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyInKTsKCQkJcmV0dXJuOwoJ
CX0KCgkJJGxpbWl0ID0gbWF4KCR0aGlzLT5wcmVmKCdsaXN0X3BhZ2VieScpLCAxNSk7CgoJ
CWxpc3QoJHBhZ2UsICRvZmZzZXQsICRudW1QYWdlcykgPSAkdGhpcy0+cGFnZXIoJHRvdGFs
LCAkbGltaXQsICRwYWdlKTsKCgkJaWYgKGVtcHR5KCRzb3J0KSkKCQkJJHNvcnQgPSAncGxf
cHJlY2VkZW5jZSc7CgoJCWlmIChlbXB0eSgkZGlyKSkKCQkJJGRpciA9ICdkZXNjJzsKCgkJ
JGRpciA9ICgkZGlyID09ICdkZXNjJykgPyAnZGVzYycgOiAnYXNjJzsKCgkJLy8gU29ydCB0
aGUgcGVybWxpbmtzIHZpYSB0aGUgc2VsZWN0ZWQgY29sdW1uIGFuZCB0aGVuIHRoZWlyIG5h
bWVzLgoJCWZvcmVhY2ggKCRwZXJtbGlua3MgYXMgJGlkID0+ICRwZXJtbGluaykgewoJCQkk
c29ydF9rZXlzWyRpZF0gPSAkcGVybWxpbmtbJ3NldHRpbmdzJ11bJHNvcnRdOwoJCQkkbmFt
ZVskaWRdID0gJHBlcm1saW5rWydzZXR0aW5ncyddWydwbF9uYW1lJ107CgkJfQoJCWFycmF5
X211bHRpc29ydCgkc29ydF9rZXlzLCAoKCRkaXIgPT0gJ2Rlc2MnKSA/IFNPUlRfREVTQyA6
IFNPUlRfQVNDKSwgJG5hbWUsIFNPUlRfQVNDLCAkcGVybWxpbmtzKTsKCgkJJHN3aXRjaF9k
aXIgPSAoJGRpciA9PSAnZGVzYycpID8gJ2FzYycgOiAnZGVzYyc7CgoJCSRwZXJtbGlua3Mg
PSBhcnJheV9zbGljZSgkcGVybWxpbmtzLCAkb2Zmc2V0LCAkbGltaXQpOwoKCQlpZiAoY291
bnQoJHBlcm1saW5rcykpIHsKCQkJZWNobyBuLm4uJzxmb3JtIG5hbWU9Imxvbmdmb3JtIiBt
ZXRob2Q9InBvc3QiIGFjdGlvbj0iaW5kZXgucGhwIiBvbnN1Ym1pdD0icmV0dXJuIHZlcmlm
eShcJycuZ1R4dCgnYXJlX3lvdV9zdXJlJykuJ1wnKSI+Jy4KCgkJCQluLnN0YXJ0VGFibGUo
J2xpc3QnKS4KCQkJCW4udHIoCgkJCQkJbi5jb2x1bW5faGVhZCgnbmFtZScsICdwbF9uYW1l
JywgJGV2ZW50LCB0cnVlLCAkc3dpdGNoX2RpciwgJGNyaXQsICRzZWFyY2hfbWV0aG9kKS4K
CQkJCQloQ2VsbCgpLgoJCQkJCWNvbHVtbl9oZWFkKCdwcmV2aWV3JywgJ3BsX3ByZXZpZXcn
LCAkZXZlbnQsIHRydWUsICRzd2l0Y2hfZGlyLCAkY3JpdCwgJHNlYXJjaF9tZXRob2QpLgoJ
CQkJCWNvbHVtbl9oZWFkKCdwcmVjZWRlbmNlJywgJ3BsX3ByZWNlZGVuY2UnLCAkZXZlbnQs
IHRydWUsICRzd2l0Y2hfZGlyLCAkY3JpdCwgJHNlYXJjaF9tZXRob2QpLgoJCQkJCWhDZWxs
KCkKCQkJCSk7CgoJCQlpbmNsdWRlX29uY2UgdHhwYXRoLicvcHVibGlzaC90YWdoYW5kbGVy
cy5waHAnOwoKCQkJZm9yZWFjaCAoJHBlcm1saW5rcyBhcyAkaWQgPT4gJHBlcm1saW5rKSB7
CgkJCQlleHRyYWN0KCRwZXJtbGlua1snc2V0dGluZ3MnXSk7CgoJCQkJJG1hbmFnZSA9IG4u
Jzx1bCcuKHZlcnNpb25fY29tcGFyZSgkR0xPQkFMU1sndGhpc3ZlcnNpb24nXSwgJzQuMC4z
JywgJzw9JykgPyAnIHN0eWxlPSJtYXJnaW46MDtwYWRkaW5nOjA7bGlzdC1zdHlsZS10eXBl
Om5vbmU7Ij4nIDogJz4nKS4KCQkJCQkJbi50Lic8bGk+Jy5ocmVmKGdUeHQoJ2VkaXQnKSwg
JHRoaXMtPnVybChhcnJheShnYnBfdGFiID0+ICdidWlsZCcsIGdicF9pZCA9PiAkaWQpLCB0
cnVlKSkuJzwvbGk+Jy4KCQkJCQkJbi4nPC91bD4nOwoKCQkJCWVjaG8gbi5uLnRyKAoKCQkJ
CQl0ZCgKCQkJCQkJaHJlZigkcGxfbmFtZSwgJHRoaXMtPnVybChhcnJheShnYnBfdGFiID0+
ICdidWlsZCcsIGdicF9pZCA9PiAkaWQpLCB0cnVlKSkKCQkJCQksIDc1KS4KCgkJCQkJdGQo
JG1hbmFnZSwgMzUpLgoKCQkJCQl0ZCgkcGxfcHJldmlldywgMTc1KS4KCQkJCQl0ZCgkcGxf
cHJlY2VkZW5jZS4nJm5ic3A7JywgNTApLgoKCQkJCQl0ZCgKCQkJCQkJZklucHV0KCdjaGVj
a2JveCcsICdzZWxlY3RlZFtdJywgJGlkKQoJCQkJCSkKCQkJCSk7CgkJCX0KCgkJCWVjaG8g
bi5uLnRyKAoJCQkJdGRhKAoJCQkJCXNlbGVjdF9idXR0b25zKCkuCgkJCQkJJHRoaXMtPnBl
cm1saW5rc19tdWx0aWVkaXRfZm9ybSgkcGFnZSwgJHNvcnQsICRkaXIsICRjcml0LCAkc2Vh
cmNoX21ldGhvZCkKCQkJCSwnIGNvbHNwYW49IjQiIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdo
dDsgYm9yZGVyOiBub25lOyInKQoJCQkpLgoKCQkJbi5lbmRUYWJsZSgpLgoJCQluLic8L2Zv
cm0+Jy4KCgkJCW4uJHRoaXMtPm5hdl9mb3JtKCRldmVudCwgJHBhZ2UsICRudW1QYWdlcywg
JHNvcnQsICRkaXIsICRjcml0LCAkc2VhcmNoX21ldGhvZCkuCgoJCQluLnBhZ2VieV9mb3Jt
KCRldmVudCwgJHRoaXMtPnByZWYoJ2xpc3RfcGFnZWJ5JykpOwoJCX0KCX0KCglmdW5jdGlv
biBwYWdlciAoJHRvdGFsLCAkbGltaXQsICRwYWdlKSB7CgkJaWYgKGZ1bmN0aW9uX2V4aXN0
cygncGFnZXInKSkKCQkJcmV0dXJuIHBhZ2VyKCR0b3RhbCwgJGxpbWl0LCAkcGFnZSk7CgoJ
CS8vIFRoaXMgaXMgdGFrZW4gZnJvbSB0eHBsaWJfbWlzYy5waHAgcjE1ODggaXQgaXMgcmVx
dWlyZWQgZm9yIDQuMC4zIGNvbXBhdGliaXRseQoJCSRudW1fcGFnZXMgPSBjZWlsKCR0b3Rh
bCAvICRsaW1pdCk7CgkJJHBhZ2UgPSAkcGFnZSA/IChpbnQpICRwYWdlIDogMTsKCQkkcGFn
ZSA9IG1pbihtYXgoJHBhZ2UsIDEpLCAkbnVtX3BhZ2VzKTsKCQkkb2Zmc2V0ID0gbWF4KCgk
cGFnZSAtIDEpICogJGxpbWl0LCAwKTsKCQlyZXR1cm4gYXJyYXkoJHBhZ2UsICRvZmZzZXQs
ICRudW1fcGFnZXMpOwoJfQoKCWZ1bmN0aW9uIG5hdl9mb3JtICgkZXZlbnQsICRwYWdlLCAk
bnVtUGFnZXMsICRzb3J0LCAkZGlyLCAkY3JpdCwgJG1ldGhvZCkgewoJCWlmIChmdW5jdGlv
bl9leGlzdHMoJ25hdl9mb3JtJykpCgkJCXJldHVybiBuYXZfZm9ybSgkZXZlbnQsICRwYWdl
LCAkbnVtUGFnZXMsICRzb3J0LCAkZGlyLCAkY3JpdCwgJG1ldGhvZCk7CgoJCS8vIFRoaXMg
aXMgYmFzaWNhbGx5IHN0b2xlbiBmcm9tIHRoZSA0LjAuMyB2ZXJzaW9uIG9mIGluY2x1ZGVz
L3R4cF9saXN0LnBocAoJCS8vIC0gbGlzdF9uYXZfZm9ybSgpIGZvciA0LjAuMyBjb21wYXRp
Yml0bHkKCQkkbmF2W10gPSAoJHBhZ2UgPiAxKQoJCQk/IFByZXZOZXh0TGluaygkZXZlbnQs
ICRwYWdlLTEsIGdUeHQoJ3ByZXYnKSwgJ3ByZXYnLCAkc29ydCwgJGRpcikgOiAnJzsKCQkk
bmF2W10gPSBzcC5zbWFsbCgkcGFnZS4gJy8nLiRudW1QYWdlcykuc3A7CgkJJG5hdltdID0g
KCRwYWdlICE9ICRudW1QYWdlcykKCQkJPyBQcmV2TmV4dExpbmsoJGV2ZW50LCAkcGFnZSsx
LCBnVHh0KCduZXh0JyksICduZXh0JywgJHNvcnQsICRkaXIpIDogJyc7CgkJcmV0dXJuICgk
bmF2KQoJCQk/IGdyYWYoam9pbignJywgJG5hdiksICcgYWxpZ249ImNlbnRlciInKSA6ICcn
OwoJfQoKCWZ1bmN0aW9uIHBlcm1saW5rc19tdWx0aWVkaXRfZm9ybSAoJHBhZ2UsICRzb3J0
LCAkZGlyLCAkY3JpdCwgJHNlYXJjaF9tZXRob2QpIHsKCQkkbWV0aG9kcyA9IGFycmF5KAoJ
CQknZGVsZXRlJyA9PiBnVHh0KCdkZWxldGUnKSwKCQkpOwoKCQlyZXR1cm4gZXZlbnRfbXVs
dGllZGl0X2Zvcm0oJHRoaXMtPnBhcmVudC0+ZXZlbnQsICRtZXRob2RzLCAkcGFnZSwgJHNv
cnQsICRkaXIsICRjcml0LCAkc2VhcmNoX21ldGhvZCk7Cgl9CgoJZnVuY3Rpb24gcGVybWxp
bmtzX2NoYW5nZV9wYWdlYnkgKCkgewoJCSR0aGlzLT5zZXRfcHJlZmVyZW5jZSgnbGlzdF9w
YWdlYnknLCBncHMoJ3F0eScpKTsKCX0KCglmdW5jdGlvbiBwZXJtbGlua3NfbXVsdGlfZWRp
dCAoKSB7CgkJJG1ldGhvZCA9IGdwcygnZWRpdF9tZXRob2QnKQoJCQk/IGdwcygnZWRpdF9t
ZXRob2QnKSAvLyBGcm9tIFR4cCA0LjAuNCBhbmQgZ3JlYXRlcgoJCQk6IGdwcygnbWV0aG9k
Jyk7IC8vIFVwIHRvIFR4cCA0LjAuMwoKCQlzd2l0Y2ggKCRtZXRob2QpIHsKCQkJY2FzZSAn
ZGVsZXRlJzoKCQkJCWZvcmVhY2ggKGdwcygnc2VsZWN0ZWQnKSBhcyAkaWQpIHsKCQkJCQkJ
CSRkZWxldGVkW10gPSAkdGhpcy0+cGFyZW50LT5yZW1vdmVfcGVybWxpbmsoJGlkKTsKCQkJ
CX0KCQkJYnJlYWs7CgkJfQoKCQkkdGhpcy0+cGFyZW50LT5tZXNzYWdlID0gKGlzc2V0KCRk
ZWxldGVkKSAmJiBpc19hcnJheSgkZGVsZXRlZCkgJiYgY291bnQoJGRlbGV0ZWQpKQoJCQk/
IG1lc3NlbmdlcignJywgam9pbignLCAnLCAkZGVsZXRlZCkgLCdkZWxldGVkJykKCQkJOiBt
ZXNzZW5nZXIoJ2FuIGVycm9yIG9jY3VycmVkJywgJycsICcnKTsKCX0KfQoKZ2xvYmFsICRn
YnBfcGw7CiRnYnBfcGwgPSBuZXcgUGVybWFuZW50TGlua3MoJ1Blcm1hbmVudCBMaW5rcycs
ICdwZXJtbGlua3MnLCAnYWRtaW4nKTsKaWYgKEB0eHBpbnRlcmZhY2UgPT0gJ3B1YmxpYycp
IHsKCXJlZ2lzdGVyX2NhbGxiYWNrKGFycmF5KCYkZ2JwX3BsLCAnX2ZlZWRfZW50cnknKSwg
J3Jzc19lbnRyeScpOwoJcmVnaXN0ZXJfY2FsbGJhY2soYXJyYXkoJiRnYnBfcGwsICdfZmVl
ZF9lbnRyeScpLCAnYXRvbV9lbnRyeScpOwoJcmVnaXN0ZXJfY2FsbGJhY2soYXJyYXkoJiRn
YnBfcGwsICdfdGV4dHBhdHRlcm4nKSwgJ3RleHRwYXR0ZXJuJyk7CglyZWdpc3Rlcl9jYWxs
YmFjayhhcnJheSgmJGdicF9wbCwgJ190ZXh0cGF0dGVybl9lbmQnKSwgJ3RleHRwYXR0ZXJu
X2VuZCcpOwoKCWZ1bmN0aW9uIGdicF9pZl9yZWdleCAoJGF0dHMsICR0aGluZykgewoJCWds
b2JhbCAkcHJldGV4dDsKCQlleHRyYWN0KGxBdHRzKGFycmF5KAoJCQknbmFtZScgPT4gJycs
CgkJCSd2YWwnICA9PiAnJywKCQkpLCRhdHRzKSk7CgkJJG1hdGNoID0gKEAkcHJldGV4dFsi
cGVybWxpbmtfcmVnZXhfeyRuYW1lfSJdID09ICR2YWwpOwoJCXJldHVybiBwYXJzZShFdmFs
RWxzZSgkdGhpbmcsICRtYXRjaCkpOwoJfQoKCWZ1bmN0aW9uIGdicF9pZl90ZXh0ICgkYXR0
cywgJHRoaW5nKSB7CgkJZ2xvYmFsICRwcmV0ZXh0OwoJCWV4dHJhY3QobEF0dHMoYXJyYXko
CgkJCSduYW1lJyA9PiAnJywKCQkJJ3ZhbCcgID0+ICcnLAoJCSksJGF0dHMpKTsKCgkJJG1h
dGNoID0gZmFsc2U7CgkJaWYgKCFlbXB0eSgkbmFtZSkpIHsKCQkJaWYgKGVtcHR5KCR2YWwp
KQoJCQkJJG1hdGNoID0gKGlzc2V0KCRwcmV0ZXh0WyJwZXJtbGlua190ZXh0X3skbmFtZX0i
XSkpOwoJCQllbHNlCgkJCQkkbWF0Y2ggPSAoQCRwcmV0ZXh0WyJwZXJtbGlua190ZXh0X3sk
bmFtZX0iXSA9PSAkdmFsKTsKCQl9CgkJcmV0dXJuIHBhcnNlKEV2YWxFbHNlKCR0aGluZywg
JG1hdGNoKSk7Cgl9CgoJZnVuY3Rpb24gZ2JwX3VzZV9wYWdlbGluayAoJGF0dHMsICR0aGlu
ZyA9ICcnKSB7CgkJZ2xvYmFsICRnYnBfcGw7CgkJZXh0cmFjdChsQXR0cyhhcnJheSgKCQkJ
J3J1bGUnID0+ICcnLAoJCSksJGF0dHMpKTsKCQlyZXR1cm4gJGdicF9wbC0+X3RleHRwYXR0
ZXJuX2VuZF9jYWxsYmFjayhwYXJzZSgkdGhpbmcpLCAkcnVsZSk7Cgl9CgoJZnVuY3Rpb24g
Z2JwX2Rpc2FibGVfcGVybWxpbmtzICgkYXR0cywgJHRoaW5nID0gJycpIHsKCQlnbG9iYWwg
JGdicF9wbDsKCQlyZXR1cm4gJGdicF9wbC0+dG9nZ2xlX3Blcm1saW5rX21vZGUoJ3BhcnNl
JywgJHRoaW5nKTsKCX0KfQoiO3M6MzoibWQ1IjtzOjMyOiJiM2RhZmNlNmM4YzUzYzIyNmZj
NDVkNjdmNTM2ZTUyNCI7fQ==
